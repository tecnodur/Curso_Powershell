<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/Curso_Powershell/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/Curso_Powershell/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(2)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(2) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(3) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(2) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list { display: block; } </style> <script src="/Curso_Powershell/assets/js/vendor/lunr.min.js"></script> <script src="/Curso_Powershell/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Session 2: Variáveis e Tipos de Dados | PowerShell Workshop</title> <meta name="generator" content="Jekyll v4.3.4" /> <meta property="og:title" content="Session 2: Variáveis e Tipos de Dados" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A project site with collapsible side navigation." /> <meta property="og:description" content="A project site with collapsible side navigation." /> <link rel="canonical" href="https://tecnodur.github.io/Curso_Powershell/Modules/Module2/session2.html" /> <meta property="og:url" content="https://tecnodur.github.io/Curso_Powershell/Modules/Module2/session2.html" /> <meta property="og:site_name" content="PowerShell Workshop" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Session 2: Variáveis e Tipos de Dados" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"A project site with collapsible side navigation.","headline":"Session 2: Variáveis e Tipos de Dados","url":"https://tecnodur.github.io/Curso_Powershell/Modules/Module2/session2.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/Curso_Powershell/" class="site-title lh-tight"> PowerShell Workshop </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/" class="nav-list-link">Curso de PowerShell & Shell Scripting</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Módulo 1: Introdução ao PowerShell e Shell Scripting category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module1/" class="nav-list-link">Módulo 1: Introdução ao PowerShell e Shell Scripting</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module1/session1.html" class="nav-list-link">Session 1: Conceitos Básicos e Configuração</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module1/session2.html" class="nav-list-link">Sessão 2: Comandos, Navegação e Ajuda</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module1/session3.html" class="nav-list-link">Session 3: Objetos, parâmetros, pipeline, output, exportações</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Módulo 2: Lógica, Variáveis e Scripting category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module2/" class="nav-list-link">Módulo 2: Lógica, Variáveis e Scripting</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session1.html" class="nav-list-link">Session 1: Criar e Executar Scripts</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session2.html" class="nav-list-link">Session 2: Variáveis e Tipos de Dados</a></li></ul></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/" class="nav-list-link">Module 3: Gestão de Ficheiros e Processos</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/" class="nav-list-link">Module 4: Automação de Tarefas no Windows e Linux</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search PowerShell Workshop" aria-label="Search PowerShell Workshop" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/Curso_Powershell/Modules/Module2/">Módulo 2: Lógica, Variáveis e Scripting</a></li> <li class="breadcrumb-nav-list-item"><span>Session 2: Variáveis e Tipos de Dados</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h2 style="all: unset; font-size: 5em; font-weight: bold;"> 🧭 Sessão 2: Variáveis e Tipos de Dados </h2> <p><br /></p> <p><strong>🎯 Objetivo</strong> Compreender o que são variáveis, como funcionam os tipos de dados em PowerShell e como utilizá-los corretamente em scripts.</p> <ul> <li><a href="#1-variáveis-e-tipos-de-dados">1. Variáveis e Tipos de Dados</a> <ul> <li><a href="#11-o-que-é-uma-variável">1.1. O que é uma variável?</a></li> <li><a href="#12-tipagem-explícita">1.2. Tipagem explícita</a></li> <li><a href="#13--exercicio--corrigir-script-com-erros">1.3. 🧩 Exercicio – Corrigir script com erros</a></li> <li><a href="#14-scope-de-variáveis">1.4. Scope de variáveis</a></li> <li><a href="#15-variáveis-automáticas">1.5. Variáveis automáticas</a></li> <li><a href="#16-variáveis-preferenciais">1.6. Variáveis preferenciais</a></li> <li><a href="#17-variáveis-com-nomes-especiais">1.7. Variáveis com nomes especiais</a></li> <li><a href="#18-dicas-práticas">1.8. Dicas práticas</a></li> <li><a href="#19-verificar-o-tipo-de-uma-variável">1.9. Verificar o tipo de uma variável</a></li> <li><a href="#110--exercicio--identificar-tipos-de-dados">1.10. 🧩 Exercicio – Identificar tipos de dados</a></li> </ul> </li> <li><a href="#2-tipos-de-dados-em-powershell">2. Tipos de dados em PowerShell</a> <ul> <li><a href="#21-tipos-primitivos">2.1. Tipos primitivos</a></li> <li><a href="#22-tipos-compostos">2.2. Tipos compostos</a></li> <li><a href="#23--exercicios">2.3. 🧩 Exercicios</a></li> <li><a href="#24-operadores-básicos">2.4. Operadores básicos</a></li> <li><a href="#25--exercícios">2.5. 🧩 Exercícios</a></li> <li><a href="#26-boas-práticas-com-variáveis">2.6. Boas práticas com variáveis</a></li> <li><a href="#27-recursos-adicionais">2.7. Recursos adicionais</a></li> </ul> </li> </ul> <h1 id="1-variáveis-e-tipos-de-dados"> <a href="#1-variáveis-e-tipos-de-dados" class="anchor-heading" aria-labelledby="1-variáveis-e-tipos-de-dados"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Variáveis e Tipos de Dados </h1> <h2 id="11-o-que-é-uma-variável"> <a href="#11-o-que-é-uma-variável" class="anchor-heading" aria-labelledby="11-o-que-é-uma-variável"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.1. O que é uma variável? </h2> <p>Uma variável é um espaço de memória que guarda um valor. Em PowerShell, todas as variáveis começam com o símbolo <code class="language-plaintext highlighter-rouge">$</code>. Podes usá-las para guardar texto, números, listas, objetos, entre outros.</p> <h3 id="sintaxe-base"> <a href="#sintaxe-base" class="anchor-heading" aria-labelledby="sintaxe-base"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sintaxe base </h3> <p>Em PowerShell, podes declarar uma variável atribuindo-lhe um valor diretamente:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$nome = "Nuno"
$idade = 30
$ativo = $true
</code></pre></div></div> <ul> <li>O PowerShell determina automaticamente o tipo com base no valor atribuído — isto chama-se <strong>tipagem dinâmica</strong>.</li> <li>O nome da variável não é case sensitive, ou seja, <code class="language-plaintext highlighter-rouge">$var</code>, <code class="language-plaintext highlighter-rouge">$VAR</code> e <code class="language-plaintext highlighter-rouge">$Var</code> são tratados como a mesma variável.</li> <li>O nome deve começar com uma letra ou underscore (<code class="language-plaintext highlighter-rouge">_</code>), <strong>não com número</strong></li> <li>Pode conter letras, números e underscores</li> <li>Não pode conter espaços nem símbolos especiais</li> <li>Para valores booleanos, usa-se <code class="language-plaintext highlighter-rouge">$true</code> e <code class="language-plaintext highlighter-rouge">$false</code>, que são <strong>constantes internas</strong> (não são variáveis)</li> </ul> <p><strong>Exemplos</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$cidade = "Lisboa"
$ano = 2025
$pi = 3.14
$temAcesso = $false

Write-Output "Cidade: $cidade"
Write-Output "Ano atual: $ano"
</code></pre></div></div> <h3 id="boas-práticas-de-nomeação"> <a href="#boas-práticas-de-nomeação" class="anchor-heading" aria-labelledby="boas-práticas-de-nomeação"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Boas práticas de nomeação </h3> <ul> <li>Usa nomes descritivos: <code class="language-plaintext highlighter-rouge">$nomeCliente</code>, <code class="language-plaintext highlighter-rouge">$totalFinal</code></li> <li>Evita siglas confusas: <code class="language-plaintext highlighter-rouge">$nc</code>, <code class="language-plaintext highlighter-rouge">$t</code></li> <li>Não uses espaços nem acentos</li> <li>Podes usar <code class="language-plaintext highlighter-rouge">CamelCase</code> ou <code class="language-plaintext highlighter-rouge">snake_case</code>, mas mantém a consistência</li> </ul><hr /> <h2 id="12-tipagem-explícita"> <a href="#12-tipagem-explícita" class="anchor-heading" aria-labelledby="12-tipagem-explícita"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.2. Tipagem explícita </h2> <p>Também é possível <strong>definir o tipo da variável manualmente</strong> usando <code class="language-plaintext highlighter-rouge">[Tipo]</code> antes do nome.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[string]$nome = "Nuno"
[int]$idade = 30
[bool]$ativo = $true"
</code></pre></div></div> <p>Isto impede que o valor da variável seja substituído por algo incompatível sem erro.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[int]$idade = "trinta"   # Erro de conversão
</code></pre></div></div> <h3 id="diferença-entre-tipagem-dinâmica-e-explícita"> <a href="#diferença-entre-tipagem-dinâmica-e-explícita" class="anchor-heading" aria-labelledby="diferença-entre-tipagem-dinâmica-e-explícita"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Diferença entre tipagem dinâmica e explícita </h3> <div class="table-wrapper"><table> <thead> <tr> <th> </th> <th>Tipagem dinâmica</th> <th>Tipagem explícita</th> </tr> </thead> <tbody> <tr> <td>Sintaxe</td> <td><code class="language-plaintext highlighter-rouge">$x = "texto"</code></td> <td><code class="language-plaintext highlighter-rouge">[string]$x = "texto"</code></td> </tr> <tr> <td>Flexibilidade</td> <td>Alta</td> <td>Restrita ao tipo definido</td> </tr> <tr> <td>Conversão</td> <td>Implícita</td> <td>Pode falhar se não for compatível</td> </tr> <tr> <td>Quando usar</td> <td>Scripts simples, testes</td> <td>Scripts em produção, validação, funções</td> </tr> </tbody> </table></div> <blockquote> <p>Dica: usa tipagem explícita quando queres garantir que os dados têm o tipo certo, especialmente ao passar valores para funções ou APIs.</p> </blockquote> <h2 id="13--exercicio--corrigir-script-com-erros"> <a href="#13--exercicio--corrigir-script-com-erros" class="anchor-heading" aria-labelledby="13--exercicio--corrigir-script-com-erros"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.3. 🧩 Exercicio – Corrigir script com erros </h2> <p>Corrige os erros no script seguinte:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$idade = "trinta"
Write-Output "Idade: " + $idade
$idade += 1
</code></pre></div></div> <blockquote> <p>Perguntas:</p> <ul> <li>O que está errado?</li> <li>Como corrigir?</li> </ul> </blockquote> <!-- <details> <summary>Resposta</summary> [int]$idade = 30 Write-Output "Idade: $idade" $idade += 1 Write-Output "Nova idade: $idade" </details> --><hr /> <h2 id="14-scope-de-variáveis"> <a href="#14-scope-de-variáveis" class="anchor-heading" aria-labelledby="14-scope-de-variáveis"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.4. Scope de variáveis </h2> <p>O scope define onde a variável está acessível.</p> <div class="table-wrapper"><table> <thead> <tr> <th><strong>Scope</strong></th> <th><strong>Descrição</strong></th> <th><strong>Quando usar</strong></th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">Local</code></td> <td>Válido apenas no bloco atual (função, script, etc.)</td> <td>Quase sempre — é o padrão, mantém o código modular</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Global</code></td> <td>Disponível em toda a sessão PowerShell</td> <td>Com cuidado — apenas se precisares de partilhar dados entre scripts/sessões</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Script</code></td> <td>Visível em todo o ficheiro <code class="language-plaintext highlighter-rouge">.ps1</code></td> <td>Útil em scripts com várias funções que partilham dados</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Private</code></td> <td>Apenas acessível dentro do bloco onde foi criada</td> <td>Quando queres garantir isolamento total da variável</td> </tr> </tbody> </table></div> <p>Exemplo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$Local:minhaVar = "Apenas aqui"
$Global:minhaVar = "Em toda a sessão"
$Script:minhaVar = "Visível no script"
$Private:minhaVar = "Só neste bloco"
</code></pre></div></div> <p>⚠️ Quando não usas nenhum prefixo, o PowerShell assume o escopo mais local possível automaticamente (normalmente Local).<br /> ⚠️ Evita criar variáveis globais a menos que seja mesmo necessário. Elas persistem na sessão e podem causar bugs difíceis de detetar se forem reutilizadas acidentalmente noutros scripts.</p><hr /> <h2 id="15-variáveis-automáticas"> <a href="#15-variáveis-automáticas" class="anchor-heading" aria-labelledby="15-variáveis-automáticas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.5. Variáveis automáticas </h2> <p>O PowerShell define várias variáveis que estão sempre disponíveis. Algumas das mais úteis:</p> <div class="table-wrapper"><table> <thead> <tr> <th>Variável</th> <th>Descrição</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">$null</code></td> <td>Representa “sem valor”</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">$true</code> / <code class="language-plaintext highlighter-rouge">$false</code></td> <td>Booleanos lógicos</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">$args</code></td> <td>Argumentos passados a scripts ou funções</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">$PSVersionTable</code></td> <td>Informações sobre a versão do PowerShell</td> </tr> </tbody> </table></div> <p>Mais informação:<br /> 🔗 <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_automatic_variables">about_Automatic_Variables — Documentação Oficial</a></p><hr /> <h2 id="16-variáveis-preferenciais"> <a href="#16-variáveis-preferenciais" class="anchor-heading" aria-labelledby="16-variáveis-preferenciais"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.6. Variáveis preferenciais </h2> <p>As <strong>variáveis preferenciais</strong> controlam o comportamento global da sessão PowerShell, como o que fazer perante erros, avisos, mensagens verbose ou debug.</p> <div class="table-wrapper"><table> <thead> <tr> <th><strong>Variável</strong></th> <th><strong>Controla o quê?</strong></th> <th><strong>Valores comuns</strong></th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">$ErrorActionPreference</code></td> <td>O que fazer quando ocorre um erro</td> <td><code class="language-plaintext highlighter-rouge">"Continue"</code>, <code class="language-plaintext highlighter-rouge">"Stop"</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">$VerbosePreference</code></td> <td>Se mensagens <code class="language-plaintext highlighter-rouge">Write-Verbose</code> são mostradas ou não</td> <td><code class="language-plaintext highlighter-rouge">"SilentlyContinue"</code>, <code class="language-plaintext highlighter-rouge">"Continue"</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">$WarningPreference</code></td> <td>Exibição de avisos (<code class="language-plaintext highlighter-rouge">Write-Warning</code>)</td> <td><code class="language-plaintext highlighter-rouge">"Continue"</code>, <code class="language-plaintext highlighter-rouge">"SilentlyContinue"</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">$DebugPreference</code></td> <td>Exibição de mensagens <code class="language-plaintext highlighter-rouge">Write-Debug</code></td> <td><code class="language-plaintext highlighter-rouge">"SilentlyContinue"</code>, <code class="language-plaintext highlighter-rouge">"Continue"</code></td> </tr> </tbody> </table></div> <p>Mais informação:<br /> 🔗 <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_preference_variables">about_Preference_Variables — Documentação Oficial</a></p><hr /> <h3 id="exemplo-com-erroractionpreference"> <a href="#exemplo-com-erroractionpreference" class="anchor-heading" aria-labelledby="exemplo-com-erroractionpreference"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exemplo com <code class="language-plaintext highlighter-rouge">$ErrorActionPreference</code> </h3> <p>Vamos ver como esta variável influencia a execução de scripts com erros.</p> <p><strong>Passo 1 – Criar um script simples</strong></p> <ol> <li> <p>Cria um ficheiro chamado <code class="language-plaintext highlighter-rouge">TestError.ps1</code> com este conteúdo:</p> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="n">Write-Output</span><span class="w"> </span><span class="s2">"Início do script"</span><span class="w">
 </span><span class="n">Get-Item</span><span class="w"> </span><span class="s2">"ficheiro_inexistente.txt"</span><span class="w">
 </span><span class="n">Write-Output</span><span class="w"> </span><span class="s2">"Fim do script"</span><span class="w">
</span></code></pre></div> </div> </li> <li> <p>Corre o script:</p> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="o">.</span><span class="n">\TestError.ps1</span><span class="w">
</span></code></pre></div> </div> </li> </ol> <p><strong>O que acontece?</strong></p> <ul> <li>Vais ver uma mensagem de erro, mas o script <strong>continua a correr</strong>.</li> <li>A linha <code class="language-plaintext highlighter-rouge">"Fim do script"</code> <strong>é executada</strong>.</li> <li>Isto acontece porque o erro é do tipo <strong>non-terminating</strong> e a preferência por omissão é <code class="language-plaintext highlighter-rouge">"Continue"</code>.</li> </ul> <p><strong>Passo 2 – Modificar para interromper com erro</strong></p> <ol> <li> <p>Edita o ficheiro <code class="language-plaintext highlighter-rouge">TestError.ps1</code> e adiciona a linha seguinte antes do <code class="language-plaintext highlighter-rouge">Get-Item</code>:</p> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="bp">$Error</span><span class="n">ActionPreference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Stop"</span><span class="w">
</span></code></pre></div> </div> </li> <li> <p>O novo conteúdo deve ficar assim:</p> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="bp">$Error</span><span class="n">ActionPreference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Stop"</span><span class="w">

 </span><span class="n">Write-Output</span><span class="w"> </span><span class="s2">"Início do script"</span><span class="w">
 </span><span class="n">Get-Item</span><span class="w"> </span><span class="s2">"ficheiro_inexistente.txt"</span><span class="w">
 </span><span class="n">Write-Output</span><span class="w"> </span><span class="s2">"Fim do script"</span><span class="w">
</span></code></pre></div> </div> </li> <li> <p>Corre novamente:</p> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="o">.</span><span class="n">\TestError.ps1</span><span class="w">
</span></code></pre></div> </div> </li> </ol> <p><strong>O que acontece agora?</strong></p> <ul> <li>O erro do <code class="language-plaintext highlighter-rouge">Get-Item</code> faz com que o script <strong>pare imediatamente</strong>.</li> <li>A linha <code class="language-plaintext highlighter-rouge">"Fim do script"</code> <strong>não é executada</strong>.</li> </ul><hr /> <h3 id="explicação"> <a href="#explicação" class="anchor-heading" aria-labelledby="explicação"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Explicação </h3> <ul> <li>Com <code class="language-plaintext highlighter-rouge">$ErrorActionPreference = "Continue"</code> (ou omisso): erros <strong>não param</strong> o script.</li> <li>Com <code class="language-plaintext highlighter-rouge">$ErrorActionPreference = "Stop"</code>: qualquer erro <strong>interrompe</strong> imediatamente a execução.</li> <li>Isto é útil quando não queres que o script continue após falhas críticas.</li> </ul> <h3 id="a-alteração-é-permanente"> <a href="#a-alteração-é-permanente" class="anchor-heading" aria-labelledby="a-alteração-é-permanente"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A alteração é permanente? </h3> <p>Quando alteras uma variável de preferência (como <code class="language-plaintext highlighter-rouge">$ErrorActionPreference</code>), o novo valor só é válido durante a sessão atual.</p> <ul> <li><strong>No terminal:</strong> o valor permanece até fechares a janela do PowerShell.</li> <li><strong>Num script:</strong> o valor afeta apenas a execução do próprio script.</li> </ul> <p>Se voltares a abrir uma nova sessão, o valor volta ao padrão.</p><hr /> <h2 id="17-variáveis-com-nomes-especiais"> <a href="#17-variáveis-com-nomes-especiais" class="anchor-heading" aria-labelledby="17-variáveis-com-nomes-especiais"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.7. Variáveis com nomes especiais </h2> <p>Variáveis podem conter quase qualquer nome, se forem colocadas entre <code class="language-plaintext highlighter-rouge">{}</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>${Nome com espaços} = "Valor"
Write-Output ${Nome com espaços}
</code></pre></div></div> <blockquote> <p>⚠️ Esta prática deve ser evitada, exceto em casos muito específicos.</p> </blockquote><hr /> <h2 id="18-dicas-práticas"> <a href="#18-dicas-práticas" class="anchor-heading" aria-labelledby="18-dicas-práticas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.8. Dicas práticas </h2> <ul> <li>Inicializa sempre variáveis antes de as usares</li> <li>Usa nomes descritivos: <code class="language-plaintext highlighter-rouge">$caminhoRelatorio</code>, <code class="language-plaintext highlighter-rouge">$totalFinal</code></li> <li>Evita sobrescrever variáveis automáticas (ex: <code class="language-plaintext highlighter-rouge">$args</code> ou <code class="language-plaintext highlighter-rouge">$null</code>)</li> </ul><hr /> <h2 id="19-verificar-o-tipo-de-uma-variável"> <a href="#19-verificar-o-tipo-de-uma-variável" class="anchor-heading" aria-labelledby="19-verificar-o-tipo-de-uma-variável"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.9. Verificar o tipo de uma variável </h2> <p>Podes verificar o tipo de uma variável de duas formas principais:</p> <h3 id="usar-gettypename"> <a href="#usar-gettypename" class="anchor-heading" aria-labelledby="usar-gettypename"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Usar <code class="language-plaintext highlighter-rouge">.GetType().Name</code> </h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$var = 42
$var.GetType().Name      # Int32
</code></pre></div></div> <h3 id="usar-o-operador--is"> <a href="#usar-o-operador--is" class="anchor-heading" aria-labelledby="usar-o-operador--is"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Usar o operador <code class="language-plaintext highlighter-rouge">-is</code> </h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$var -is [int]           # True
$var -is [string]        # False
</code></pre></div></div> <h2 id="110--exercicio--identificar-tipos-de-dados"> <a href="#110--exercicio--identificar-tipos-de-dados" class="anchor-heading" aria-labelledby="110--exercicio--identificar-tipos-de-dados"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.10. 🧩 Exercicio – Identificar tipos de dados </h2> <p>Verifica os tipos de diferentes variáveis.</p> <ol> <li>Cria três variáveis: <ul> <li><code class="language-plaintext highlighter-rouge">$a = 42</code></li> <li><code class="language-plaintext highlighter-rouge">$b = "Olá"</code></li> <li><code class="language-plaintext highlighter-rouge">$c = $true</code></li> </ul> </li> <li>Mostra o tipo de cada variável com <code class="language-plaintext highlighter-rouge">.GetType().Name</code></li> <li>Usa o operador <code class="language-plaintext highlighter-rouge">-is</code> para confirmar o tipo</li> </ol> <!-- <details> <summary>Resposta</summary> $a = 42 $b = "Olá" $c = $true $a.GetType().Name # Int32 $b.GetType().Name # String $c.GetType().Name # Boolean $a -is [int] # True $b -is [string] # True $c -is [bool] # True </details> --> <h1 id="2-tipos-de-dados-em-powershell"> <a href="#2-tipos-de-dados-em-powershell" class="anchor-heading" aria-labelledby="2-tipos-de-dados-em-powershell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Tipos de dados em PowerShell </h1> <p>Em PowerShell, cada valor tem um <strong>tipo de dado</strong> associado: texto, número, booleano, lista, dicionário, etc. https://learn.microsoft.com/en-us/powershell/scripting/lang-spec/chapter-04</p> <h3 id="porque-é-importante-conhecer-os-tipos"> <a href="#porque-é-importante-conhecer-os-tipos" class="anchor-heading" aria-labelledby="porque-é-importante-conhecer-os-tipos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Porque é importante conhecer os tipos? </h3> <ul> <li>Alguns comandos esperam tipos específicos</li> <li>Ajuda a prever resultados e evitar erros</li> <li>Permite usar métodos e propriedades corretamente</li> </ul> <h3 id="categorias-principais"> <a href="#categorias-principais" class="anchor-heading" aria-labelledby="categorias-principais"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Categorias principais </h3> <ul> <li><strong>Primitivos</strong> – valores simples como texto, números e booleanos</li> <li><strong>Compostos</strong> – estruturas com múltiplos valores (arrays, hashtables)</li> <li><strong>Objetos</strong> – estruturas complexas devolvidas por comandos (<code class="language-plaintext highlighter-rouge">Get-Process</code>, etc.)</li> </ul><hr /> <h2 id="21-tipos-primitivos"> <a href="#21-tipos-primitivos" class="anchor-heading" aria-labelledby="21-tipos-primitivos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.1. Tipos primitivos </h2> <h3 id="string"> <a href="#string" class="anchor-heading" aria-labelledby="string"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> String </h3> <p>Texto entre aspas:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$nome = "Nuno"
$mensagem = "Olá, $nome!"
</code></pre></div></div> <h3 id="integer"> <a href="#integer" class="anchor-heading" aria-labelledby="integer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Integer </h3> <p>Número inteiro (<code class="language-plaintext highlighter-rouge">Int32</code> por padrão):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ano = 2025
$quantidade = 10
</code></pre></div></div> <h3 id="boolean"> <a href="#boolean" class="anchor-heading" aria-labelledby="boolean"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Boolean </h3> <p>Valores lógicos:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ativo = $true
$temAcesso = $false
</code></pre></div></div> <h3 id="double"> <a href="#double" class="anchor-heading" aria-labelledby="double"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Double </h3> <p>Números com vírgula/ponto decimal:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$pi = 3.14
$temp = -2.7
</code></pre></div></div><hr /> <h2 id="22-tipos-compostos"> <a href="#22-tipos-compostos" class="anchor-heading" aria-labelledby="22-tipos-compostos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.2. Tipos compostos </h2> <h3 id="arrays"> <a href="#arrays" class="anchor-heading" aria-labelledby="arrays"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Arrays </h3> <p>Um array guarda uma lista de valores, acedidos por posição (índice).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$nomes = @("Ana", "Bruno", "Carlos")
$numeros = 1, 2, 3, 4
</code></pre></div></div> <p>Aceder a elementos:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$nomes[0]        # Ana
$numeros[2]      # 3
</code></pre></div></div> <p>Adicionar um elemento:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$nomes += "Diana"
</code></pre></div></div> <blockquote> <p>⚠️ O operador <code class="language-plaintext highlighter-rouge">+=</code> cria um novo array. Para muitos elementos, usa <code class="language-plaintext highlighter-rouge">ArrayList</code>.</p> </blockquote> <p>Ver número de elementos:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$nomes.Count
</code></pre></div></div> <p><strong>Nota:</strong> <code class="language-plaintext highlighter-rouge">@()</code> é a forma explícita de criar arrays, mesmo com 1 elemento.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$umElemento = @("Ana")     # Array com 1 item
$vazio = @()               # Array vazio
</code></pre></div></div> <h3 id="arrays-dinâmicos-arraylist"> <a href="#arrays-dinâmicos-arraylist" class="anchor-heading" aria-labelledby="arrays-dinâmicos-arraylist"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Arrays dinâmicos: ArrayList </h3> <p>Mais eficiente para adicionar valores dinamicamente:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$lista = New-Object System.Collections.ArrayList
$lista.Add("Ana")    
$lista.Add("Bruno")  
</code></pre></div></div> <p>Ver conteúdo e número de elementos:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$lista
$lista.Count
</code></pre></div></div> <div class="table-wrapper"><table> <thead> <tr> <th> </th> <th>Array</th> <th>ArrayList</th> </tr> </thead> <tbody> <tr> <td>Tamanho fixo</td> <td>Sim (cria nova cópia)</td> <td>Não (cresce com <code class="language-plaintext highlighter-rouge">.Add()</code>)</td> </tr> <tr> <td>Ideal para</td> <td>Listas simples e pequenas</td> <td>Adições frequentes ou dinâmicas</td> </tr> </tbody> </table></div><hr /> <h3 id="hashtables"> <a href="#hashtables" class="anchor-heading" aria-labelledby="hashtables"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hashtables </h3> <p>Uma hashtable é uma coleção de pares chave/valor, semelhante a um dicionário em Python.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$aluno = @{
    Nome = "Joana"
    Idade = 27
    Ativo = $true
}
</code></pre></div></div> <p>Aceder a valores:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$aluno["Nome"]     # Joana
$aluno.Idade       # 27
</code></pre></div></div> <p>Adicionar novo par:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$aluno["Curso"] = "PowerShell"
</code></pre></div></div> <p>Listar chaves e valores:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$aluno.Keys
$aluno.Values
</code></pre></div></div> <blockquote> <p>Dica: Usa hashtables para representar objetos simples ou configurar parâmetros.</p> </blockquote><hr /> <p>Mais informação oficial:<br /> 🔗 <a href="https://learn.microsoft.com/en-us/powershell/scripting/lang-spec/chapter-04">PowerShell Language Specification – Chapter 4</a></p><hr /> <h2 id="23--exercicios"> <a href="#23--exercicios" class="anchor-heading" aria-labelledby="23--exercicios"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.3. 🧩 Exercicios </h2> <h3 id="-exercício---trabalhar-com-arrays-de-números"> <a href="#-exercício---trabalhar-com-arrays-de-números" class="anchor-heading" aria-labelledby="-exercício---trabalhar-com-arrays-de-números"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 🧩 Exercício - Trabalhar com arrays de números </h3> <p>Cria um array com números e manipula-o.</p> <ol> <li>Cria um array <code class="language-plaintext highlighter-rouge">$valores</code> com os números <code class="language-plaintext highlighter-rouge">5</code>, <code class="language-plaintext highlighter-rouge">10</code>, <code class="language-plaintext highlighter-rouge">15</code>, <code class="language-plaintext highlighter-rouge">20</code></li> <li>Mostra quantos elementos tem o array</li> <li>Soma o primeiro e o último valor</li> <li>Substitui o valor <code class="language-plaintext highlighter-rouge">15</code> por <code class="language-plaintext highlighter-rouge">30</code></li> <li>Mostra o array atualizado</li> </ol> <!-- <details> <summary>Resposta</summary> $valores = 5, 10, 15, 20 Write-Output "N.º de elementos: $($valores.Count)" Write-Output "Soma: $($valores[0] + $valores[-1])" $valores[2] = 30 Write-Output "Array atualizado:" $valores </details> --> <h3 id="-exercício--aceder-e-modificar-valores-num-array-clássico"> <a href="#-exercício--aceder-e-modificar-valores-num-array-clássico" class="anchor-heading" aria-labelledby="-exercício--aceder-e-modificar-valores-num-array-clássico"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 🧩 Exercício – Aceder e modificar valores num Array clássico </h3> <p>Imagina que estás a guardar os nomes dos participantes de um workshop.</p> <ol> <li>Cria um array <code class="language-plaintext highlighter-rouge">$participantes</code> com os nomes: <code class="language-plaintext highlighter-rouge">"Ana"</code>, <code class="language-plaintext highlighter-rouge">"Bruno"</code>, <code class="language-plaintext highlighter-rouge">"Carlos"</code>, <code class="language-plaintext highlighter-rouge">"Diana"</code>, <code class="language-plaintext highlighter-rouge">"Eduardo"</code></li> <li>Mostra o nome que está na <strong>4.ª posição</strong> (índice 3)</li> <li>Carlos avisou que não vai poder participar — substitui <code class="language-plaintext highlighter-rouge">"Carlos"</code> por <code class="language-plaintext highlighter-rouge">"Catarina"</code></li> <li>Mostra o array atualizado</li> </ol> <!-- <details> <summary>Resposta</summary> # Criar array $participantes = @("Ana", "Bruno", "Carlos", "Diana", "Eduardo") # Mostrar o valor da 4ª posição (índice 3) Write-Output "Participante na 4ª posição: $($participantes[3])" # Alterar "Carlos" (índice 2) para "Catarina" $participantes[2] = "Catarina" # Mostrar array atualizado Write-Output "Lista atualizada:" $participantes </details> --><hr /> <h3 id="-exercício--aceder-e-modificar-valores-num-arraylist"> <a href="#-exercício--aceder-e-modificar-valores-num-arraylist" class="anchor-heading" aria-labelledby="-exercício--aceder-e-modificar-valores-num-arraylist"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 🧩 Exercício – Aceder e modificar valores num <code class="language-plaintext highlighter-rouge">ArrayList</code> </h3> <p>Estás a gerir uma lista dinâmica de tarefas.</p> <ol> <li>Cria um <code class="language-plaintext highlighter-rouge">ArrayList</code> chamado <code class="language-plaintext highlighter-rouge">$tarefas</code></li> <li>Adiciona as seguintes tarefas: <code class="language-plaintext highlighter-rouge">"Enviar email"</code>, <code class="language-plaintext highlighter-rouge">"Rever relatório"</code>, <code class="language-plaintext highlighter-rouge">"Atualizar base de dados"</code></li> <li>Mostra a tarefa que está na <strong>1.ª posição</strong></li> <li>A tarefa <code class="language-plaintext highlighter-rouge">"Rever relatório"</code> já não é necessária — remove-a</li> <li>Adiciona a tarefa <code class="language-plaintext highlighter-rouge">"Ligar ao cliente"</code></li> <li>Mostra a lista final</li> </ol> <!-- <details> <summary>Resposta</summary> # Criar ArrayList $tarefas = New-Object System.Collections.ArrayList $tarefas.Add("Enviar email") > $null $tarefas.Add("Rever relatório") > $null $tarefas.Add("Atualizar base de dados") > $null # Mostrar 1ª tarefa (índice 0) Write-Output "Primeira tarefa: $($tarefas[0])" # Remover "Rever relatório" $tarefas.Remove("Rever relatório") # Adicionar nova tarefa $tarefas.Add("Ligar ao cliente") > $null # Mostrar tarefas finais Write-Output "Lista final de tarefas:" $tarefas </details> --><hr /> <h3 id="-exercício--aceder-e-modificar-valores-numa-hashtable"> <a href="#-exercício--aceder-e-modificar-valores-numa-hashtable" class="anchor-heading" aria-labelledby="-exercício--aceder-e-modificar-valores-numa-hashtable"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 🧩 Exercício – Aceder e modificar valores numa <code class="language-plaintext highlighter-rouge">Hashtable</code> </h3> <p>Tens os dados de um utilizador numa hashtable. Vais atualizar a informação com base em novos dados recebidos.</p> <ol> <li>Cria uma hashtable chamada <code class="language-plaintext highlighter-rouge">$utilizador</code> com: <ul> <li><code class="language-plaintext highlighter-rouge">Nome = "Tiago"</code></li> <li><code class="language-plaintext highlighter-rouge">Idade = 34</code></li> <li><code class="language-plaintext highlighter-rouge">Email = "tiago@email.com"</code></li> </ul> </li> <li>Mostra o valor do campo <code class="language-plaintext highlighter-rouge">Email</code></li> <li>Tiago pediu para atualizar o email para <code class="language-plaintext highlighter-rouge">"tiago.silva@email.com"</code></li> <li>Adiciona uma nova chave <code class="language-plaintext highlighter-rouge">Ativo = $true</code></li> <li>Mostra todos os pares chave/valor</li> </ol> <!-- <details> <summary>Resposta</summary> # Criar hashtable $utilizador = @{ Nome = "Tiago" Idade = 34 Email = "tiago@email.com" } # Mostrar email atual Write-Output "Email atual: $($utilizador["Email"])" # Atualizar email $utilizador["Email"] = "tiago.silva@email.com" # Adicionar novo campo $utilizador["Ativo"] = $true # Mostrar hashtable final Write-Output "Dados do utilizador:" $utilizador </details> --><hr /> <h2 id="24-operadores-básicos"> <a href="#24-operadores-básicos" class="anchor-heading" aria-labelledby="24-operadores-básicos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.4. Operadores básicos </h2> <p>Nesta secção vamos explorar os operadores mais comuns em PowerShell, utilizados para efetuar cálculos, comparar valores, combinar condições e manipular strings.</p> <h3 id="operadores-aritméticos"> <a href="#operadores-aritméticos" class="anchor-heading" aria-labelledby="operadores-aritméticos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Operadores aritméticos </h3> <p>Usados para realizar cálculos com números.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Operador</th> <th>Descrição</th> <th>Exemplo</th> <th>Resultado</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">+</code></td> <td>Soma</td> <td><code class="language-plaintext highlighter-rouge">2 + 3</code></td> <td>5</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">-</code></td> <td>Subtração</td> <td><code class="language-plaintext highlighter-rouge">10 - 4</code></td> <td>6</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">*</code></td> <td>Multiplicação</td> <td><code class="language-plaintext highlighter-rouge">5 * 2</code></td> <td>10</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">/</code></td> <td>Divisão</td> <td><code class="language-plaintext highlighter-rouge">10 / 2</code></td> <td>5</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">%</code></td> <td>Módulo (resto)</td> <td><code class="language-plaintext highlighter-rouge">7 % 3</code></td> <td>1</td> </tr> </tbody> </table></div><hr /> <h3 id="operadores-de-comparação"> <a href="#operadores-de-comparação" class="anchor-heading" aria-labelledby="operadores-de-comparação"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Operadores de comparação </h3> <p>Usados para comparar valores. O resultado é sempre <code class="language-plaintext highlighter-rouge">$true</code> ou <code class="language-plaintext highlighter-rouge">$false</code>.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Operador</th> <th>Significado</th> <th>Exemplo</th> <th>Resultado</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">-eq</code></td> <td>Igual</td> <td><code class="language-plaintext highlighter-rouge">5 -eq 5</code></td> <td><code class="language-plaintext highlighter-rouge">$true</code></td> </tr> <tr> <td> </td> <td> </td> <td><code class="language-plaintext highlighter-rouge">"ana" -eq "Ana"</code></td> <td><code class="language-plaintext highlighter-rouge">$false</code></td> </tr> <tr> <td> </td> <td> </td> <td><code class="language-plaintext highlighter-rouge">$data1 -eq $data2</code></td> <td>Depende</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">-ne</code></td> <td>Diferente</td> <td><code class="language-plaintext highlighter-rouge">5 -ne 3</code></td> <td><code class="language-plaintext highlighter-rouge">$true</code></td> </tr> <tr> <td> </td> <td> </td> <td><code class="language-plaintext highlighter-rouge">"a" -ne "b"</code></td> <td><code class="language-plaintext highlighter-rouge">$true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">-gt</code></td> <td>Maior que</td> <td><code class="language-plaintext highlighter-rouge">10 -gt 5</code></td> <td><code class="language-plaintext highlighter-rouge">$true</code></td> </tr> <tr> <td> </td> <td> </td> <td><code class="language-plaintext highlighter-rouge">"zebra" -gt "abelha"</code></td> <td><code class="language-plaintext highlighter-rouge">$true</code></td> </tr> <tr> <td> </td> <td> </td> <td><code class="language-plaintext highlighter-rouge">Get-Date -gt (Get-Date).AddDays(-1)</code></td> <td><code class="language-plaintext highlighter-rouge">$true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">-lt</code></td> <td>Menor que</td> <td><code class="language-plaintext highlighter-rouge">3 -lt 8</code></td> <td><code class="language-plaintext highlighter-rouge">$true</code></td> </tr> <tr> <td> </td> <td> </td> <td><code class="language-plaintext highlighter-rouge">"abc" -lt "bcd"</code></td> <td><code class="language-plaintext highlighter-rouge">$true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">-ge</code></td> <td>Maior ou igual</td> <td><code class="language-plaintext highlighter-rouge">5 -ge 5</code></td> <td><code class="language-plaintext highlighter-rouge">$true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">-le</code></td> <td>Menor ou igual</td> <td><code class="language-plaintext highlighter-rouge">2 -le 3</code></td> <td><code class="language-plaintext highlighter-rouge">$true</code></td> </tr> </tbody> </table></div> <blockquote> <p>⚠️ <strong>Notas importantes:</strong></p> <ul> <li> <p><strong>Strings</strong> são comparadas por ordem alfabética (lexicográfica) e de forma <strong>case-sensitive</strong>.<br /> Exemplo: <code class="language-plaintext highlighter-rouge">"ana" -eq "Ana"</code> devolve <code class="language-plaintext highlighter-rouge">$false</code>, <code class="language-plaintext highlighter-rouge">"abc" -lt "bcd"</code> devolve <code class="language-plaintext highlighter-rouge">$true</code>.</p> </li> <li> <p><strong>Datas</strong> são objetos do tipo <code class="language-plaintext highlighter-rouge">DateTime</code>, e podem ser comparadas diretamente com estes operadores.<br /> Exemplo: <code class="language-plaintext highlighter-rouge">Get-Date -gt (Get-Date).AddDays(-1)</code> devolve <code class="language-plaintext highlighter-rouge">$true</code>.</p> </li> </ul> </blockquote><hr /> <h3 id="operadores-lógicos"> <a href="#operadores-lógicos" class="anchor-heading" aria-labelledby="operadores-lógicos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Operadores lógicos </h3> <p>Usados para combinar condições booleanas.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Operador</th> <th>Significado</th> <th>Exemplo</th> <th>Resultado</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">-and</code></td> <td>E lógico</td> <td><code class="language-plaintext highlighter-rouge">$true -and $false</code></td> <td><code class="language-plaintext highlighter-rouge">$false</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">-or</code></td> <td>OU lógico</td> <td><code class="language-plaintext highlighter-rouge">$true -or $false</code></td> <td><code class="language-plaintext highlighter-rouge">$true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">-not</code></td> <td>Negação</td> <td><code class="language-plaintext highlighter-rouge">-not $true</code></td> <td><code class="language-plaintext highlighter-rouge">$false</code></td> </tr> </tbody> </table></div><hr /> <h3 id="concatenação-de-strings"> <a href="#concatenação-de-strings" class="anchor-heading" aria-labelledby="concatenação-de-strings"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Concatenação de strings </h3> <p>Podes juntar texto usando o operador <code class="language-plaintext highlighter-rouge">+</code> ou interpolação com aspas.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$nome = "Nuno"
"Olá, " + $nome + "!"           # concatenação
"Olá, $nome!"                   # interpolação
</code></pre></div></div><hr /> <h3 id="atribuição-combinada"> <a href="#atribuição-combinada" class="anchor-heading" aria-labelledby="atribuição-combinada"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Atribuição combinada </h3> <p>Permite atualizar valores com base no conteúdo atual da variável.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$x = 5
$x += 2       # agora $x vale 7
$x -= 1       # agora $x vale 6
$x *= 3       # agora $x vale 18
$x /= 2       # agora $x vale 9
</code></pre></div></div> <p>Funciona com números e até com arrays (ex: <code class="language-plaintext highlighter-rouge">$lista += "NovoValor"</code>).</p><hr /> <h2 id="25--exercícios"> <a href="#25--exercícios" class="anchor-heading" aria-labelledby="25--exercícios"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.5. 🧩 Exercícios </h2> <h3 id="-exercício---operadores"> <a href="#-exercício---operadores" class="anchor-heading" aria-labelledby="-exercício---operadores"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 🧩 Exercício - Operadores </h3> <ol> <li>Cria uma variável <code class="language-plaintext highlighter-rouge">$a</code> com valor 10</li> <li>Cria uma variável <code class="language-plaintext highlighter-rouge">$b</code> com valor 3</li> <li>Mostra a soma, subtração, multiplicação e divisão de <code class="language-plaintext highlighter-rouge">$a</code> com <code class="language-plaintext highlighter-rouge">$b</code></li> <li>Verifica se <code class="language-plaintext highlighter-rouge">$a</code> é maior que <code class="language-plaintext highlighter-rouge">$b</code></li> <li>Verifica se <code class="language-plaintext highlighter-rouge">$a</code> é menor ou igual a <code class="language-plaintext highlighter-rouge">$b</code></li> <li>Faz <code class="language-plaintext highlighter-rouge">$a -gt 5 -and $b -lt 2</code></li> <li>Faz <code class="language-plaintext highlighter-rouge">$a -gt 5 -or $b -lt 2</code></li> <li>Junta duas strings com <code class="language-plaintext highlighter-rouge">+</code> e depois com interpolação</li> </ol> <!-- <details> <summary>Resposta</summary> # Linha 1 $a = 10 # Linha 2 $b = 3 # Linha 3 – Operações aritméticas Write-Output "Soma: $($a + $b)" Write-Output "Subtração: $($a - $b)" Write-Output "Multiplicação: $($a * $b)" Write-Output "Divisão: $($a / $b)" # Linha 4 – Comparações simples Write-Output "$a > $b: $($a -gt $b)" Write-Output "$a <= $b: $($a -le $b)" # Linha 6 – Operador AND Write-Output "($a -gt 5) -and ($b -lt 2): $($a -gt 5 -and $b -lt 2)" # Linha 7 – Operador OR Write-Output "($a -gt 5) -or ($b -lt 2): $($a -gt 5 -or $b -lt 2)" # Linha 8 – Strings $nome = "Nuno" Write-Output "Olá, " + $nome + "!" Write-Output "Olá, $nome!" </details> --> <h3 id="-exercício---atribuição-combinada"> <a href="#-exercício---atribuição-combinada" class="anchor-heading" aria-labelledby="-exercício---atribuição-combinada"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 🧩 Exercício - Atribuição combinada </h3> <ol> <li>Cria uma variável <code class="language-plaintext highlighter-rouge">$total</code> com valor <code class="language-plaintext highlighter-rouge">10</code></li> <li>Soma <code class="language-plaintext highlighter-rouge">5</code> ao valor de <code class="language-plaintext highlighter-rouge">$total</code> usando <code class="language-plaintext highlighter-rouge">+=</code></li> <li>Multiplica o valor atual por <code class="language-plaintext highlighter-rouge">2</code> usando <code class="language-plaintext highlighter-rouge">*=</code></li> <li>Subtrai <code class="language-plaintext highlighter-rouge">4</code> com <code class="language-plaintext highlighter-rouge">-=</code></li> <li>Mostra o resultado final com <code class="language-plaintext highlighter-rouge">Write-Output</code></li> </ol> <!-- <details> <summary>Resposta</summary> # Linha 1 $total = 10 # Linha 2 $total += 5 # Agora é 15 # Linha 3 $total *= 2 # Agora é 30 # Linha 4 $total -= 4 # Agora é 26 # Linha 5 Write-Output "Total final: $total" </details> --><hr /> <h2 id="26-boas-práticas-com-variáveis"> <a href="#26-boas-práticas-com-variáveis" class="anchor-heading" aria-labelledby="26-boas-práticas-com-variáveis"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.6. Boas práticas com variáveis </h2> <p>Usar variáveis corretamente torna os teus scripts mais legíveis, fáceis de manter e menos propensos a erros. Aqui ficam algumas boas práticas essenciais:</p> <h3 id="-nomeação-clara-e-consistente"> <a href="#-nomeação-clara-e-consistente" class="anchor-heading" aria-labelledby="-nomeação-clara-e-consistente"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ✅ Nomeação clara e consistente </h3> <ul> <li>Usa nomes descritivos: <code class="language-plaintext highlighter-rouge">$precoTotal</code>, <code class="language-plaintext highlighter-rouge">$listaClientes</code></li> <li>Mantém um padrão (ex: <code class="language-plaintext highlighter-rouge">camelCase</code> ou <code class="language-plaintext highlighter-rouge">snake_case</code>) e sê consistente</li> <li>Evita nomes genéricos ou confusos como <code class="language-plaintext highlighter-rouge">$x</code>, <code class="language-plaintext highlighter-rouge">$dados1</code>, <code class="language-plaintext highlighter-rouge">$var</code></li> </ul> <h3 id="-inicializa-sempre-as-variáveis"> <a href="#-inicializa-sempre-as-variáveis" class="anchor-heading" aria-labelledby="-inicializa-sempre-as-variáveis"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ✅ Inicializa sempre as variáveis </h3> <ul> <li>Atribui um valor inicial às variáveis antes de as usares, mesmo que seja <code class="language-plaintext highlighter-rouge">$null</code></li> <li> <p>Isso evita comportamentos inesperados</p> <p>$resultado = $null $resultado = Get-Data</p> </li> </ul> <h3 id="-usa-o-tipo-certo-tipagem-explícita-quando-necessário"> <a href="#-usa-o-tipo-certo-tipagem-explícita-quando-necessário" class="anchor-heading" aria-labelledby="-usa-o-tipo-certo-tipagem-explícita-quando-necessário"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ✅ Usa o tipo certo (tipagem explícita quando necessário) </h3> <ul> <li>Usa <code class="language-plaintext highlighter-rouge">[int]</code>, <code class="language-plaintext highlighter-rouge">[string]</code>, etc., quando precisas garantir que os dados têm o tipo certo</li> <li>Evita erros de conversão ao passar variáveis para funções ou APIs</li> </ul> <h3 id="-evita-sobrescrever-variáveis-automáticas"> <a href="#-evita-sobrescrever-variáveis-automáticas" class="anchor-heading" aria-labelledby="-evita-sobrescrever-variáveis-automáticas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ✅ Evita sobrescrever variáveis automáticas </h3> <ul> <li>Não uses nomes como <code class="language-plaintext highlighter-rouge">$args</code>, <code class="language-plaintext highlighter-rouge">$null</code>, <code class="language-plaintext highlighter-rouge">$input</code>, <code class="language-plaintext highlighter-rouge">$true</code>, <code class="language-plaintext highlighter-rouge">$false</code> para as tuas variáveis</li> <li>Estas variáveis já têm significado especial no PowerShell</li> </ul> <h3 id="️-erros-comuns-a-evitar"> <a href="#️-erros-comuns-a-evitar" class="anchor-heading" aria-labelledby="️-erros-comuns-a-evitar"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ⚠️ Erros comuns a evitar </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Erro comum</th> <th>Explicação</th> </tr> </thead> <tbody> <tr> <td>Usar <code class="language-plaintext highlighter-rouge">=</code> em vez de <code class="language-plaintext highlighter-rouge">-eq</code></td> <td><code class="language-plaintext highlighter-rouge">=</code> serve para atribuir, <code class="language-plaintext highlighter-rouge">-eq</code> é o operador de comparação</td> </tr> <tr> <td>Esquecer que os arrays começam em <code class="language-plaintext highlighter-rouge">0</code></td> <td><code class="language-plaintext highlighter-rouge">$array[1]</code> é o <strong>segundo</strong> elemento</td> </tr> <tr> <td>Aceder a variáveis não inicializadas</td> <td>Pode resultar em erro ou valor <code class="language-plaintext highlighter-rouge">$null</code></td> </tr> <tr> <td>Confundir <code class="language-plaintext highlighter-rouge">+</code> com concatenação e soma</td> <td>Pode causar problemas se não souberes o tipo da variável</td> </tr> <tr> <td>Não usar aspas quando necessário</td> <td><code class="language-plaintext highlighter-rouge">Write-Output $nome</code> vs. <code class="language-plaintext highlighter-rouge">Write-Output "$nome"</code></td> </tr> </tbody> </table></div> <blockquote> <p>Dica: Se algo não estiver a funcionar como esperas, usa <code class="language-plaintext highlighter-rouge">Write-Output</code>, <code class="language-plaintext highlighter-rouge">Write-Host</code> ou <code class="language-plaintext highlighter-rouge">GetType()</code> para inspecionar os valores e tipos.</p> </blockquote> <h2 id="27-recursos-adicionais"> <a href="#27-recursos-adicionais" class="anchor-heading" aria-labelledby="27-recursos-adicionais"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.7. Recursos adicionais </h2> <p>Aqui ficam alguns links úteis para aprofundares os teus conhecimentos sobre variáveis, tipos de dados e boas práticas em PowerShell:</p> <ul> <li>🔗 <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_variables">about_Variables — Documentação oficial</a></li> <li>🔗 <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_automatic_variables">about_Automatic_Variables — Variáveis automáticas</a></li> <li>🔗 <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_preference_variables">about_Preference_Variables — Variáveis preferenciais</a></li> <li>🔗 <a href="https://learn.microsoft.com/en-us/powershell/scripting/lang-spec/chapter-04">PowerShell Language Specification – Chapter 4: Data Types and Variables</a></li> </ul> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
