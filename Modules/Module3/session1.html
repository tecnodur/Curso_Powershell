<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/Curso_Powershell/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/Curso_Powershell/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(1)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(4) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(4) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(4) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(4) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(4) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; } </style> <script src="/Curso_Powershell/assets/js/vendor/lunr.min.js"></script> <script src="/Curso_Powershell/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Session 1: Scripts, Seguran√ßa, Fun√ß√µes e Personaliza√ß√£o | PowerShell Workshop</title> <meta name="generator" content="Jekyll v4.3.4" /> <meta property="og:title" content="Session 1: Scripts, Seguran√ßa, Fun√ß√µes e Personaliza√ß√£o" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A project site with collapsible side navigation." /> <meta property="og:description" content="A project site with collapsible side navigation." /> <link rel="canonical" href="https://tecnodur.github.io/Curso_Powershell/Modules/Module3/session1.html" /> <meta property="og:url" content="https://tecnodur.github.io/Curso_Powershell/Modules/Module3/session1.html" /> <meta property="og:site_name" content="PowerShell Workshop" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Session 1: Scripts, Seguran√ßa, Fun√ß√µes e Personaliza√ß√£o" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"A project site with collapsible side navigation.","headline":"Session 1: Scripts, Seguran√ßa, Fun√ß√µes e Personaliza√ß√£o","url":"https://tecnodur.github.io/Curso_Powershell/Modules/Module3/session1.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/Curso_Powershell/" class="site-title lh-tight"> PowerShell Workshop </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/" class="nav-list-link">Curso de PowerShell & Shell Scripting</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in M√≥dulo 1: Introdu√ß√£o ao PowerShell e Shell Scripting category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module1/" class="nav-list-link">M√≥dulo 1: Introdu√ß√£o ao PowerShell e Shell Scripting</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module1/session1.html" class="nav-list-link">Session 1: Conceitos B√°sicos e Configura√ß√£o</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module1/session2.html" class="nav-list-link">Sess√£o 2: Comandos, Navega√ß√£o e Ajuda</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module1/session3.html" class="nav-list-link">Session 3: Objetos, par√¢metros, pipeline, output, exporta√ß√µes</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in M√≥dulo 2: Fundamentos de Scripting e L√≥gica em PowerShell category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module2/" class="nav-list-link">M√≥dulo 2: Fundamentos de Scripting e L√≥gica em PowerShell</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session1.html" class="nav-list-link">Session 1: Criar e Executar Scripts</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session2.html" class="nav-list-link">Session 2: Vari√°veis e Tipos de Dados</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session3.html" class="nav-list-link">Session 3: Tratamento de Erros com try, catch e finally</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session4.html" class="nav-list-link">Session 4: Manipula√ß√£o de Texto e Dados Simples</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session5.html" class="nav-list-link">Session 5: Estruturas Condicionais</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session6.html" class="nav-list-link">Session 6: Loops e Itera√ß√µes</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in M√≥dulo 3: Gest√£o de Ficheiros e Processos category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module3/" class="nav-list-link">M√≥dulo 3: Gest√£o de Ficheiros e Processos</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session1.html" class="nav-list-link">Session 1: Scripts, Seguran√ßa, Fun√ß√µes e Personaliza√ß√£o</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session2.html" class="nav-list-link">Session 2: Manipula√ß√£o e Transforma√ß√£o de Cole√ß√µes</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session3.html" class="nav-list-link">Session 3: Personaliza√ß√£o do Ambiente PowerShell</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session4.html" class="nav-list-link">Session 4: Scripts Tem√°ticos com Ficheiros</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session5.html" class="nav-list-link">Session 5: Pesquisa, Filtragem e Exporta√ß√£o</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in M√≥dulo 4: Integra√ß√£o Avan√ßada, Automatiza√ß√£o e Ecossistemas category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module4/" class="nav-list-link">M√≥dulo 4: Integra√ß√£o Avan√ßada, Automatiza√ß√£o e Ecossistemas</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session1.html" class="nav-list-link">Session 1: PowerShell em Linux com WSL</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session2.html" class="nav-list-link">Session 2: PowerShell vs CMD: Diferen√ßas e Utiliza√ß√£o no Windows</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session3.html" class="nav-list-link">Session 3: Tarefas Agendadas e Cron Jobs</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session4.html" class="nav-list-link">Session 4: Servi√ßos, Logs e Alertas</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session5.html" class="nav-list-link">Session 5: Notifica√ß√µes e Relat√≥rios Automatizados</a></li></ul></li><li class="nav-list-item"><a href="/Curso_Powershell/refRapida.html" class="nav-list-link">Refer√™ncia R√°pida</a></li><li class="nav-list-item"><a href="/Curso_Powershell/vscode.html" class="nav-list-link">Visual Studio Code com PowerShell</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search PowerShell Workshop" aria-label="Search PowerShell Workshop" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/Curso_Powershell/Modules/Module3/">M√≥dulo 3: Gest√£o de Ficheiros e Processos</a></li> <li class="breadcrumb-nav-list-item"><span>Session 1: Scripts, Seguran√ßa, Fun√ß√µes e Personaliza√ß√£o</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h2 style="all: unset; font-size: 5em; font-weight: bold;"> üß≠ Sess√£o 1: Scripts, Seguran√ßa, Fun√ß√µes e Personaliza√ß√£o </h2> <p><br /></p> <p><strong>üéØ Objetivo</strong> Consolidar pr√°ticas seguras e profissionais na cria√ß√£o de scripts PowerShell, introduzir o conceito de fun√ß√µes reutiliz√°veis, refor√ßar a recolha e valida√ß√£o de inputs, e personalizar o ambiente PowerShell para desenvolvimento.</p><hr /> <ul> <li><a href="#1-relembrar-execu√ß√£o-de-scripts-e-caminhos">1. Relembrar: Execu√ß√£o de Scripts e Caminhos</a> <ul> <li><a href="#11-executar-scripts-ps1">1.1. Executar scripts <code class="language-plaintext highlighter-rouge">.ps1</code></a></li> <li><a href="#12-caminhos-absolutos-vs-caminhos-relativos">1.2. Caminhos absolutos vs caminhos relativos</a></li> <li><a href="#13-usar-psscriptroot--join-path">1.3. Usar <code class="language-plaintext highlighter-rouge">$PSScriptRoot</code> + <code class="language-plaintext highlighter-rouge">Join-Path</code></a></li> </ul> </li> <li><a href="#2-seguran√ßa-e-boas-pr√°ticas-ao-trabalhar-com-scripts">2. Seguran√ßa e Boas Pr√°ticas ao Trabalhar com Scripts</a> <ul> <li><a href="#21-scripts-de-fontes-desconhecidas">2.1. Scripts de fontes desconhecidas</a></li> <li><a href="#22-boas-pr√°ticas-ao-correr-scripts-externos">2.2. Boas pr√°ticas ao correr scripts externos</a></li> <li><a href="#23-l√≥gica-de-confirma√ß√£o-antes-de-a√ß√µes-sens√≠veis">2.3. L√≥gica de confirma√ß√£o antes de a√ß√µes sens√≠veis</a></li> <li><a href="#24-registo-e-controlo-logging-b√°sico">2.4. Registo e controlo (logging b√°sico)</a></li> <li><a href="#25-exemplo-uso-simples-de-write-verbose">2.5. Exemplo: Uso simples de <code class="language-plaintext highlighter-rouge">Write-Verbose</code></a></li> <li><a href="#26-dica-adicional">2.6. Dica adicional</a></li> <li><a href="#27-tipos-de-mensagens-no-terminal-canais-de-escrita">2.7. Tipos de mensagens no terminal (canais de escrita)</a></li> </ul> </li> <li><a href="#3-criar-logs-em-powershell">3. Criar Logs em PowerShell</a> <ul> <li><a href="#31-o-que-colocar-nos-logs">3.1. O que colocar nos logs?</a></li> <li><a href="#32-formatos-de-data-√∫teis">3.2. Formatos de data √∫teis</a></li> <li><a href="#33-iniciar-um-log-com-informa√ß√µes-b√°sicas">3.3. Iniciar um log com informa√ß√µes b√°sicas</a></li> <li><a href="#34-exemplo-de-entradas-de-log-com-tags">3.4. Exemplo de entradas de log com tags</a></li> <li><a href="#35-criar-ficheiro-de-log-√∫nico-por-execu√ß√£o">3.5. Criar ficheiro de log √∫nico por execu√ß√£o</a></li> <li><a href="#36-fechar-o-log-com-mensagem-de-fim">3.6. Fechar o log com mensagem de fim</a></li> <li><a href="#37-exemplo-completo-script-que-apaga-um-ficheiro-com-logging-e-confirma√ß√£o">3.7. Exemplo completo: script que apaga um ficheiro com logging e confirma√ß√£o</a></li> <li><a href="#38--exerc√≠cio-copiar-ficheiro-com-logging-personalizado">3.8. üß© Exerc√≠cio: copiar ficheiro com logging personalizado</a></li> </ul> </li> <li><a href="#4-fun√ß√µes-em-powershell">4. Fun√ß√µes em PowerShell</a> <ul> <li><a href="#41-o-que-√©-uma-fun√ß√£o">4.1. O que √© uma fun√ß√£o?</a></li> <li><a href="#42-fun√ß√µes-com-par√¢metros">4.2. Fun√ß√µes com par√¢metros</a></li> <li><a href="#43-tipagem-de-par√¢metros-opcional">4.3. Tipagem de par√¢metros (opcional)</a></li> <li><a href="#44-fun√ß√µes-para-modularizar-scripts">4.4. Fun√ß√µes para modularizar scripts</a></li> <li><a href="#45-usar-return-para-devolver-valores">4.5. Usar <code class="language-plaintext highlighter-rouge">return</code> para devolver valores</a></li> <li><a href="#46-boas-pr√°ticas-ao-criar-fun√ß√µes">4.6. Boas pr√°ticas ao criar fun√ß√µes</a></li> <li><a href="#47-verbos-aprovados-pelo-powershell">4.7. Verbos aprovados pelo PowerShell</a></li> <li><a href="#48--exerc√≠cios-com-fun√ß√µes">4.8. üß© Exerc√≠cios com fun√ß√µes</a></li> </ul> </li> <li><a href="#5-recolha-de-inputs-do-utilizador">5. Recolha de Inputs do Utilizador</a> <ul> <li><a href="#51-recolher-input-com-read-host">5.1. Recolher input com <code class="language-plaintext highlighter-rouge">Read-Host</code></a></li> <li><a href="#52-converter-e-validar-o-input">5.2. Converter e validar o input</a></li> <li><a href="#53-confirmar-a√ß√µes-com-input">5.3. Confirmar a√ß√µes com input</a></li> <li><a href="#54-input-com-janela-gr√°fica">5.4. Input com janela gr√°fica</a></li> <li><a href="#55-sanitiza√ß√£o-e-boas-pr√°ticas">5.5. Sanitiza√ß√£o e boas pr√°ticas</a></li> <li><a href="#56-exemplo-sem-sanitiza√ß√£o-vs-com-sanitiza√ß√£o-simples-e-seguro">5.6. Exemplo: sem sanitiza√ß√£o vs com sanitiza√ß√£o (simples e seguro)</a></li> <li><a href="#57--exerc√≠cios-sobre-input">5.7. üß© Exerc√≠cios sobre Input</a></li> </ul> </li> </ul><hr /> <h2 id="1-relembrar-execu√ß√£o-de-scripts-e-caminhos"> <a href="#1-relembrar-execu√ß√£o-de-scripts-e-caminhos" class="anchor-heading" aria-labelledby="1-relembrar-execu√ß√£o-de-scripts-e-caminhos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Relembrar: Execu√ß√£o de Scripts e Caminhos </h2> <p>Nesta sec√ß√£o vamos relembrar rapidamente como funcionam os scripts PowerShell (<code class="language-plaintext highlighter-rouge">.ps1</code>), a import√¢ncia de usar caminhos corretos e como garantir que os scripts s√£o port√°teis e seguros.</p> <h3 id="11-executar-scripts-ps1"> <a href="#11-executar-scripts-ps1" class="anchor-heading" aria-labelledby="11-executar-scripts-ps1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.1. Executar scripts <code class="language-plaintext highlighter-rouge">.ps1</code> </h3> <p>Um script PowerShell √© um ficheiro de texto com a extens√£o <code class="language-plaintext highlighter-rouge">.ps1</code> que cont√©m uma sequ√™ncia de comandos.</p> <p>Se o script estiver na mesma pasta onde o terminal est√° aberto:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.\script.ps1
</code></pre></div></div> <p>Se estiver noutra pasta:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Utilizadores\Nuno\Documentos\script.ps1
</code></pre></div></div> <blockquote> <p>üîó J√° vimos a execu√ß√£o de scripts e permiss√µes na <a href="../Module2/session1">Sess√£o 1 do M√≥dulo 2</a></p> </blockquote> <h3 id="12-caminhos-absolutos-vs-caminhos-relativos"> <a href="#12-caminhos-absolutos-vs-caminhos-relativos" class="anchor-heading" aria-labelledby="12-caminhos-absolutos-vs-caminhos-relativos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.2. Caminhos absolutos vs caminhos relativos </h3> <p>Evita usar caminhos absolutos nos scripts:</p> <p>‚úñ <code class="language-plaintext highlighter-rouge">$ficheiro = "C:\dados\ficheiro.txt"</code></p> <p>Prefere caminhos relativos:</p> <p>‚úî <code class="language-plaintext highlighter-rouge">$ficheiro = ".\dados\ficheiro.txt"</code></p> <p><u>Mas aten√ß√£o</u>: esse caminho √© <strong>relativo ao terminal</strong>, n√£o ao local onde o script est√° guardado.</p> <h3 id="13-usar-psscriptroot--join-path"> <a href="#13-usar-psscriptroot--join-path" class="anchor-heading" aria-labelledby="13-usar-psscriptroot--join-path"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.3. Usar <code class="language-plaintext highlighter-rouge">$PSScriptRoot</code> + <code class="language-plaintext highlighter-rouge">Join-Path</code> </h3> <p>Para garantir que o caminho √© relativo ao <strong>script</strong>, usa a vari√°vel autom√°tica <code class="language-plaintext highlighter-rouge">$PSScriptRoot</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ficheiro = Join-Path $PSScriptRoot "dados\ficheiro.txt"
</code></pre></div></div> <p>Este m√©todo torna o script mais robusto e port√°til.</p> <p>Exemplo completo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ficheiro = Join-Path $PSScriptRoot "dados\frases.txt"
$linhas = Get-Content $ficheiro
Write-Output "Conte√∫do lido:"
$linhas
</code></pre></div></div> <blockquote> <p>üîó Esta t√©cnica foi aplicada com mais detalhe na <a href="../Module2/session1#16-boas-pr√°ticas-iniciais-com-scripts">Sess√£o 1 do M√≥dulo 2</a></p> </blockquote><hr /> <h2 id="2-seguran√ßa-e-boas-pr√°ticas-ao-trabalhar-com-scripts"> <a href="#2-seguran√ßa-e-boas-pr√°ticas-ao-trabalhar-com-scripts" class="anchor-heading" aria-labelledby="2-seguran√ßa-e-boas-pr√°ticas-ao-trabalhar-com-scripts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Seguran√ßa e Boas Pr√°ticas ao Trabalhar com Scripts </h2> <p>Nesta fase do curso, √© importante adotar h√°bitos seguros ao desenvolver, testar e partilhar scripts PowerShell. Mesmo em ambientes internos, pr√°ticas inseguras podem causar perda de dados ou comprometer sistemas.</p> <h3 id="21-scripts-de-fontes-desconhecidas"> <a href="#21-scripts-de-fontes-desconhecidas" class="anchor-heading" aria-labelledby="21-scripts-de-fontes-desconhecidas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.1. Scripts de fontes desconhecidas </h3> <p>Sempre que receberes um script <code class="language-plaintext highlighter-rouge">.ps1</code> de outra pessoa ou da internet:</p> <ul> <li><strong>N√£o corras diretamente</strong>. Abre o ficheiro num editor e l√™ o conte√∫do.</li> <li>Verifica se existem comandos perigosos como <code class="language-plaintext highlighter-rouge">Remove-Item</code>, <code class="language-plaintext highlighter-rouge">Stop-Service</code>, <code class="language-plaintext highlighter-rouge">Invoke-WebRequest</code>, <code class="language-plaintext highlighter-rouge">Start-Process</code> com privil√©gios.</li> <li>Se estiver ofuscado (c√≥digo dif√≠cil de ler de prop√≥sito), n√£o o uses.</li> </ul> <h3 id="22-boas-pr√°ticas-ao-correr-scripts-externos"> <a href="#22-boas-pr√°ticas-ao-correr-scripts-externos" class="anchor-heading" aria-labelledby="22-boas-pr√°ticas-ao-correr-scripts-externos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.2. Boas pr√°ticas ao correr scripts externos </h3> <ul> <li>Rever manualmente o conte√∫do</li> <li>Executar em ambiente de testes sempre que poss√≠vel</li> <li>Se tiveres d√∫vidas, pergunta ou executa num PowerShell isolado (Windows Sandbox, por exemplo)</li> <li> <p>Se o ficheiro veio da internet, pode ser necess√°rio usar:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Unblock-File -Path ".\nome-do-script.ps1"
</code></pre></div> </div> </li> </ul> <h4 id="nota-como-testar-scripts-em-seguran√ßa"> <a href="#nota-como-testar-scripts-em-seguran√ßa" class="anchor-heading" aria-labelledby="nota-como-testar-scripts-em-seguran√ßa"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Nota: Como testar scripts em seguran√ßa </h4> <p>Executar scripts num ambiente de testes √© uma das melhores formas de evitar danos acidentais, especialmente quando os scripts fazem altera√ß√µes no sistema, nos ficheiros ou nos servi√ßos.</p> <p><strong>Como criar um ambiente de testes simples em casa</strong></p> <ul> <li>Cria uma <strong>m√°quina virtual</strong> com Windows (pode ser com o VirtualBox ou Hyper-V)</li> <li>Instala o PowerShell e edita os teus scripts √† vontade</li> <li>Alternativa mais simples: usa o <strong>Windows Sandbox</strong> se tiveres o Windows 10/11 Pro</li> </ul> <blockquote> <p>O <strong>Windows Sandbox</strong> √© um Windows tempor√°rio e isolado. Tudo o que fizeres l√° √© apagado ao fechar.<br /> Basta ativar nas funcionalidades do Windows e abrir pelo menu iniciar.</p> </blockquote> <p><strong>Ambientes de testes em contexto empresarial</strong></p> <ul> <li>Muitas empresas usam <strong>ambientes de testes (test/dev)</strong> separados dos sistemas reais (prod)</li> <li>Se estiveres num ambiente empresarial: <ul> <li>Pergunta se existe uma m√°quina virtual ou ambiente ‚Äúsandbox‚Äù para testes</li> <li>Nunca corras scripts diretamente em servidores de produ√ß√£o sem valida√ß√£o</li> </ul> </li> </ul> <h3 id="23-l√≥gica-de-confirma√ß√£o-antes-de-a√ß√µes-sens√≠veis"> <a href="#23-l√≥gica-de-confirma√ß√£o-antes-de-a√ß√µes-sens√≠veis" class="anchor-heading" aria-labelledby="23-l√≥gica-de-confirma√ß√£o-antes-de-a√ß√µes-sens√≠veis"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.3. L√≥gica de confirma√ß√£o antes de a√ß√µes sens√≠veis </h3> <p>Se o teu script pode modificar ou eliminar algo, adiciona confirma√ß√µes expl√≠citas para evitar erros acidentais.</p> <p>Exemplo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$confirmar = Read-Host "Este script vai apagar ficheiros. Continuar? (S/N)"
if ($confirmar -ne "N") {
    Write-Output "Opera√ß√£o cancelada."
    exit
}
</code></pre></div></div> <p>Outros exemplos:</p> <ul> <li>Confirmar antes de correr <code class="language-plaintext highlighter-rouge">Remove-Item</code>, <code class="language-plaintext highlighter-rouge">Stop-Process</code>, <code class="language-plaintext highlighter-rouge">Restart-Service</code></li> <li>Verificar se ficheiros existem antes de os apagar</li> </ul> <h3 id="24-registo-e-controlo-logging-b√°sico"> <a href="#24-registo-e-controlo-logging-b√°sico" class="anchor-heading" aria-labelledby="24-registo-e-controlo-logging-b√°sico"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.4. Registo e controlo (logging b√°sico) </h3> <p>Para facilitar auditoria ou debugging, regista o que o script fez:</p> <ol> <li> <p><strong>Escrever no terminal:</strong> √∫til para feedback visual imediato</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Write-Output "Apagar ficheiro $ficheiro..."
</code></pre></div> </div> </li> <li> <p><strong>Gravar em ficheiro de log:</strong> ideal para manter registo do que foi feito</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Add-Content -Path ".\log.txt" -Value "[$(Get-Date -Format "yyyy-MM-dd HH:mm")] Ficheiro removido: $ficheiro"
</code></pre></div> </div> </li> <li> <p><strong>Escrever mensagens detalhadas (avan√ßado):</strong> √∫til para scripts com modo ‚Äúverbose‚Äù</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Write-Verbose "O ficheiro $ficheiro foi apagado com sucesso."
</code></pre></div> </div> </li> </ol> <blockquote> <p>Para que as mensagens <code class="language-plaintext highlighter-rouge">Write-Verbose</code> apare√ßam, o script deve ser executado com o par√¢metro <code class="language-plaintext highlighter-rouge">-Verbose</code> e conter <code class="language-plaintext highlighter-rouge">[CmdletBinding()]</code> no topo, se for uma fun√ß√£o ou script avan√ßado.</p> </blockquote> <h3 id="25-exemplo-uso-simples-de-write-verbose"> <a href="#25-exemplo-uso-simples-de-write-verbose" class="anchor-heading" aria-labelledby="25-exemplo-uso-simples-de-write-verbose"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.5. Exemplo: Uso simples de <code class="language-plaintext highlighter-rouge">Write-Verbose</code> </h3> <p>O <code class="language-plaintext highlighter-rouge">Write-Verbose</code> permite mostrar mensagens detalhadas apenas quando o script √© executado com o par√¢metro <code class="language-plaintext highlighter-rouge">-Verbose</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[CmdletBinding()]
param()

Write-Output "In√≠cio do script"

Write-Verbose "Esta √© uma mensagem de debug detalhada"

Write-Output "Fim do script"
</code></pre></div></div> <p>Ao correr o script normalmente: <code class="language-plaintext highlighter-rouge">.\meu-script.ps1</code> ‚Üí s√≥ aparecem as mensagens Write-Output</p> <p>Ao correr com -Verbose: <code class="language-plaintext highlighter-rouge">.\meu-script.ps1 -Verbose</code> ‚Üí tamb√©m aparece a linha Write-Verbose</p> <h3 id="26-dica-adicional"> <a href="#26-dica-adicional" class="anchor-heading" aria-labelledby="26-dica-adicional"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.6. Dica adicional </h3> <ul> <li>Mesmo scripts pequenos devem seguir estas boas pr√°ticas. Com o tempo, √© f√°cil esquecer o que um script faz ‚Äî um bom log e mensagens claras fazem a diferen√ßa.</li> <li>Este tipo de prote√ß√£o n√£o √© s√≥ para servidores ‚Äî √© tamb√©m para ti, enquanto desenvolvedor.</li> </ul> <h3 id="27-tipos-de-mensagens-no-terminal-canais-de-escrita"> <a href="#27-tipos-de-mensagens-no-terminal-canais-de-escrita" class="anchor-heading" aria-labelledby="27-tipos-de-mensagens-no-terminal-canais-de-escrita"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.7. Tipos de mensagens no terminal (canais de escrita) </h3> <p>Em PowerShell, existem v√°rios comandos para enviar mensagens para o terminal ‚Äî cada um com um objetivo espec√≠fico.</p> <p>Alguns s√£o vis√≠veis por defeito, outros s√≥ aparecem quando s√£o ativados com par√¢metros como <code class="language-plaintext highlighter-rouge">-Verbose</code> ou <code class="language-plaintext highlighter-rouge">-Debug</code>.</p> <h4 id="-comandos-de-escrita-mais-comuns"> <a href="#-comandos-de-escrita-mais-comuns" class="anchor-heading" aria-labelledby="-comandos-de-escrita-mais-comuns"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Comandos de escrita mais comuns </h4> <div class="table-wrapper"><table> <thead> <tr> <th>Comando</th> <th>Canal</th> <th>Vis√≠vel por defeito?</th> <th>Utiliza√ß√£o t√≠pica</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">Write-Output</code></td> <td>Output (stream 1)</td> <td>‚úÖ Sim</td> <td>Devolver valores ou mensagens ao pipeline</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Write-Host</code></td> <td>Host (direto)</td> <td>‚úÖ Sim</td> <td>Mostrar mensagens diretamente no terminal</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Write-Verbose</code></td> <td>Verbose (stream 4)</td> <td>‚ùå S√≥ com <code class="language-plaintext highlighter-rouge">-Verbose</code></td> <td>Mensagens de depura√ß√£o mais detalhadas</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Write-Debug</code></td> <td>Debug (stream 5)</td> <td>‚ùå S√≥ com <code class="language-plaintext highlighter-rouge">-Debug</code></td> <td>Mensagens passo a passo para troubleshooting</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Write-Warning</code></td> <td>Warning (stream 3)</td> <td>‚úÖ Sim</td> <td>Mostrar avisos (normalmente a amarelo)</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Write-Error</code></td> <td>Error (stream 2)</td> <td>‚úÖ Sim</td> <td>Mensagens de erro, vis√≠veis e registadas em <code class="language-plaintext highlighter-rouge">$Error</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Write-Information</code></td> <td>Information (stream 6)</td> <td>‚ùå S√≥ com <code class="language-plaintext highlighter-rouge">-InformationAction</code></td> <td>Mensagens informativas para logging ou debug</td> </tr> </tbody> </table></div><hr /> <h4 id="exemplos-r√°pidos"> <a href="#exemplos-r√°pidos" class="anchor-heading" aria-labelledby="exemplos-r√°pidos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exemplos r√°pidos </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Write-Output "Isto √© output normal"
Write-Host "Mensagem direta ao terminal"
Write-Verbose "Detalhes internos"         # S√≥ com -Verbose
Write-Warning "Aten√ß√£o: algo n√£o est√° certo"
Write-Error "Erro grave"
Write-Debug "Valor da vari√°vel x = 5"     # S√≥ com -Debug
Write-Information "Info extra"            # Requer -InformationAction Continue
</code></pre></div></div><hr /> <blockquote> <p>üí° Usa <code class="language-plaintext highlighter-rouge">Write-Output</code> para devolver valores, e <code class="language-plaintext highlighter-rouge">Write-Host</code> apenas para mensagens visuais.<br /> Para mensagens t√©cnicas ou auxiliares, usa <code class="language-plaintext highlighter-rouge">Write-Verbose</code>, <code class="language-plaintext highlighter-rouge">Write-Warning</code> ou <code class="language-plaintext highlighter-rouge">Write-Information</code> conforme o objetivo.</p> </blockquote> <p><strong>O que s√£o os <em>streams</em> (fluxos de sa√≠da)?</strong></p> <p>PowerShell usa diferentes ‚Äúcanais‚Äù para enviar informa√ß√£o para fora dos comandos. Cada canal √© chamado de <strong>stream</strong> e tem um n√∫mero associado:</p> <ul> <li><strong>1 ‚Äì Output</strong>: valores normais devolvidos por comandos (<code class="language-plaintext highlighter-rouge">Write-Output</code>)</li> <li><strong>2 ‚Äì Error</strong>: mensagens de erro (<code class="language-plaintext highlighter-rouge">Write-Error</code>)</li> <li><strong>3 ‚Äì Warning</strong>: avisos (<code class="language-plaintext highlighter-rouge">Write-Warning</code>)</li> <li><strong>4 ‚Äì Verbose</strong>: mensagens detalhadas de debug (<code class="language-plaintext highlighter-rouge">Write-Verbose</code>)</li> <li><strong>5 ‚Äì Debug</strong>: mensagens passo a passo (<code class="language-plaintext highlighter-rouge">Write-Debug</code>)</li> <li><strong>6 ‚Äì Information</strong>: mensagens informativas control√°veis (<code class="language-plaintext highlighter-rouge">Write-Information</code>)</li> </ul> <p>Cada stream pode ser mostrado, redirecionado ou ignorado de forma independente.<br /> Isto permite separar resultados normais, erros, e mensagens auxiliares num script mais profissional.</p> <p><strong>Redirecionamento de Streams:</strong> √â poss√≠vel redirecionar os streams para ficheiros ou outros destinos. Por exemplo, para redirecionar erros para um ficheiro:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process -Name "ProcessoInexistente" 2&gt; erros.txt Para redirecionar todos os streams para um √∫nico ficheiro:

.\script.ps1 *&gt; sa√≠da_completa.txt O operador `*&gt;` redireciona todos os streams (1 a 6) para o destino especificado.
</code></pre></div></div> <p>Compreender e utilizar corretamente os streams permite um controlo mais preciso sobre a sa√≠da dos scripts e facilita a identifica√ß√£o e resolu√ß√£o de problemas.</p><hr /> <h2 id="3-criar-logs-em-powershell"> <a href="#3-criar-logs-em-powershell" class="anchor-heading" aria-labelledby="3-criar-logs-em-powershell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. Criar Logs em PowerShell </h2> <p>Criar logs √© uma pr√°tica fundamental para saber o que os scripts fizeram, quando correram e quem os executou. Isto √© essencial para an√°lise, auditoria e resolu√ß√£o de problemas.</p> <h3 id="31-o-que-colocar-nos-logs"> <a href="#31-o-que-colocar-nos-logs" class="anchor-heading" aria-labelledby="31-o-que-colocar-nos-logs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1. O que colocar nos logs? </h3> <p>Um bom log deve incluir:</p> <ul> <li>Data e hora de cada evento</li> <li>A√ß√£o realizada e respetivo resultado</li> <li>Mensagens de erro claras</li> <li>Informa√ß√£o contextual: quem executou, onde e quando</li> <li>Separa√ß√£o por tipo: [INFO], [ERRO], [WARN], etc.</li> </ul> <h3 id="32-formatos-de-data-√∫teis"> <a href="#32-formatos-de-data-√∫teis" class="anchor-heading" aria-labelledby="32-formatos-de-data-√∫teis"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.2. Formatos de data √∫teis </h3> <p>Get-Date -Format ‚Äúyyyy-MM-dd HH:mm‚Äù # leg√≠vel Get-Date -Format ‚ÄúyyyyMMdd_HHmmss‚Äù # √∫til para nomes de ficheiro (Get-Date).ToString(‚Äúo‚Äù) # formato ISO 8601</p> <h3 id="33-iniciar-um-log-com-informa√ß√µes-b√°sicas"> <a href="#33-iniciar-um-log-com-informa√ß√µes-b√°sicas" class="anchor-heading" aria-labelledby="33-iniciar-um-log-com-informa√ß√µes-b√°sicas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.3. Iniciar um log com informa√ß√µes b√°sicas </h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$logPath = ".\log.txt"
$data = Get-Date -Format "yyyy-MM-dd HH:mm"
$utilizador = $env:USERNAME
$maquina = $env:COMPUTERNAME
$pasta = Get-Location

Add-Content -Path $logPath -Value ""
Add-Content -Path $logPath -Value "$data [INFO] === In√≠cio do Script ==="
Add-Content -Path $logPath -Value "$data [INFO] Utilizador: $utilizador"
Add-Content -Path $logPath -Value "$data [INFO] M√°quina: $maquina"
Add-Content -Path $logPath -Value "$data [INFO] Diret√≥rio atual: $pasta"
Add-Content -Path $logPath -Value "$data [INFO] =========================="
</code></pre></div></div> <h3 id="34-exemplo-de-entradas-de-log-com-tags"> <a href="#34-exemplo-de-entradas-de-log-com-tags" class="anchor-heading" aria-labelledby="34-exemplo-de-entradas-de-log-com-tags"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.4. Exemplo de entradas de log com tags </h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$acao = "Ficheiro apagado: exemplo.txt"
$data = Get-Date -Format "yyyy-MM-dd HH:mm"
Add-Content -Path $logPath -Value "$data [INFO] $acao"
</code></pre></div></div> <p><strong>Em caso de erro</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$erro = "Falha ao apagar ficheiro: acesso negado"
Add-Content -Path $logPath -Value "$data [ERRO] $erro"
</code></pre></div></div> <p><strong>Aviso</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Add-Content -Path $logPath -Value "$data [WARN] Nenhum ficheiro foi encontrado para apagar"
</code></pre></div></div> <h3 id="35-criar-ficheiro-de-log-√∫nico-por-execu√ß√£o"> <a href="#35-criar-ficheiro-de-log-√∫nico-por-execu√ß√£o" class="anchor-heading" aria-labelledby="35-criar-ficheiro-de-log-√∫nico-por-execu√ß√£o"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.5. Criar ficheiro de log √∫nico por execu√ß√£o </h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
$logPath = ".\log_$timestamp.txt"
</code></pre></div></div> <h3 id="36-fechar-o-log-com-mensagem-de-fim"> <a href="#36-fechar-o-log-com-mensagem-de-fim" class="anchor-heading" aria-labelledby="36-fechar-o-log-com-mensagem-de-fim"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.6. Fechar o log com mensagem de fim </h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$data = Get-Date -Format "yyyy-MM-dd HH:mm"
Add-Content -Path $logPath -Value "$data [INFO] Script terminado com sucesso"
</code></pre></div></div> <h3 id="37-exemplo-completo-script-que-apaga-um-ficheiro-com-logging-e-confirma√ß√£o"> <a href="#37-exemplo-completo-script-que-apaga-um-ficheiro-com-logging-e-confirma√ß√£o" class="anchor-heading" aria-labelledby="37-exemplo-completo-script-que-apaga-um-ficheiro-com-logging-e-confirma√ß√£o"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.7. Exemplo completo: script que apaga um ficheiro com logging e confirma√ß√£o </h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Criar nome √∫nico para o ficheiro de log
$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
$logPath = ".\log_$timestamp.txt"

# Cabe√ßalho com informa√ß√µes b√°sicas
$data = Get-Date -Format "yyyy-MM-dd HH:mm"
$utilizador = $env:USERNAME
$maquina = $env:COMPUTERNAME
$pasta = Get-Location

Add-Content -Path $logPath -Value "$data [INFO] === In√≠cio do Script ==="
Add-Content -Path $logPath -Value "$data [INFO] Utilizador: $utilizador"
Add-Content -Path $logPath -Value "$data [INFO] M√°quina: $maquina"
Add-Content -Path $logPath -Value "$data [INFO] Diret√≥rio atual: $pasta"

# Input do utilizador
$ficheiro = Read-Host "Introduz o caminho do ficheiro a apagar"

# Verifica√ß√£o se o ficheiro existe
if (-not (Test-Path $ficheiro)) {
    Write-Output "Ficheiro n√£o encontrado."
    Add-Content -Path $logPath -Value "$data [ERRO] Ficheiro n√£o encontrado: $ficheiro"
    return
}

# Confirma√ß√£o antes de apagar
$confirmar = Read-Host "Tens a certeza que queres apagar este ficheiro? (S/N)"
if ($confirmar -ne "N") {
    Write-Output "Opera√ß√£o cancelada."
    Add-Content -Path $logPath -Value "$data [INFO] Opera√ß√£o cancelada pelo utilizador"
    return
}

# Apagar o ficheiro e registar no log
try {
    Remove-Item -Path $ficheiro -ErrorAction Stop
    Write-Output "Ficheiro apagado com sucesso."
    $data = Get-Date -Format "yyyy-MM-dd HH:mm"
    Add-Content -Path $logPath -Value "$data [INFO] Ficheiro apagado: $ficheiro"
}
catch {
    Write-Output "Erro ao apagar ficheiro: $_"
    $data = Get-Date -Format "yyyy-MM-dd HH:mm"
    Add-Content -Path $logPath -Value "$data [ERRO] Falha ao apagar ficheiro: $_"
}

# Fim do script
$data = Get-Date -Format "yyyy-MM-dd HH:mm"
Add-Content -Path $logPath -Value "$data [INFO] Script terminado"
</code></pre></div></div> <h3 id="38--exerc√≠cio-copiar-ficheiro-com-logging-personalizado"> <a href="#38--exerc√≠cio-copiar-ficheiro-com-logging-personalizado" class="anchor-heading" aria-labelledby="38--exerc√≠cio-copiar-ficheiro-com-logging-personalizado"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.8. üß© Exerc√≠cio: copiar ficheiro com logging personalizado </h3> <p>Pretende-se criar um script que copie um ficheiro de um local para outro.<br /> A c√≥pia j√° est√° feita ‚Äî o teu foco ser√° <strong>criar entradas de log √∫teis, completas e bem estruturadas</strong>.</p> <h4 id="o-que-deves-implementar"> <a href="#o-que-deves-implementar" class="anchor-heading" aria-labelledby="o-que-deves-implementar"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> O que deves implementar: </h4> <ol> <li>Criar um ficheiro de log com nome baseado na data/hora</li> <li>Escrever um <strong>cabe√ßalho</strong> com: <ul> <li>Data de in√≠cio do script</li> <li>Utilizador</li> <li>Nome da m√°quina</li> <li>Diret√≥rio atual</li> <li>N√∫mero de processos ativos (usa Get-Process)</li> </ul> </li> <li>Registar: <ul> <li>Se o ficheiro de origem existe ou n√£o</li> <li>A√ß√£o de c√≥pia (sucesso ou falha)</li> <li>Hora em que o script terminou</li> </ul> </li> <li>Utiliza <strong>tags</strong> como <code class="language-plaintext highlighter-rouge">[INFO]</code>, <code class="language-plaintext highlighter-rouge">[ERRO]</code>, <code class="language-plaintext highlighter-rouge">[WARN]</code> nas linhas do log</li> <li>Usa <code class="language-plaintext highlighter-rouge">Get-Date -Format "yyyy-MM-dd HH:mm"</code> para adicionar a data em cada linha</li> </ol><hr /> <h4 id="c√≥digo-base-do-exerc√≠cio"> <a href="#c√≥digo-base-do-exerc√≠cio" class="anchor-heading" aria-labelledby="c√≥digo-base-do-exerc√≠cio"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> C√≥digo base do exerc√≠cio </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Caminho para o ficheiro de log (deves gerar um nome com timestamp)
$logPath = ""

# INPUTS do utilizador
$origem = Read-Host "Introduz o caminho do ficheiro de origem"
$destino = Read-Host "Introduz o caminho de destino (ficheiro ou pasta)"

# VERIFICAR se o ficheiro de origem existe
if (-not (Test-Path $origem)) {
    Write-Output "Ficheiro n√£o encontrado: $origem"
    
    # TODO: Adicionar entrada ao log com [ERRO] e a mensagem do erro
    return
}

# COPIAR o ficheiro
try {
    Copy-Item -Path $origem -Destination $destino -Force
    Write-Output "Ficheiro copiado com sucesso."

    # TODO: Adicionar entrada ao log com [INFO] sobre o sucesso da c√≥pia
}
catch {
    Write-Output "Erro ao copiar ficheiro: $_"

    # TODO: Adicionar entrada ao log com [ERRO] e o conte√∫do da vari√°vel $_
}

# TODO: Escrever uma linha final no log com [INFO] indicando que o script terminou
</code></pre></div></div> <!-- <details markdown="1"> <summary>üìå Exemplo de solu√ß√£o</summary> # Criar nome de ficheiro de log com timestamp $timestamp = Get-Date -Format "yyyyMMdd_HHmmss" $logPath = ".\log_$timestamp.txt" # Cabe√ßalho do log $data = Get-Date -Format "yyyy-MM-dd HH:mm" $utilizador = $env:USERNAME $maquina = $env:COMPUTERNAME $pasta = Get-Location $proc = (Get-Process).Count Add-Content -Path $logPath -Value "$data [INFO] === In√≠cio do Script ===" Add-Content -Path $logPath -Value "$data [INFO] Utilizador: $utilizador" Add-Content -Path $logPath -Value "$data [INFO] M√°quina: $maquina" Add-Content -Path $logPath -Value "$data [INFO] Diret√≥rio atual: $pasta" Add-Content -Path $logPath -Value "$data [INFO] Processos ativos: $proc" # INPUTS $origem = Read-Host "Introduz o caminho do ficheiro de origem" $destino = Read-Host "Introduz o caminho de destino (ficheiro ou pasta)" # Verifica√ß√£o if (-not (Test-Path $origem)) { Write-Output "Ficheiro n√£o encontrado: $origem" $data = Get-Date -Format "yyyy-MM-dd HH:mm" Add-Content -Path $logPath -Value "$data [ERRO] Ficheiro n√£o encontrado: $origem" return } # C√≥pia try { Copy-Item -Path $origem -Destination $destino -Force Write-Output "Ficheiro copiado com sucesso." $data = Get-Date -Format "yyyy-MM-dd HH:mm" Add-Content -Path $logPath -Value "$data [INFO] Ficheiro copiado de $origem para $destino" } catch { Write-Output "Erro ao copiar ficheiro: $_" $data = Get-Date -Format "yyyy-MM-dd HH:mm" Add-Content -Path $logPath -Value "$data [ERRO] Falha ao copiar: $_" } # Final do log $data = Get-Date -Format "yyyy-MM-dd HH:mm" Add-Content -Path $logPath -Value "$data [INFO] Script terminado" </details> --><hr /> <h2 id="4-fun√ß√µes-em-powershell"> <a href="#4-fun√ß√µes-em-powershell" class="anchor-heading" aria-labelledby="4-fun√ß√µes-em-powershell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4. Fun√ß√µes em PowerShell </h2> <p>Fun√ß√µes s√£o blocos de c√≥digo reutiliz√°veis que permitem organizar scripts, evitar repeti√ß√µes e tornar o c√≥digo mais limpo e f√°cil de manter.</p> <h3 id="41-o-que-√©-uma-fun√ß√£o"> <a href="#41-o-que-√©-uma-fun√ß√£o" class="anchor-heading" aria-labelledby="41-o-que-√©-uma-fun√ß√£o"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.1. O que √© uma fun√ß√£o? </h3> <p>Uma fun√ß√£o √© um grupo de comandos que executam uma tarefa espec√≠fica. Em PowerShell, definimos fun√ß√µes com a palavra-chave <code class="language-plaintext highlighter-rouge">function</code>.</p> <p>Sintaxe b√°sica:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function NomeDaFuncao {
    # Comandos
}
</code></pre></div></div> <p>Exemplo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function Saudacao {
    Write-Output "Ol√°, bem-vindo ao script!"
}
</code></pre></div></div> <p>Para executar:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Saudacao
</code></pre></div></div> <p><strong>Nota sobre o scope das fun√ß√µes:</strong></p> <ul> <li>Se criares uma fun√ß√£o <strong>no terminal</strong>, ela s√≥ estar√° dispon√≠vel enquanto essa sess√£o estiver aberta.</li> <li>Se definires uma fun√ß√£o <strong>dentro de um script</strong>, ela s√≥ pode ser usada dentro desse mesmo script, durante a sua execu√ß√£o.</li> <li>Para tornares uma fun√ß√£o dispon√≠vel em qualquer terminal, coloca-a no ficheiro <code class="language-plaintext highlighter-rouge">$PROFILE</code>.</li> </ul> <h3 id="42-fun√ß√µes-com-par√¢metros"> <a href="#42-fun√ß√µes-com-par√¢metros" class="anchor-heading" aria-labelledby="42-fun√ß√µes-com-par√¢metros"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.2. Fun√ß√µes com par√¢metros </h3> <p>Podes passar valores para uma fun√ß√£o usando <code class="language-plaintext highlighter-rouge">param()</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function SaudacaoPersonalizada {
    param($nome)

    Write-Output "Ol√°, $nome! Bem-vindo."
}
</code></pre></div></div> <p>Para correr:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SaudacaoPersonalizada -nome "Rita"
</code></pre></div></div> <p>Podes tamb√©m definir mais do que um par√¢metro:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function Soma {
    param($a, $b)
    
    $resultado = $a + $b
    Write-Output "Resultado: $resultado"
}
</code></pre></div></div> <p>Para correr:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Soma -a 5 -b 3
</code></pre></div></div> <h3 id="43-tipagem-de-par√¢metros-opcional"> <a href="#43-tipagem-de-par√¢metros-opcional" class="anchor-heading" aria-labelledby="43-tipagem-de-par√¢metros-opcional"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.3. Tipagem de par√¢metros (opcional) </h3> <p>Podes indicar que esperas um tipo espec√≠fico de valor (ex: string, int, etc.)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function Dobro {
    param([int]$numero)

    return $numero * 2
}
</code></pre></div></div> <p>Para correr:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Dobro -numero 4
</code></pre></div></div> <h3 id="44-fun√ß√µes-para-modularizar-scripts"> <a href="#44-fun√ß√µes-para-modularizar-scripts" class="anchor-heading" aria-labelledby="44-fun√ß√µes-para-modularizar-scripts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.4. Fun√ß√µes para modularizar scripts </h3> <p>Se tens scripts com v√°rias partes repetidas (como logging, valida√ß√£o de inputs, confirma√ß√£o), podes coloc√°-las em fun√ß√µes.</p> <p>Exemplo: fun√ß√£o para confirmar uma a√ß√£o</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function Confirmar-Acao {
    param($mensagem)

    $resposta = Read-Host "$mensagem (S/N)"
    if ($resposta -ne "N") {
        Write-Output "Opera√ß√£o cancelada."
        return $false
    }
    return $true
}
</code></pre></div></div> <p>Para utilizar:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if (-not (Confirmar-Acao "Queres apagar este ficheiro?")) {
    return
}
</code></pre></div></div> <h3 id="45-usar-return-para-devolver-valores"> <a href="#45-usar-return-para-devolver-valores" class="anchor-heading" aria-labelledby="45-usar-return-para-devolver-valores"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.5. Usar <code class="language-plaintext highlighter-rouge">return</code> para devolver valores </h3> <p>Podes usar <code class="language-plaintext highlighter-rouge">return</code> numa fun√ß√£o para devolver um valor, tal como noutras linguagens.</p> <h4 id="exemplo-simples"> <a href="#exemplo-simples" class="anchor-heading" aria-labelledby="exemplo-simples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exemplo simples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function Triplo {
    param([int]$numero)
    return $numero * 3
}

$resultado = Triplo -numero 4
Write-Output "Triplo: $resultado"
</code></pre></div></div> <h4 id="diferen√ßa-entre-write-output-e-return"> <a href="#diferen√ßa-entre-write-output-e-return" class="anchor-heading" aria-labelledby="diferen√ßa-entre-write-output-e-return"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Diferen√ßa entre <code class="language-plaintext highlighter-rouge">Write-Output</code> e <code class="language-plaintext highlighter-rouge">return</code> </h4> <ul> <li><code class="language-plaintext highlighter-rouge">Write-Output</code> envia o valor para o <strong>stream de sa√≠da (output)</strong> do PowerShell, normalmente vis√≠vel no terminal.</li> <li><code class="language-plaintext highlighter-rouge">return</code> termina a fun√ß√£o imediatamente e devolve o valor para ser usado <strong>noutro contexto</strong>, como numa vari√°vel, num <code class="language-plaintext highlighter-rouge">if</code>, ou noutra fun√ß√£o.</li> </ul> <p>Em muitos casos, <strong>ambos os comandos parecem funcionar da mesma forma</strong>, mas o <code class="language-plaintext highlighter-rouge">return</code> √© preferido quando queremos usar o valor <strong>de forma controlada</strong>, sem poluir a sa√≠da do script.</p> <p><strong>Exemplo 1</strong> ‚Äì usar <code class="language-plaintext highlighter-rouge">return</code> para c√°lculo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function Soma {
    param($x, $y)
    return $x + $y
}

$total = Soma -x 5 -y 7
if ($total -gt 10) {
    Write-Output "Resultado maior que 10"
}
</code></pre></div></div> <p><strong>Exemplo 2</strong> ‚Äì usar <code class="language-plaintext highlighter-rouge">Write-Output</code> envia para o pipeline (terminal):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function Soma {
    param($x, $y)
    Write-Output ($x + $y)
}

# Este tamb√©m funciona:
$total = Soma -x 5 -y 7
</code></pre></div></div> <p><strong>Recomenda√ß√£o:</strong> Usa <code class="language-plaintext highlighter-rouge">return</code> quando quiseres <strong>devolver valores para serem usados noutros blocos de c√≥digo</strong>.<br /> Usa <code class="language-plaintext highlighter-rouge">Write-Output</code> quando quiseres <strong>mostrar informa√ß√£o no terminal</strong> (mensagens, instru√ß√µes, etc.).</p> <h4 id="podes-devolver-texto-n√∫meros-arrays-objetos"> <a href="#podes-devolver-texto-n√∫meros-arrays-objetos" class="anchor-heading" aria-labelledby="podes-devolver-texto-n√∫meros-arrays-objetos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Podes devolver texto, n√∫meros, arrays, objetos‚Ä¶ </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function Lista-Extensoes {
    return @("txt", "csv", "log")
}

$extensoes = Lista-Extensoes
$extensoes | ForEach-Object { Write-Output "Tipo: $_" }
</code></pre></div></div> <blockquote> <p>Se n√£o usares <code class="language-plaintext highlighter-rouge">return</code>, o PowerShell devolve implicitamente o √∫ltimo valor calculado.</p> </blockquote> <h3 id="46-boas-pr√°ticas-ao-criar-fun√ß√µes"> <a href="#46-boas-pr√°ticas-ao-criar-fun√ß√µes" class="anchor-heading" aria-labelledby="46-boas-pr√°ticas-ao-criar-fun√ß√µes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.6. Boas pr√°ticas ao criar fun√ß√µes </h3> <ul> <li>O nome da fun√ß√£o deve indicar claramente o que faz</li> <li>Usa verbos no infinitivo (ex: <code class="language-plaintext highlighter-rouge">Mostrar-Mensagem</code>, <code class="language-plaintext highlighter-rouge">Copiar-Ficheiro</code>, <code class="language-plaintext highlighter-rouge">Validar-Input</code>)</li> <li>Usa <code class="language-plaintext highlighter-rouge">return</code> quando quiseres devolver valores</li> <li>Escreve fun√ß√µes pequenas e com um prop√≥sito claro</li> <li>Testa individualmente cada fun√ß√£o antes de a integrar num script</li> </ul> <blockquote> <p>Se quiseres que a tua fun√ß√£o tenha ajuda acess√≠vel com <code class="language-plaintext highlighter-rouge">Get-Help</code>, podes adicionar um bloco de coment√°rio estruturado antes da fun√ß√£o. Vamos ver um exemplo completo mais √† frente, na sec√ß√£o sobre personaliza√ß√£o com <code class="language-plaintext highlighter-rouge">$PROFILE</code>.</p> </blockquote><hr /> <h3 id="47-verbos-aprovados-pelo-powershell"> <a href="#47-verbos-aprovados-pelo-powershell" class="anchor-heading" aria-labelledby="47-verbos-aprovados-pelo-powershell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.7. Verbos aprovados pelo PowerShell </h3> <p>Para manter os teus scripts consistentes com os m√≥dulos oficiais, deves usar <strong>verbos padronizados</strong> nos nomes das fun√ß√µes, como <code class="language-plaintext highlighter-rouge">Get</code>, <code class="language-plaintext highlighter-rouge">Set</code>, <code class="language-plaintext highlighter-rouge">New</code>, <code class="language-plaintext highlighter-rouge">Remove</code>, etc.</p> <p>Estes verbos fazem parte da lista de <strong>verbos aprovados pelo PowerShell</strong>, recomendados pela Microsoft.</p> <h4 id="exemplos-de-bons-nomes-de-fun√ß√µes"> <a href="#exemplos-de-bons-nomes-de-fun√ß√µes" class="anchor-heading" aria-labelledby="exemplos-de-bons-nomes-de-fun√ß√µes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exemplos de bons nomes de fun√ß√µes: </h4> <ul> <li><code class="language-plaintext highlighter-rouge">Get-Relatorio</code></li> <li><code class="language-plaintext highlighter-rouge">New-Backup</code></li> <li><code class="language-plaintext highlighter-rouge">Remove-FicheirosAntigos</code></li> <li><code class="language-plaintext highlighter-rouge">Set-Configuracao</code></li> <li><code class="language-plaintext highlighter-rouge">Test-Login</code></li> </ul> <h4 id="como-ver-a-lista-de-verbos-aprovados"> <a href="#como-ver-a-lista-de-verbos-aprovados" class="anchor-heading" aria-labelledby="como-ver-a-lista-de-verbos-aprovados"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Como ver a lista de verbos aprovados: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Verb
</code></pre></div></div> <p>Este comando mostra todos os verbos oficialmente aceites.</p> <blockquote> <p>‚ö†Ô∏è Evita usar verbos inventados como <code class="language-plaintext highlighter-rouge">Executar-</code>, <code class="language-plaintext highlighter-rouge">Atualiza-</code>, <code class="language-plaintext highlighter-rouge">Ler-Valor</code>, etc.<br /> Usa verbos padronizados para facilitar leitura, intellisense e integra√ß√£o futura em m√≥dulos.</p> </blockquote><hr /> <h3 id="48--exerc√≠cios-com-fun√ß√µes"> <a href="#48--exerc√≠cios-com-fun√ß√µes" class="anchor-heading" aria-labelledby="48--exerc√≠cios-com-fun√ß√µes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.8. üß© Exerc√≠cios com fun√ß√µes </h3> <p><strong>Exerc√≠cio 1 ‚Äì Converter temperatura</strong></p> <p>Cria uma fun√ß√£o chamada <code class="language-plaintext highlighter-rouge">Converter-CelsiusParaFahrenheit</code> que:</p> <ul> <li>Recebe uma temperatura em Celsius como par√¢metro</li> <li>Converte para Fahrenheit usando a f√≥rmula: F = C √ó 1.8 + 32</li> <li>Devolve o valor convertido</li> </ul> <p>Depois de criar a fun√ß√£o, chama-a com um valor (por exemplo, 25) e mostra o resultado no terminal.</p> <!-- <details markdown="1"> <summary>Solu√ß√£o ‚Äì Exerc√≠cio 1</summary> function Converter-CelsiusParaFahrenheit { param([double]$celsius) return $celsius * 1.8 + 32 } $resultado = Converter-CelsiusParaFahrenheit -celsius 25 Write-Output "Temperatura em Fahrenheit: $resultado" </details> --> <p><strong>Exerc√≠cio 2 ‚Äì Verificar se n√∫mero √© par</strong></p> <p>Cria uma fun√ß√£o chamada <code class="language-plaintext highlighter-rouge">EhPar</code> que:</p> <ul> <li>Recebe um n√∫mero como par√¢metro</li> <li>Devolve <code class="language-plaintext highlighter-rouge">True</code> se for par, <code class="language-plaintext highlighter-rouge">False</code> caso contr√°rio</li> </ul> <!-- <details markdown="1"> <summary>Solu√ß√£o ‚Äì Exerc√≠cio 2</summary> function EhPar { param([int]$numero) return ($numero % 2 -eq 0) } if (EhPar -numero 4) { Write-Output "√â par" } else { Write-Output "√â √≠mpar" } </details> --> <p><strong>Exerc√≠cio 3 ‚Äì Calcular total de ficheiros</strong></p> <p>Cria uma fun√ß√£o <code class="language-plaintext highlighter-rouge">Contar-Ficheiros</code> que:</p> <ul> <li>Recebe uma pasta como par√¢metro</li> <li>Conta e devolve o n√∫mero de ficheiros existentes nessa pasta</li> </ul> <!-- <details markdown="1"> <summary>Ssolu√ß√£o ‚Äì Exerc√≠cio 3</summary> function Contar-Ficheiros { param([string]$pasta) if (-not (Test-Path $pasta)) { Write-Output "Pasta n√£o encontrada: $pasta" return 0 } $ficheiros = Get-ChildItem -Path $pasta -File return $ficheiros.Count } $pasta = Read-Host "Introduz o caminho da pasta" $total = Contar-Ficheiros -pasta $pasta Write-Output "Total de ficheiros: $total" </details> --><hr /> <h2 id="5-recolha-de-inputs-do-utilizador"> <a href="#5-recolha-de-inputs-do-utilizador" class="anchor-heading" aria-labelledby="5-recolha-de-inputs-do-utilizador"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5. Recolha de Inputs do Utilizador </h2> <p>Scripts mais interativos recolhem informa√ß√£o diretamente do utilizador. J√° us√°mos <code class="language-plaintext highlighter-rouge">Read-Host</code> em exemplos anteriores ‚Äî agora vamos refor√ßar e expandir com novas formas de entrada, valida√ß√£o e seguran√ßa.</p> <blockquote> <p>üîó Relembrar: <code class="language-plaintext highlighter-rouge">Read-Host</code> foi introduzido na <a href="../Module2/session5#41-pedir-input-ao-utilizador-read-host">Sess√£o 5 do M√≥dulo 2</a></p> </blockquote> <h3 id="51-recolher-input-com-read-host"> <a href="#51-recolher-input-com-read-host" class="anchor-heading" aria-labelledby="51-recolher-input-com-read-host"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.1. Recolher input com <code class="language-plaintext highlighter-rouge">Read-Host</code> </h3> <p><code class="language-plaintext highlighter-rouge">Read-Host</code> permite obter um valor simples do utilizador como string:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$nome = Read-Host "Qual √© o teu nome?"
Write-Output "Ol√°, $nome!"
</code></pre></div></div> <p>Todos os valores recolhidos com <code class="language-plaintext highlighter-rouge">Read-Host</code> s√£o tratados inicialmente como texto (<code class="language-plaintext highlighter-rouge">[string]</code>).</p> <h3 id="52-converter-e-validar-o-input"> <a href="#52-converter-e-validar-o-input" class="anchor-heading" aria-labelledby="52-converter-e-validar-o-input"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.2. Converter e validar o input </h3> <p>Podes for√ßar a convers√£o para outros tipos (como <code class="language-plaintext highlighter-rouge">[int]</code>) ou validar com condi√ß√µes:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$idade = Read-Host "Qual √© a tua idade?"
if ($idade -match '^\d+$') {
    Write-Output "Tens $idade anos"
} else {
    Write-Output "Idade inv√°lida."
}
</code></pre></div></div> <p>Outra forma:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>try {
    $numero = [int](Read-Host "Introduz um n√∫mero inteiro")
    Write-Output "N√∫mero v√°lido: $numero"
} catch {
    Write-Output "Valor inv√°lido!"
}
</code></pre></div></div> <h3 id="53-confirmar-a√ß√µes-com-input"> <a href="#53-confirmar-a√ß√µes-com-input" class="anchor-heading" aria-labelledby="53-confirmar-a√ß√µes-com-input"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.3. Confirmar a√ß√µes com input </h3> <p>Antes de executar a√ß√µes importantes, como apagar ou modificar ficheiros, pede confirma√ß√£o:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$confirma = Read-Host "Tens a certeza que queres continuar? (S/N)"
if ($confirma -ne "S") {
    Write-Output "Opera√ß√£o cancelada."
    return
}
</code></pre></div></div> <h3 id="54-input-com-janela-gr√°fica"> <a href="#54-input-com-janela-gr√°fica" class="anchor-heading" aria-labelledby="54-input-com-janela-gr√°fica"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.4. Input com janela gr√°fica </h3> <p>PowerShell permite criar caixas de input com janelas (√∫til em scripts mais amig√°veis):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Add-Type -AssemblyName Microsoft.VisualBasic
$valor = [Microsoft.VisualBasic.Interaction]::InputBox("Introduz o teu nome", "Nome")
Write-Output "Ol√°, $valor!"
</code></pre></div></div> <p>N√£o requer instala√ß√£o adicional, funciona no Windows com interface gr√°fica.</p> <p><strong>Explica√ß√£o r√°pida do exemplo com InputBox:</strong> Linha 1: <code class="language-plaintext highlighter-rouge">Add-Type -AssemblyName Microsoft.VisualBasic</code><br /> Carrega uma biblioteca que permite usar janelas gr√°ficas simples no PowerShell.</p> <p>Linha 2: <code class="language-plaintext highlighter-rouge">$valor = [Microsoft.VisualBasic.Interaction]::InputBox("Introduz o teu nome", "Nome")</code><br /> Mostra uma caixa de input com o texto ‚ÄúIntroduz o teu nome‚Äù e o t√≠tulo ‚ÄúNome‚Äù.<br /> O valor introduzido √© guardado na vari√°vel <code class="language-plaintext highlighter-rouge">$valor</code>.</p><hr /> <h3 id="55-sanitiza√ß√£o-e-boas-pr√°ticas"> <a href="#55-sanitiza√ß√£o-e-boas-pr√°ticas" class="anchor-heading" aria-labelledby="55-sanitiza√ß√£o-e-boas-pr√°ticas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.5. Sanitiza√ß√£o e boas pr√°ticas </h3> <ul> <li>Verifica sempre se o input √© v√°lido <strong>antes de usar</strong></li> <li>Evita inputs perigosos em comandos (<code class="language-plaintext highlighter-rouge">Remove-Item $input</code> sem validar pode ser arriscado)</li> <li>Usa regex ou valida√ß√£o com <code class="language-plaintext highlighter-rouge">[int]</code>, <code class="language-plaintext highlighter-rouge">[datetime]</code>, etc.</li> <li>D√° feedback claro ao utilizador</li> </ul> <h3 id="56-exemplo-sem-sanitiza√ß√£o-vs-com-sanitiza√ß√£o-simples-e-seguro"> <a href="#56-exemplo-sem-sanitiza√ß√£o-vs-com-sanitiza√ß√£o-simples-e-seguro" class="anchor-heading" aria-labelledby="56-exemplo-sem-sanitiza√ß√£o-vs-com-sanitiza√ß√£o-simples-e-seguro"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.6. Exemplo: sem sanitiza√ß√£o vs com sanitiza√ß√£o (simples e seguro) </h3> <h4 id="sem-sanitiza√ß√£o"> <a href="#sem-sanitiza√ß√£o" class="anchor-heading" aria-labelledby="sem-sanitiza√ß√£o"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sem sanitiza√ß√£o </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$opcao = Read-Host "Escolhe uma op√ß√£o (1 = Ver lista, 2 = Sair)"

if ($opcao -eq 1) {
    Write-Output "Lista de produtos: ..."
} elseif ($opcao -eq 2) {
    Write-Output "A sair..."
} else {
    Write-Output "Op√ß√£o inv√°lida"
}
</code></pre></div></div> <blockquote> <p>Se o utilizador escrever <code class="language-plaintext highlighter-rouge">1; Remove-Item *</code>, o PowerShell pode interpretar como dois comandos separados (em certos contextos ou se o input for passado sem valida√ß√£o para outra fun√ß√£o).</p> <p>Tamb√©m aceita inputs como <code class="language-plaintext highlighter-rouge">abc</code>, <code class="language-plaintext highlighter-rouge">dois</code>, ou espa√ßos ‚Äî e o script responde com ‚ÄúOp√ß√£o inv√°lida‚Äù, mas o c√≥digo ainda processa a string, o que pode ser arriscado se usado noutra fun√ß√£o.</p> </blockquote><hr /> <h4 id="com-sanitiza√ß√£o"> <a href="#com-sanitiza√ß√£o" class="anchor-heading" aria-labelledby="com-sanitiza√ß√£o"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Com sanitiza√ß√£o </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$opcao = Read-Host "Escolhe uma op√ß√£o (1 = Ver lista, 2 = Sair)"

if ($opcao -match '^[12]$') {
    if ($opcao -eq '1') {
        Write-Output "Lista de produtos: ..."
    } else {
        Write-Output "A sair..."
    }
} else {
    Write-Output "Op√ß√£o inv√°lida. Introduz apenas 1 ou 2."
}
</code></pre></div></div> <blockquote> <p>Aqui s√≥ s√£o aceites os valores <code class="language-plaintext highlighter-rouge">1</code> ou <code class="language-plaintext highlighter-rouge">2</code>. Tudo o resto √© bloqueado √† partida.</p> </blockquote><hr /> <h3 id="57--exerc√≠cios-sobre-input"> <a href="#57--exerc√≠cios-sobre-input" class="anchor-heading" aria-labelledby="57--exerc√≠cios-sobre-input"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5.7. üß© Exerc√≠cios sobre Input </h3> <p><strong>Exerc√≠cio 1 ‚Äì Validar n√∫mero com repeti√ß√£o</strong></p> <ul> <li>Pede um n√∫mero ao utilizador</li> <li>Enquanto o valor n√£o for um n√∫mero inteiro, mostra erro e volta a pedir</li> <li>Quando for um n√∫mero v√°lido, verifica se √© par ou √≠mpar</li> </ul> <!-- <details markdown="1"> <summary>Solu√ß√£o ‚Äì Exerc√≠cio 1: Validar n√∫mero com repeti√ß√£o</summary> $input = Read-Host "Introduz um n√∫mero inteiro" while ($input -notmatch '^\d+$') { Write-Output "Valor inv√°lido. Introduz apenas n√∫meros inteiros." $input = Read-Host "Introduz um n√∫mero inteiro" } $numero = [int]$input if ($numero % 2 -eq 0) { Write-Output "O n√∫mero $numero √© par." } else { Write-Output "O n√∫mero $numero √© √≠mpar." } </details> --> <p><strong>Exerc√≠cio 2 ‚Äì Valida√ß√£o de data</strong></p> <ul> <li>Pede ao utilizador uma data no formato ‚Äúdd/MM/yyyy‚Äù</li> <li>Valida se o input √© uma data v√°lida usando <code class="language-plaintext highlighter-rouge">[datetime]</code></li> <li>Se for v√°lida, mostra a data no formato longo (ex: ‚Äúsegunda-feira, 20 de maio de 2024‚Äù)</li> <li>Caso contr√°rio, mostra mensagem de erro</li> </ul> <!-- <details markdown="1"> <summary>Solu√ß√£o ‚Äì Exerc√≠cio 2: Valida√ß√£o de data</summary> # Pedir data no formato portugu√™s $dataTexto = Read-Host "Introduz uma data (dd/MM/yyyy)" # Tentar converter para datetime try { $data = [datetime]::ParseExact($dataTexto, "dd/MM/yyyy", $null) Write-Output "Data v√°lida: $($data.ToString('D'))" } catch { Write-Output "Data inv√°lida. Usa o formato dd/MM/yyyy." } </details> --> <p><strong>Exerc√≠cio 3 ‚Äì Usar InputBox</strong></p> <ul> <li>Mostra uma InputBox com a pergunta ‚ÄúQual o teu nome?‚Äù</li> <li>Mostra uma sauda√ß√£o personalizada no terminal</li> </ul> <!-- <details markdown="1"> <summary>üìå Exemplo de solu√ß√£o ‚Äì Exerc√≠cio 3: Usar InputBox</summary> # Carregar biblioteca para usar InputBox Add-Type -AssemblyName Microsoft.VisualBasic # Mostrar caixa de input e guardar valor $nome = [Microsoft.VisualBasic.Interaction]::InputBox("Qual o teu nome?", "Pergunta") # Mostrar sauda√ß√£o no terminal Write-Output "Ol√°, $nome! Bem-vindo ao PowerShell." </details> --><hr /> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
