<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/Curso_Powershell/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/Curso_Powershell/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(1)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(5) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(5) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(5) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(5) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(5) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; } </style> <script src="/Curso_Powershell/assets/js/vendor/lunr.min.js"></script> <script src="/Curso_Powershell/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Session 1: PowerShell em Linux com WSL | PowerShell Workshop</title> <meta name="generator" content="Jekyll v4.3.4" /> <meta property="og:title" content="Session 1: PowerShell em Linux com WSL" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A project site with collapsible side navigation." /> <meta property="og:description" content="A project site with collapsible side navigation." /> <link rel="canonical" href="https://tecnodur.github.io/Curso_Powershell/Modules/Module4/session1.html" /> <meta property="og:url" content="https://tecnodur.github.io/Curso_Powershell/Modules/Module4/session1.html" /> <meta property="og:site_name" content="PowerShell Workshop" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Session 1: PowerShell em Linux com WSL" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"A project site with collapsible side navigation.","headline":"Session 1: PowerShell em Linux com WSL","url":"https://tecnodur.github.io/Curso_Powershell/Modules/Module4/session1.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/Curso_Powershell/" class="site-title lh-tight"> PowerShell Workshop </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/" class="nav-list-link">Curso de PowerShell & Shell Scripting</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Módulo 1: Introdução ao PowerShell e Shell Scripting category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module1/" class="nav-list-link">Módulo 1: Introdução ao PowerShell e Shell Scripting</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module1/session1.html" class="nav-list-link">Session 1: Conceitos Básicos e Configuração</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module1/session2.html" class="nav-list-link">Sessão 2: Comandos, Navegação e Ajuda</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module1/session3.html" class="nav-list-link">Session 3: Objetos, parâmetros, pipeline, output, exportações</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Módulo 2: Fundamentos de Scripting e Lógica em PowerShell category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module2/" class="nav-list-link">Módulo 2: Fundamentos de Scripting e Lógica em PowerShell</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session1.html" class="nav-list-link">Session 1: Criar e Executar Scripts</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session2.html" class="nav-list-link">Session 2: Variáveis e Tipos de Dados</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session3.html" class="nav-list-link">Session 3: Tratamento de Erros com try, catch e finally</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session4.html" class="nav-list-link">Session 4: Manipulação de Texto e Dados Simples</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session5.html" class="nav-list-link">Session 5: Estruturas Condicionais</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session6.html" class="nav-list-link">Session 6: Loops e Iterações</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Módulo 3: Gestão de Ficheiros e Processos category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module3/" class="nav-list-link">Módulo 3: Gestão de Ficheiros e Processos</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session1.html" class="nav-list-link">Session 1: Scripts, Segurança, Funções e Personalização</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session2.html" class="nav-list-link">Session 2: Manipulação e Transformação de Coleções</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session3.html" class="nav-list-link">Session 3: Personalização do Ambiente PowerShell</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session4.html" class="nav-list-link">Session 4: Scripts Temáticos com Ficheiros</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session5.html" class="nav-list-link">Session 5: Pesquisa, Filtragem e Exportação</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Módulo 4: Integração Avançada, Automatização e Ecossistemas category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module4/" class="nav-list-link">Módulo 4: Integração Avançada, Automatização e Ecossistemas</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session1.html" class="nav-list-link">Session 1: PowerShell em Linux com WSL</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session2.html" class="nav-list-link">Session 2: PowerShell vs CMD: Diferenças e Utilização no Windows</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session3.html" class="nav-list-link">Session 3: Tarefas Agendadas e Cron Jobs</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session4.html" class="nav-list-link">Session 4: Serviços, Logs e Alertas</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session5.html" class="nav-list-link">Session 5: Notificações e Relatórios Automatizados</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session6.html" class="nav-list-link">Session 6: Métodos Estáticos e Bibliotecas .NET</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session7.html" class="nav-list-link">Session 7: Módulos e Bibliotecas Externas</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session8.html" class="nav-list-link">Sessão 8: Tópicos Avançados e Boas Práticas</a></li></ul></li><li class="nav-list-item"><a href="/Curso_Powershell/refRapida.html" class="nav-list-link">Referência Rápida</a></li><li class="nav-list-item"><a href="/Curso_Powershell/vscode.html" class="nav-list-link">Visual Studio Code com PowerShell</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search PowerShell Workshop" aria-label="Search PowerShell Workshop" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/Curso_Powershell/Modules/Module4/">Módulo 4: Integração Avançada, Automatização e Ecossistemas</a></li> <li class="breadcrumb-nav-list-item"><span>Session 1: PowerShell em Linux com WSL</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h2 style="all: unset; font-size: 5em; font-weight: bold;"> 🧭 Sessão 1: PowerShell em Linux com WSL </h2> <p><br /></p> <p><strong>🎯 Objetivo</strong><br /> Explorar como usar o PowerShell em ambiente Linux utilizando o Windows Subsystem for Linux (WSL). Esta sessão ajuda a compreender as diferenças entre sistemas, como adaptar comandos e onde é preferível usar bash em vez de PowerShell.</p><hr /> <ul> <li><a href="#1-o-que-é-o-wsl">1. O que é o WSL?</a> <ul> <li><a href="#instalar-powershell-no-bash">Instalar Powershell no bash</a></li> </ul> </li> <li><a href="#2-diferenças-entre-powershell-no-windows-e-no-linux">2. Diferenças entre PowerShell no Windows e no Linux</a></li> <li><a href="#3-exemplo-de-comandos-equivalentes">3. Exemplo de comandos equivalentes</a></li> <li><a href="#4-aceder-a-ficheiros-entre-windows-e-wsl">4. Aceder a ficheiros entre Windows e WSL</a> <ul> <li><a href="#41-do-wsl-para-o-windows">4.1. Do WSL para o Windows</a></li> <li><a href="#42-do-windows-para-o-wsl">4.2. Do Windows para o WSL</a></li> </ul> </li> <li><a href="#5-casos-em-que-powershell-no-linux-é-útil">5. Casos em que PowerShell no Linux é útil</a></li> <li><a href="#6-como-criar-e-correr-um-script-bash-sh">6. Como criar e correr um script Bash (.sh)</a> <ul> <li><a href="#61-criar-o-ficheiro">6.1. Criar o ficheiro</a></li> <li><a href="#62-dar-permissões-de-execução">6.2. Dar permissões de execução</a></li> <li><a href="#63-correr-o-script">6.3. Correr o script</a></li> </ul> </li> <li><a href="#7-posso-correr-scripts-ps1-no-wsllinux">7. Posso correr scripts <code class="language-plaintext highlighter-rouge">.ps1</code> no WSL/Linux?</a> <ul> <li><a href="#71-requisitos">7.1. Requisitos</a></li> <li><a href="#72-como-correr-o-script">7.2. Como correr o script</a></li> <li><a href="#73-exemplo">7.3. Exemplo</a></li> </ul> </li> <li><a href="#8-compatibilidade-com-powershell-no-windows">8. Compatibilidade com PowerShell no Windows</a></li> <li><a href="#9-comparação-powershell-vs-bash-linux">9. Comparação PowerShell vs Bash (Linux)</a> <ul> <li><a href="#91--notas">9.1. ✅ Notas</a></li> </ul> </li> <li><a href="#10-comandos-que-não-funcionam-no-linuxwsl">10. Comandos que não funcionam no Linux/WSL</a> <ul> <li><a href="#101-comandos-comuns-que-não-funcionam-no-wsllinux">10.1. Comandos comuns que <strong>não funcionam no WSL/Linux</strong></a></li> <li><a href="#102-como-saber-se-um-cmdlet-funciona">10.2. Como saber se um cmdlet funciona?</a></li> <li><a href="#103-estratégia-segura">10.3. Estratégia segura</a></li> <li><a href="#104-alternativas-em-linux">10.4. Alternativas em Linux</a></li> </ul> </li> <li><a href="#11--exercícios">11. 🧩 Exercícios</a> <ul> <li><a href="#111--exercício--listar-ficheiros-de-um-diretório-no-linux">11.1. 🧩 Exercício – Listar ficheiros de um diretório no Linux</a></li> <li><a href="#112--exercício--correr-um-comando-bash-dentro-de-powershell">11.2. 🧩 Exercício – Correr um comando bash dentro de PowerShell</a></li> </ul> </li> <li><a href="#12-exemplos-para-powershell-e-bash">12. Exemplos para PowerShell e Bash</a> <ul> <li><a href="#121--exercício--criar-um-script-com-tratamento-de-erro">12.1. 🧩 Exercício – Criar um script com tratamento de erro</a></li> <li><a href="#122--exercício--calcular-o-dobro">12.2. 🧩 Exercício – Calcular o dobro</a></li> <li><a href="#123--exercício--verificar-se-uma-cor-existe">12.3. 🧩 Exercício – Verificar se uma cor existe</a></li> <li><a href="#124--exercício--mostrar-data-atual-e-daqui-a-7-dias">12.4. 🧩 Exercício – Mostrar data atual e daqui a 7 dias</a></li> <li><a href="#125--exercício--adicionar-dias-à-data-atual">12.5. 🧩 Exercício – Adicionar dias à data atual</a></li> <li><a href="#126--exercício--validar-nome-pela-primeira-letra">12.6. 🧩 Exercício – Validar nome pela primeira letra</a></li> <li><a href="#127--exercício--maioridade">12.7. 🧩 Exercício – Maioridade</a></li> <li><a href="#128--exercício--verificar-se-o-ano-é-bissexto">12.8. 🧩 Exercício – Verificar se o ano é bissexto</a></li> <li><a href="#129--exercício--classificar-frutas-com-switch">12.9. 🧩 Exercício – Classificar frutas com switch</a></li> <li><a href="#1210--exercício--esperar-até-o-minuto-ser-múltiplo-de-5">12.10. 🧩 Exercício – Esperar até o minuto ser múltiplo de 5</a></li> <li><a href="#1211--exercício--copiar-ficheiro-com-logging-personalizado">12.11. 🧩 Exercício – Copiar ficheiro com logging personalizado</a></li> <li><a href="#1212--exercício--converter-temperatura-com-função">12.12. 🧩 Exercício – Converter temperatura com função</a></li> </ul> </li> <li><a href="#13-resumo-e-boas-práticas">13. Resumo e Boas Práticas</a></li> </ul><hr /> <h2 id="1-o-que-é-o-wsl"> <a href="#1-o-que-é-o-wsl" class="anchor-heading" aria-labelledby="1-o-que-é-o-wsl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. O que é o WSL? </h2> <p>O <strong>WSL (Windows Subsystem for Linux)</strong> permite correr distribuições Linux diretamente no Windows, com acesso ao terminal bash e, mais recentemente, ao PowerShell também dentro do ambiente Linux.</p> <p>Para verificar se tens WSL:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wsl --list --verbose
</code></pre></div></div> <p>Para instalar uma distribuição (ex: Ubuntu):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wsl --install -d Ubuntu
</code></pre></div></div> <p>Para abrir o terminal dessa distro:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wsl -d Ubuntu
</code></pre></div></div> <p>Podes correr PowerShell dentro da distribuição com:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwsh
</code></pre></div></div> <h3 id="instalar-powershell-no-bash"> <a href="#instalar-powershell-no-bash" class="anchor-heading" aria-labelledby="instalar-powershell-no-bash"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Instalar Powershell no bash </h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Atualiza a lista de pacotes disponíveis
sudo apt update

# Atualiza os pacotes instalados para as versões mais recentes
sudo apt upgrade -y

# Instala utilitários necessários: wget para fazer downloads, apt-transport-https para repositórios HTTPS, e software-properties-common para gestão de repositórios
sudo apt install -y wget apt-transport-https software-properties-common

# Faz o download do pacote que adiciona o repositório oficial da Microsoft para Debian 11
wget -q "https://packages.microsoft.com/config/debian/11/packages-microsoft-prod.deb" -O packages-microsoft-prod.deb

# Instala o repositório da Microsoft no sistema
sudo dpkg -i packages-microsoft-prod.deb

# Atualiza novamente a lista de pacotes, agora incluindo os do repositório Microsoft
sudo apt update

# Instala o PowerShell a partir dos repositórios agora disponíveis
sudo apt install powershell
</code></pre></div></div><hr /> <h2 id="2-diferenças-entre-powershell-no-windows-e-no-linux"> <a href="#2-diferenças-entre-powershell-no-windows-e-no-linux" class="anchor-heading" aria-labelledby="2-diferenças-entre-powershell-no-windows-e-no-linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Diferenças entre PowerShell no Windows e no Linux </h2> <div class="table-wrapper"><table> <thead> <tr> <th>Funcionalidade</th> <th>Windows</th> <th>Linux via WSL</th> </tr> </thead> <tbody> <tr> <td>Acesso ao sistema</td> <td>C:\, registos, serviços</td> <td>/home, systemd, cron</td> </tr> <tr> <td>Comandos nativos</td> <td><code class="language-plaintext highlighter-rouge">Get-Process</code>, <code class="language-plaintext highlighter-rouge">Get-Service</code></td> <td>Alguns não funcionam ou retornam erro</td> </tr> <tr> <td>Caminhos</td> <td><code class="language-plaintext highlighter-rouge">C:\Users\nome</code></td> <td><code class="language-plaintext highlighter-rouge">/home/nome</code></td> </tr> <tr> <td>Permissões</td> <td>NTFS / ACLs</td> <td>Permissões Unix (chmod, chown)</td> </tr> </tbody> </table></div><hr /> <h2 id="3-exemplo-de-comandos-equivalentes"> <a href="#3-exemplo-de-comandos-equivalentes" class="anchor-heading" aria-labelledby="3-exemplo-de-comandos-equivalentes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. Exemplo de comandos equivalentes </h2> <p>PowerShell no Windows:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process
Get-Service
</code></pre></div></div> <p>PowerShell no Linux (dentro do WSL):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ps aux        # comando bash para ver processos
systemctl     # gerir serviços no Linux
</code></pre></div></div> <p>Podes usar comandos bash diretamente dentro do PowerShell:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash -c "ls -la /etc"
</code></pre></div></div><hr /> <h2 id="4-aceder-a-ficheiros-entre-windows-e-wsl"> <a href="#4-aceder-a-ficheiros-entre-windows-e-wsl" class="anchor-heading" aria-labelledby="4-aceder-a-ficheiros-entre-windows-e-wsl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4. Aceder a ficheiros entre Windows e WSL </h2> <h3 id="41-do-wsl-para-o-windows"> <a href="#41-do-wsl-para-o-windows" class="anchor-heading" aria-labelledby="41-do-wsl-para-o-windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.1. Do WSL para o Windows </h3> <p>A tua unidade C: aparece montada no WSL como:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/mnt/c/
</code></pre></div></div> <p>Por exemplo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd /mnt/c/Users/teu_utilizador/Desktop
</code></pre></div></div> <p>Podes navegar, copiar, mover ou executar ficheiros de Windows a partir do WSL usando este caminho.</p> <h3 id="42-do-windows-para-o-wsl"> <a href="#42-do-windows-para-o-wsl" class="anchor-heading" aria-labelledby="42-do-windows-para-o-wsl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.2. Do Windows para o WSL </h3> <p>No Windows, podes aceder aos ficheiros do WSL através do caminho de rede:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\\wsl.localhost\Ubuntu\home\teu_utilizador
</code></pre></div></div> <p>Basta colar esse caminho no Explorador de Ficheiros ou numa linha de comandos (<code class="language-plaintext highlighter-rouge">cd "\\wsl.localhost\Ubuntu\..."</code> no PowerShell).</p> <blockquote> <p>Substitui <code class="language-plaintext highlighter-rouge">Ubuntu</code> pelo nome da tua distribuição WSL (<code class="language-plaintext highlighter-rouge">wsl -l</code> mostra todas).</p> </blockquote> <p><strong>Nota</strong>:</p> <blockquote> <p>Podes criar, editar e executar ficheiros do Windows a partir do Linux e vice-versa, mas <strong>não deves editar o mesmo ficheiro ao mesmo tempo nos dois ambientes</strong>, pois isso pode causar corrupção de dados.</p> </blockquote><hr /> <h2 id="5-casos-em-que-powershell-no-linux-é-útil"> <a href="#5-casos-em-que-powershell-no-linux-é-útil" class="anchor-heading" aria-labelledby="5-casos-em-que-powershell-no-linux-é-útil"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5. Casos em que PowerShell no Linux é útil </h2> <ul> <li>Scripts multiplataforma</li> <li>Aceder a comandos do Linux e manipular a saída com objetos</li> <li>Automatizar tarefas no WSL (ex: backups de ficheiros de Linux)</li> <li>Criar wrappers que combinam bash e PowerShell</li> </ul><hr /> <h2 id="6-como-criar-e-correr-um-script-bash-sh"> <a href="#6-como-criar-e-correr-um-script-bash-sh" class="anchor-heading" aria-labelledby="6-como-criar-e-correr-um-script-bash-sh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 6. Como criar e correr um script Bash (.sh) </h2> <h3 id="61-criar-o-ficheiro"> <a href="#61-criar-o-ficheiro" class="anchor-heading" aria-labelledby="61-criar-o-ficheiro"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 6.1. Criar o ficheiro </h3> <ol> <li> <p>Cria um novo ficheiro com extensão <code class="language-plaintext highlighter-rouge">.sh</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> touch exemplo.sh
</code></pre></div> </div> </li> <li> <p>Abre o ficheiro no editor:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> nano exemplo.sh
</code></pre></div> </div> </li> <li> <p>Escreve o seguinte conteúdo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> #!/bin/bash
 echo "Olá, este é um script Bash!"
</code></pre></div> </div> </li> <li> <p>Guarda e sai (<code class="language-plaintext highlighter-rouge">Ctrl+O</code>, depois <code class="language-plaintext highlighter-rouge">Enter</code>, e <code class="language-plaintext highlighter-rouge">Ctrl+X</code>)</p> </li> </ol> <h3 id="62-dar-permissões-de-execução"> <a href="#62-dar-permissões-de-execução" class="anchor-heading" aria-labelledby="62-dar-permissões-de-execução"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 6.2. Dar permissões de execução </h3> <p>Antes de correr o script, precisas de dar permissões de execução:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chmod +x exemplo.sh
</code></pre></div></div> <h3 id="63-correr-o-script"> <a href="#63-correr-o-script" class="anchor-heading" aria-labelledby="63-correr-o-script"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 6.3. Correr o script </h3> <p>Agora podes correr o script com:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./exemplo.sh
</code></pre></div></div> <blockquote> <p>Podes também correr com <code class="language-plaintext highlighter-rouge">bash exemplo.sh</code>, mesmo sem dar permissões, mas o uso de <code class="language-plaintext highlighter-rouge">./</code> é mais comum para scripts teus.</p> </blockquote> <blockquote> <p>⚠️ Nota: o <code class="language-plaintext highlighter-rouge">#!/bin/bash</code> na primeira linha do ficheiro é chamado de “shebang” e diz ao sistema que deve usar o interpretador Bash para executar o script.</p> </blockquote><hr /> <h2 id="7-posso-correr-scripts-ps1-no-wsllinux"> <a href="#7-posso-correr-scripts-ps1-no-wsllinux" class="anchor-heading" aria-labelledby="7-posso-correr-scripts-ps1-no-wsllinux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 7. Posso correr scripts <code class="language-plaintext highlighter-rouge">.ps1</code> no WSL/Linux? </h2> <p>Sim! Desde que tenhas o PowerShell instalado na tua distribuição Linux (via WSL), podes correr scripts <code class="language-plaintext highlighter-rouge">.ps1</code> como farias no Windows.</p> <h3 id="71-requisitos"> <a href="#71-requisitos" class="anchor-heading" aria-labelledby="71-requisitos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 7.1. Requisitos </h3> <ol> <li> <p><strong>PowerShell instalado no WSL</strong></p> <p>Verifica com:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> pwsh --version
</code></pre></div> </div> <p>Se não estiver instalado:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> sudo apt update
 sudo apt install powershell
</code></pre></div> </div> </li> <li> <p><strong>Script com formato correto (opcional)</strong></p> <ul> <li>Certifica-te de que o ficheiro <code class="language-plaintext highlighter-rouge">.ps1</code> está com quebras de linha em <strong>formato Unix (LF)</strong>.</li> <li>A codificação deve ser <strong>UTF-8 sem BOM</strong> (configura isto no VS Code se necessário).</li> <li> <p>Para facilitar, podes dar permissões de execução:</p> <p>chmod +x script.ps1</p> </li> </ul> </li> </ol> <h3 id="72-como-correr-o-script"> <a href="#72-como-correr-o-script" class="anchor-heading" aria-labelledby="72-como-correr-o-script"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 7.2. Como correr o script </h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwsh ./script.ps1
</code></pre></div></div> <p>Ou indicando o caminho completo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwsh /home/nuno/scripts/backup.ps1
</code></pre></div></div> <blockquote> <p>Caminhos em Linux usam <code class="language-plaintext highlighter-rouge">/</code> e começam por <code class="language-plaintext highlighter-rouge">/home/...</code>, não por <code class="language-plaintext highlighter-rouge">C:\</code>.</p> </blockquote> <h3 id="73-exemplo"> <a href="#73-exemplo" class="anchor-heading" aria-labelledby="73-exemplo"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 7.3. Exemplo </h3> <h4 id="ficheiro-listarps1"> <a href="#ficheiro-listarps1" class="anchor-heading" aria-labelledby="ficheiro-listarps1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ficheiro: <code class="language-plaintext highlighter-rouge">listar.ps1</code> </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ficheiros = Get-ChildItem /home/nuno/documentos
foreach ($f in $ficheiros) {
    Write-Output $f.Name
}
</code></pre></div></div> <h4 id="executar-no-terminal"> <a href="#executar-no-terminal" class="anchor-heading" aria-labelledby="executar-no-terminal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Executar no terminal: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pwsh ./listar.ps1
</code></pre></div></div> <p>⚠️ Atenção: scripts que usam comandos específicos de Windows (como <code class="language-plaintext highlighter-rouge">Get-Service</code> ou <code class="language-plaintext highlighter-rouge">Get-EventLog</code>) <strong>não vão funcionar</strong> em Linux.</p><hr /> <h2 id="8-compatibilidade-com-powershell-no-windows"> <a href="#8-compatibilidade-com-powershell-no-windows" class="anchor-heading" aria-labelledby="8-compatibilidade-com-powershell-no-windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 8. Compatibilidade com PowerShell no Windows </h2> <p>Embora a maioria dos comandos PowerShell funcione da mesma forma em Linux via WSL, há pequenas diferenças que deves conhecer.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Tema</th> <th>Funciona no WSL?</th> <th>Notas</th> </tr> </thead> <tbody> <tr> <td>Variáveis (<code class="language-plaintext highlighter-rouge">$x = ...</code>)</td> <td>✅</td> <td>Igual nos dois ambientes.</td> </tr> <tr> <td>Tipos de dados</td> <td>✅</td> <td>Os tipos primitivos funcionam da mesma forma (<code class="language-plaintext highlighter-rouge">int</code>, <code class="language-plaintext highlighter-rouge">string</code>, etc).</td> </tr> <tr> <td>Formatar output (<code class="language-plaintext highlighter-rouge">Format-*</code>)</td> <td>✅</td> <td>Sem diferenças. Só para visualização no terminal.</td> </tr> <tr> <td>Pipeline (<code class="language-plaintext highlighter-rouge">|</code>)</td> <td>✅</td> <td>Igual em ambos os sistemas.</td> </tr> <tr> <td>Objetos (<code class="language-plaintext highlighter-rouge">$_</code>, <code class="language-plaintext highlighter-rouge">.Property</code>)</td> <td>✅</td> <td>Funciona da mesma forma. Atenção a comandos que retornam texto puro.</td> </tr> <tr> <td>Parâmetros (<code class="language-plaintext highlighter-rouge">-Name</code>, etc.)</td> <td>✅</td> <td>Totalmente compatível.</td> </tr> <tr> <td>Exportar dados (<code class="language-plaintext highlighter-rouge">Export-Csv</code>, <code class="language-plaintext highlighter-rouge">Out-File</code>)</td> <td>✅</td> <td>Gera ficheiros compatíveis, mas atenção ao encoding.</td> </tr> <tr> <td>Manipulação de texto</td> <td>✅</td> <td>Sem diferenças (métodos <code class="language-plaintext highlighter-rouge">.ToUpper()</code>, <code class="language-plaintext highlighter-rouge">-replace</code>, etc).</td> </tr> <tr> <td>Criar scripts <code class="language-plaintext highlighter-rouge">.ps1</code></td> <td>✅</td> <td>Funciona, mas podes ter de dar permissões (<code class="language-plaintext highlighter-rouge">chmod +x</code>) no Linux.</td> </tr> <tr> <td>Estruturas condicionais</td> <td>✅</td> <td><code class="language-plaintext highlighter-rouge">if</code>, <code class="language-plaintext highlighter-rouge">elseif</code>, <code class="language-plaintext highlighter-rouge">else</code> funcionam da mesma forma.</td> </tr> <tr> <td>Loops (<code class="language-plaintext highlighter-rouge">for</code>, <code class="language-plaintext highlighter-rouge">foreach</code>)</td> <td>✅</td> <td>Igual. Sem diferenças.</td> </tr> <tr> <td>Try / Catch / Finally</td> <td>✅</td> <td>Sem diferenças. Útil para tratar erros de comandos bash também.</td> </tr> <tr> <td>Funções (<code class="language-plaintext highlighter-rouge">function X {}</code>)</td> <td>✅</td> <td>Totalmente suportado.</td> </tr> <tr> <td>Aliases (<code class="language-plaintext highlighter-rouge">Set-Alias</code>)</td> <td>✅</td> <td>Funciona, mas verifica se o alias não entra em conflito com bash.</td> </tr> <tr> <td>Personalização (<code class="language-plaintext highlighter-rouge">$PROFILE</code>)</td> <td>⚠️ Parcial</td> <td>O perfil <code class="language-plaintext highlighter-rouge">$PROFILE</code> existe, mas pode precisar ser criado manualmente. Depende da distro.</td> </tr> </tbody> </table></div> <blockquote> <p>✅ = Funciona sem alterações<br /> ⚠️ = Funciona, mas com precauções</p> </blockquote><hr /> <h2 id="9-comparação-powershell-vs-bash-linux"> <a href="#9-comparação-powershell-vs-bash-linux" class="anchor-heading" aria-labelledby="9-comparação-powershell-vs-bash-linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 9. Comparação PowerShell vs Bash (Linux) </h2> <div class="table-wrapper"><table> <thead> <tr> <th>Tema</th> <th>PowerShell</th> <th>Bash / Shell Script</th> </tr> </thead> <tbody> <tr> <td><strong>Variáveis</strong></td> <td><code class="language-plaintext highlighter-rouge">$x = 5</code></td> <td><code class="language-plaintext highlighter-rouge">x=5</code> (sem espaços)</td> </tr> <tr> <td><strong>Tipos de dados</strong></td> <td>Suporte a tipos (<code class="language-plaintext highlighter-rouge">[int]</code>, <code class="language-plaintext highlighter-rouge">[string]</code>)</td> <td>Tudo é texto (strings); conversões manuais</td> </tr> <tr> <td><strong>Formatar output</strong></td> <td><code class="language-plaintext highlighter-rouge">Format-Table</code>, <code class="language-plaintext highlighter-rouge">Format-List</code></td> <td><code class="language-plaintext highlighter-rouge">printf</code>, <code class="language-plaintext highlighter-rouge">awk</code>, <code class="language-plaintext highlighter-rouge">column</code></td> </tr> <tr> <td><strong>Pipeline</strong></td> <td>Passa objetos (<code class="language-plaintext highlighter-rouge">|</code>)</td> <td>Passa apenas texto (<code class="language-plaintext highlighter-rouge">|</code>)</td> </tr> <tr> <td><strong>Acesso a propriedades</strong></td> <td><code class="language-plaintext highlighter-rouge">$obj.Name</code>, <code class="language-plaintext highlighter-rouge">$_</code></td> <td><code class="language-plaintext highlighter-rouge">cut</code>, <code class="language-plaintext highlighter-rouge">awk</code>, parsing de texto</td> </tr> <tr> <td><strong>Parâmetros</strong></td> <td><code class="language-plaintext highlighter-rouge">-Name</code>, <code class="language-plaintext highlighter-rouge">-Verbose</code> com validação automática</td> <td><code class="language-plaintext highlighter-rouge">$1</code>, <code class="language-plaintext highlighter-rouge">$2</code>, <code class="language-plaintext highlighter-rouge">$@</code>, <code class="language-plaintext highlighter-rouge">getopts</code> para argumentos</td> </tr> <tr> <td><strong>Exportar output</strong></td> <td><code class="language-plaintext highlighter-rouge">Export-Csv</code>, <code class="language-plaintext highlighter-rouge">Out-File</code>, <code class="language-plaintext highlighter-rouge">Set-Content</code></td> <td><code class="language-plaintext highlighter-rouge">&gt;</code> (redirecionamento), <code class="language-plaintext highlighter-rouge">echo</code>, <code class="language-plaintext highlighter-rouge">tee</code>, <code class="language-plaintext highlighter-rouge">cat &gt; ficheiro</code></td> </tr> <tr> <td><strong>Criar scripts</strong></td> <td><code class="language-plaintext highlighter-rouge">.ps1</code> com <code class="language-plaintext highlighter-rouge">pwsh</code> ou <code class="language-plaintext highlighter-rouge">powershell</code></td> <td><code class="language-plaintext highlighter-rouge">.sh</code> com <code class="language-plaintext highlighter-rouge">bash</code> ou <code class="language-plaintext highlighter-rouge">sh</code></td> </tr> <tr> <td><strong>Try / Catch</strong></td> <td><code class="language-plaintext highlighter-rouge">try { } catch { } finally { }</code></td> <td><code class="language-plaintext highlighter-rouge">trap</code> e controlo manual de erros (<code class="language-plaintext highlighter-rouge">||</code>, <code class="language-plaintext highlighter-rouge">$?</code>)</td> </tr> <tr> <td><strong>Manipulação de texto</strong></td> <td><code class="language-plaintext highlighter-rouge">.ToUpper()</code>, <code class="language-plaintext highlighter-rouge">-replace</code>, <code class="language-plaintext highlighter-rouge">Split()</code></td> <td><code class="language-plaintext highlighter-rouge">awk</code>, <code class="language-plaintext highlighter-rouge">sed</code>, <code class="language-plaintext highlighter-rouge">tr</code>, <code class="language-plaintext highlighter-rouge">cut</code></td> </tr> <tr> <td><strong>Condicionais</strong></td> <td><code class="language-plaintext highlighter-rouge">if (...) { }</code> com operadores <code class="language-plaintext highlighter-rouge">-eq</code>, <code class="language-plaintext highlighter-rouge">-lt</code>, etc.</td> <td><code class="language-plaintext highlighter-rouge">if [ ... ]; then ... fi</code> ou <code class="language-plaintext highlighter-rouge">[[ ... ]]</code></td> </tr> <tr> <td><strong>Loops</strong></td> <td><code class="language-plaintext highlighter-rouge">foreach</code>, <code class="language-plaintext highlighter-rouge">for</code>, <code class="language-plaintext highlighter-rouge">while</code>, <code class="language-plaintext highlighter-rouge">do-until</code></td> <td><code class="language-plaintext highlighter-rouge">for</code>, <code class="language-plaintext highlighter-rouge">while</code>, <code class="language-plaintext highlighter-rouge">until</code>, <code class="language-plaintext highlighter-rouge">for x in ...; do ... done</code></td> </tr> <tr> <td><strong>Funções</strong></td> <td><code class="language-plaintext highlighter-rouge">function X {}</code> ou <code class="language-plaintext highlighter-rouge">X() {}</code></td> <td><code class="language-plaintext highlighter-rouge">X() { comandos }</code></td> </tr> <tr> <td><strong>Aliases</strong></td> <td><code class="language-plaintext highlighter-rouge">Set-Alias ls Get-ChildItem</code></td> <td><code class="language-plaintext highlighter-rouge">alias ll='ls -la'</code></td> </tr> <tr> <td><strong>Personalização</strong></td> <td><code class="language-plaintext highlighter-rouge">$PROFILE</code>, scripts de arranque <code class="language-plaintext highlighter-rouge">.ps1</code></td> <td><code class="language-plaintext highlighter-rouge">~/.bashrc</code>, <code class="language-plaintext highlighter-rouge">~/.profile</code>, <code class="language-plaintext highlighter-rouge">~/.bash_aliases</code></td> </tr> </tbody> </table></div><hr /> <h3 id="91--notas"> <a href="#91--notas" class="anchor-heading" aria-labelledby="91--notas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 9.1. ✅ Notas </h3> <ul> <li><strong>PowerShell</strong> trabalha com objetos — ideal para automação em sistemas Windows.</li> <li><strong>Bash</strong> é mais simples e direto, mas requer ferramentas externas para muitas tarefas.</li> <li>O <strong>PowerShell no Linux</strong> tenta oferecer o melhor dos dois mundos, mas comandos nativos do Bash continuam muitas vezes mais rápidos e leves.</li> </ul><hr /> <blockquote> <p>Dica para scripts portáveis: se queres algo que funcione tanto em Windows como Linux, evita comandos específicos como <code class="language-plaintext highlighter-rouge">Get-Service</code> ou <code class="language-plaintext highlighter-rouge">systemctl</code>, e foca-te em lógica e manipulação de ficheiros.</p> </blockquote><hr /> <h2 id="10-comandos-que-não-funcionam-no-linuxwsl"> <a href="#10-comandos-que-não-funcionam-no-linuxwsl" class="anchor-heading" aria-labelledby="10-comandos-que-não-funcionam-no-linuxwsl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 10. Comandos que não funcionam no Linux/WSL </h2> <p>Alguns cmdlets do PowerShell são específicos do Windows porque dependem de funcionalidades como:</p> <ul> <li>Registo do Windows (Registry)</li> <li>Serviços do Windows</li> <li>Event Viewer</li> <li>WMI (Windows Management Instrumentation)</li> <li>Componentes gráficos (como GridView)</li> <li>Objetos COM</li> </ul> <h3 id="101-comandos-comuns-que-não-funcionam-no-wsllinux"> <a href="#101-comandos-comuns-que-não-funcionam-no-wsllinux" class="anchor-heading" aria-labelledby="101-comandos-comuns-que-não-funcionam-no-wsllinux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 10.1. Comandos comuns que <strong>não funcionam no WSL/Linux</strong> </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Cmdlet</th> <th>Motivo</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">Get-Service</code></td> <td>Usa <code class="language-plaintext highlighter-rouge">Win32_Service</code>, exclusivo de Windows</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Start-Service</code> / <code class="language-plaintext highlighter-rouge">Stop-Service</code></td> <td>Gestão de serviços só funciona no Windows</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Get-EventLog</code> / <code class="language-plaintext highlighter-rouge">Get-WinEvent</code></td> <td>O Event Viewer não existe no Linux</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Get-ComputerInfo</code></td> <td>Depende de APIs do sistema operativo Windows</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Get-LocalUser</code>, <code class="language-plaintext highlighter-rouge">New-LocalUser</code></td> <td>Sistema de contas local diferente em Linux</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Get-ItemProperty -Path HKLM:\</code></td> <td>O Registry (<code class="language-plaintext highlighter-rouge">HKLM</code>, <code class="language-plaintext highlighter-rouge">HKCU</code>) não existe no Linux</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Invoke-WmiMethod</code>, <code class="language-plaintext highlighter-rouge">Get-WmiObject</code></td> <td>WMI é exclusivo de Windows</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">New-Object -ComObject ...</code></td> <td>COM (Component Object Model) não existe em Linux</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Add-Type -AssemblyName System.Windows.Forms</code></td> <td>Não há suporte para GUI</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">Out-GridView</code></td> <td>Requer interface gráfica (WPF), não disponível em Linux</td> </tr> </tbody> </table></div> <h3 id="102-como-saber-se-um-cmdlet-funciona"> <a href="#102-como-saber-se-um-cmdlet-funciona" class="anchor-heading" aria-labelledby="102-como-saber-se-um-cmdlet-funciona"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 10.2. Como saber se um cmdlet funciona? </h3> <p>Consulta a documentação oficial e verifica a secção “Aplica-se a” no topo da página.<br /> Exemplo:<br /> 🔗 <a href="https://learn.microsoft.com/powershell/module/microsoft.powershell.management/get-service">Get-Service - Microsoft Docs</a></p> <p>Se disser apenas “Windows”, esse cmdlet não funcionará em WSL/Linux.</p> <h3 id="103-estratégia-segura"> <a href="#103-estratégia-segura" class="anchor-heading" aria-labelledby="103-estratégia-segura"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 10.3. Estratégia segura </h3> <p>Protege os teus scripts multiplataforma com <code class="language-plaintext highlighter-rouge">$IsWindows</code> ou <code class="language-plaintext highlighter-rouge">try/catch</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if ($IsWindows) {
    Get-Service
} else {
    Write-Output "Comando indisponível no Linux"
}
</code></pre></div></div> <h3 id="104-alternativas-em-linux"> <a href="#104-alternativas-em-linux" class="anchor-heading" aria-labelledby="104-alternativas-em-linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 10.4. Alternativas em Linux </h3> <p>Exemplo para ver serviços ativos:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash -c "systemctl list-units --type=service --all"
</code></pre></div></div> <p>Podes capturar e tratar a saída com PowerShell:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$resultado = bash -c "systemctl list-units --type=service --all"
$resultado | Out-String
</code></pre></div></div> <blockquote> <p>⚠️ Mesmo comandos “simples” como <code class="language-plaintext highlighter-rouge">Test-Connection</code> podem ter comportamentos diferentes entre Windows e Linux.</p> </blockquote><hr /> <h2 id="11--exercícios"> <a href="#11--exercícios" class="anchor-heading" aria-labelledby="11--exercícios"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 11. 🧩 Exercícios </h2> <h3 id="111--exercício--listar-ficheiros-de-um-diretório-no-linux"> <a href="#111--exercício--listar-ficheiros-de-um-diretório-no-linux" class="anchor-heading" aria-labelledby="111--exercício--listar-ficheiros-de-um-diretório-no-linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 11.1. 🧩 Exercício – Listar ficheiros de um diretório no Linux </h3> <ol> <li>Acede ao WSL com <code class="language-plaintext highlighter-rouge">wsl</code> ou <code class="language-plaintext highlighter-rouge">wsl -d Ubuntu</code></li> <li>Corre PowerShell com <code class="language-plaintext highlighter-rouge">pwsh</code></li> <li>Lista os ficheiros da pasta <code class="language-plaintext highlighter-rouge">/etc</code> usando PowerShell</li> </ol> <!-- <details markdown="1"> <summary>Resposta</summary> Get-ChildItem /etc </details> --> <h3 id="112--exercício--correr-um-comando-bash-dentro-de-powershell"> <a href="#112--exercício--correr-um-comando-bash-dentro-de-powershell" class="anchor-heading" aria-labelledby="112--exercício--correr-um-comando-bash-dentro-de-powershell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 11.2. 🧩 Exercício – Correr um comando bash dentro de PowerShell </h3> <ol> <li>Usa PowerShell (dentro do WSL) para correr o comando <code class="language-plaintext highlighter-rouge">ls -l /home</code></li> <li>Usa <code class="language-plaintext highlighter-rouge">bash -c</code> ou o caminho completo do comando</li> </ol> <!-- <details markdown="1"> <summary>Resposta</summary> bash -c "ls -l /home" </details> --><hr /> <h2 id="12-exemplos-para-powershell-e-bash"> <a href="#12-exemplos-para-powershell-e-bash" class="anchor-heading" aria-labelledby="12-exemplos-para-powershell-e-bash"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 12. Exemplos para PowerShell e Bash </h2> <h3 id="121--exercício--criar-um-script-com-tratamento-de-erro"> <a href="#121--exercício--criar-um-script-com-tratamento-de-erro" class="anchor-heading" aria-labelledby="121--exercício--criar-um-script-com-tratamento-de-erro"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 12.1. 🧩 Exercício – Criar um script com tratamento de erro </h3> <p><strong>Enunciado:</strong><br /> Cria um script que:</p> <ol> <li>Pede ao utilizador um caminho de ficheiro.</li> <li>Tenta abrir o ficheiro.</li> <li>Se o ficheiro não existir, pergunta se quer criá-lo.</li> <li>Se não tiver permissões, mostra aviso.</li> <li>Qualquer outro erro é registado num log.</li> <li>No final, mostra “Operação concluída.”</li> </ol> <p><strong>PowerShell</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>try {
    $ficheiro = Read-Host "Caminho do ficheiro"
    Get-Content $ficheiro -ErrorAction Stop
}
catch [System.IO.FileNotFoundException] {
    $resposta = Read-Host "Ficheiro não encontrado. Queres criá-lo? (s/n)"
    if ($resposta -eq "s") {
        New-Item -Path $ficheiro -ItemType File
    }
}
catch [System.UnauthorizedAccessException] {
    Write-Output "Acesso negado. Tenta correr como administrador ou escolher outro local."
}
catch {
    Add-Content -Path erros.log -Value "[$(Get-Date)] Erro: $_"
}
finally {
    Write-Output "Operação concluída."
}
</code></pre></div></div> <p><strong>Bash</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>read -p "Caminho do ficheiro: " ficheiro
if [ -f "$ficheiro" ]; then
    cat "$ficheiro"  # Mostra o conteúdo
elif [ ! -e "$ficheiro" ]; then
    read -p "Ficheiro não encontrado. Queres criá-lo? (s/n) " resposta
    if [ "$resposta" = "s" ]; then
        touch "$ficheiro"  # Cria ficheiro vazio
    fi
elif [ ! -r "$ficheiro" ]; then
    echo "Acesso negado. Tenta com sudo ou escolhe outro local."
else
    echo "Erro desconhecido." &gt;&gt; erros.log  # Regista erro
fi
echo "Operação concluída."
</code></pre></div></div><hr /> <h3 id="122--exercício--calcular-o-dobro"> <a href="#122--exercício--calcular-o-dobro" class="anchor-heading" aria-labelledby="122--exercício--calcular-o-dobro"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 12.2. 🧩 Exercício – Calcular o dobro </h3> <p><strong>Enunciado:</strong><br /> Cria um script que:</p> <ol> <li>Pede ao utilizador um número.</li> <li>Converte o input para inteiro.</li> <li>Multiplica por 2.</li> <li>Mostra: “O dobro de <número> é <resultado>."</resultado></número></li> </ol> <p><strong>PowerShell</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$num = Read-Host "Introduz um número"
$valor = [int]$num
Write-Output "O dobro de $valor é $($valor * 2)"
</code></pre></div></div> <p><strong>Bash</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>read -p "Introduz um número: " num
resultado=$((num * 2))  # Multiplicação inteira
echo "O dobro de $num é $resultado"
</code></pre></div></div><hr /> <h3 id="123--exercício--verificar-se-uma-cor-existe"> <a href="#123--exercício--verificar-se-uma-cor-existe" class="anchor-heading" aria-labelledby="123--exercício--verificar-se-uma-cor-existe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 12.3. 🧩 Exercício – Verificar se uma cor existe </h3> <p><strong>Enunciado:</strong><br /> Cria um script que:</p> <ol> <li>Cria um array com 5 cores.</li> <li>Pede uma cor ao utilizador.</li> <li>Verifica se existe no array.</li> <li>Mostra “Cor encontrada!” ou “Cor não encontrada.”</li> </ol> <p><strong>PowerShell</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$cores = @("Vermelho", "Azul", "Verde", "Amarelo", "Roxo")
$input = Read-Host "Introduz uma cor"
if ($cores -contains $input) {
    Write-Output "Cor encontrada!"
} else {
    Write-Output "Cor não encontrada."
}
</code></pre></div></div> <p><strong>Bash</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cores=("Vermelho" "Azul" "Verde" "Amarelo" "Roxo")
read -p "Introduz uma cor: " input
if [[ " ${cores[@]} " =~ " $input " ]]; then
    echo "Cor encontrada!"
else
    echo "Cor não encontrada."
fi
</code></pre></div></div><hr /> <h3 id="124--exercício--mostrar-data-atual-e-daqui-a-7-dias"> <a href="#124--exercício--mostrar-data-atual-e-daqui-a-7-dias" class="anchor-heading" aria-labelledby="124--exercício--mostrar-data-atual-e-daqui-a-7-dias"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 12.4. 🧩 Exercício – Mostrar data atual e daqui a 7 dias </h3> <p><strong>Enunciado:</strong><br /> Cria um script que:</p> <ol> <li>Obtém a data atual.</li> <li>Mostra a data no formato “dd-MM-yyyy”.</li> <li>Mostra a data de daqui a 7 dias no mesmo formato.</li> </ol> <p><strong>PowerShell</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$hoje = Get-Date
$futuro = $hoje.AddDays(7)
$hoje.ToString("dd-MM-yyyy")
$futuro.ToString("dd-MM-yyyy")
</code></pre></div></div> <p><strong>Bash</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>date +"%d-%m-%Y"  # Hoje
date -d "+7 days" +"%d-%m-%Y"  # Daqui a 7 dias
</code></pre></div></div><hr /> <h3 id="125--exercício--adicionar-dias-à-data-atual"> <a href="#125--exercício--adicionar-dias-à-data-atual" class="anchor-heading" aria-labelledby="125--exercício--adicionar-dias-à-data-atual"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 12.5. 🧩 Exercício – Adicionar dias à data atual </h3> <p><strong>Enunciado:</strong><br /> Cria um script que:</p> <ol> <li>Pede quantos dias adicionar.</li> <li>Converte para número.</li> <li>Mostra a nova data no formato: “sexta-feira, 02 maio 2025”.</li> </ol> <p><strong>PowerShell</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$dias = Read-Host "Quantos dias queres adicionar?"
$novaData = (Get-Date).AddDays([int]$dias)
$novaData.ToString("dddd, dd MMMM yyyy")
</code></pre></div></div> <p><strong>Bash</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>read -p "Quantos dias queres adicionar? " dias
date -d "+$dias days" +"%A, %d %B %Y"  # Nome do dia e mês por extenso
</code></pre></div></div><hr /> <h3 id="126--exercício--validar-nome-pela-primeira-letra"> <a href="#126--exercício--validar-nome-pela-primeira-letra" class="anchor-heading" aria-labelledby="126--exercício--validar-nome-pela-primeira-letra"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 12.6. 🧩 Exercício – Validar nome pela primeira letra </h3> <p><strong>Enunciado:</strong><br /> Cria um script que:</p> <ol> <li>Pede um nome ao utilizador.</li> <li>Verifica se começa por A ou a.</li> <li>Mostra “Nome começa por A” se for o caso.</li> </ol> <p><strong>PowerShell</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$nome = Read-Host "Introduz o teu nome"
if ($nome -like "A*" -or $nome -like "a*") {
    Write-Output "Nome começa por A"
}
</code></pre></div></div> <p><strong>Bash</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>read -p "Introduz o teu nome: " nome
if [[ "$nome" =~ ^[Aa] ]]; then
    echo "Nome começa por A"
fi
</code></pre></div></div><hr /> <h3 id="127--exercício--maioridade"> <a href="#127--exercício--maioridade" class="anchor-heading" aria-labelledby="127--exercício--maioridade"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 12.7. 🧩 Exercício – Maioridade </h3> <p><strong>Enunciado:</strong><br /> Cria um script que:</p> <ol> <li>Pede a idade.</li> <li>Mostra “És maior de idade.” se &gt;= 18.</li> <li>Caso contrário, mostra “És menor de idade.”</li> </ol> <p><strong>PowerShell</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$idade = Read-Host "Qual é a tua idade?"
if ([int]$idade -ge 18) {
    Write-Output "És maior de idade."
} else {
    Write-Output "És menor de idade."
}
</code></pre></div></div> <p><strong>Bash</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>read -p "Qual é a tua idade? " idade
if [ "$idade" -ge 18 ]; then
    echo "És maior de idade."
else
    echo "És menor de idade."
fi
</code></pre></div></div><hr /> <h3 id="128--exercício--verificar-se-o-ano-é-bissexto"> <a href="#128--exercício--verificar-se-o-ano-é-bissexto" class="anchor-heading" aria-labelledby="128--exercício--verificar-se-o-ano-é-bissexto"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 12.8. 🧩 Exercício – Verificar se o ano é bissexto </h3> <p><strong>Enunciado:</strong><br /> Cria um script que:</p> <ol> <li>Pede um ano.</li> <li>Verifica se é bissexto: <ul> <li>Divisível por 4 e não por 100, ou divisível por 400.</li> </ul> </li> <li>Mostra “Ano bissexto.” ou “Ano comum.”</li> </ol> <p><strong>PowerShell</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ano = Read-Host "Introduz um ano"
if (($ano % 4 -eq 0 -and $ano % 100 -ne 0) -or ($ano % 400 -eq 0)) {
    Write-Output "Ano bissexto."
} else {
    Write-Output "Ano comum."
}
</code></pre></div></div> <p><strong>Bash</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>read -p "Introduz um ano: " ano
if (( (ano % 4 == 0 &amp;&amp; ano % 100 != 0) || (ano % 400 == 0) )); then
    echo "Ano bissexto."
else
    echo "Ano comum."
fi
</code></pre></div></div> <h3 id="129--exercício--classificar-frutas-com-switch"> <a href="#129--exercício--classificar-frutas-com-switch" class="anchor-heading" aria-labelledby="129--exercício--classificar-frutas-com-switch"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 12.9. 🧩 Exercício – Classificar frutas com switch </h3> <p><strong>Enunciado:</strong><br /> Cria um script que:</p> <ol> <li>Pede ao utilizador o nome de uma fruta</li> <li>Usa <code class="language-plaintext highlighter-rouge">switch</code> (ou equivalente) para classificar: <ul> <li>“Fruta cítrica” se for laranja, limão ou tangerina</li> <li>“Fruta tropical” se for banana, manga ou ananás</li> <li>“Outra fruta” nos restantes casos</li> </ul> </li> </ol> <p><strong>PowerShell</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$fruta = Read-Host "Introduz o nome de uma fruta"
switch ($fruta.ToLower()) {
    "laranja" { "Fruta cítrica" }
    "limão" { "Fruta cítrica" }
    "tangerina" { "Fruta cítrica" }
    "banana" { "Fruta tropical" }
    "manga" { "Fruta tropical" }
    "ananás" { "Fruta tropical" }
    default { "Outra fruta" }
}
</code></pre></div></div> <p><strong>Bash</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>read -p "Introduz o nome de uma fruta: " fruta
case "${fruta,,}" in
    laranja|limão|tangerina)
        echo "Fruta cítrica"
        ;;
    banana|manga|ananás)
        echo "Fruta tropical"
        ;;
    *)
        echo "Outra fruta"
        ;;
esac
</code></pre></div></div> <h3 id="1210--exercício--esperar-até-o-minuto-ser-múltiplo-de-5"> <a href="#1210--exercício--esperar-até-o-minuto-ser-múltiplo-de-5" class="anchor-heading" aria-labelledby="1210--exercício--esperar-até-o-minuto-ser-múltiplo-de-5"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 12.10. 🧩 Exercício – Esperar até o minuto ser múltiplo de 5 </h3> <p><strong>Enunciado:</strong><br /> Cria um script que:</p> <ol> <li>Usa um loop <code class="language-plaintext highlighter-rouge">while</code></li> <li>Espera até que o minuto atual seja múltiplo de 5</li> <li>Mostra o minuto quando isso acontecer</li> </ol> <p><strong>PowerShell</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>while ($true) {
    $minuto = (Get-Date).Minute
    if ($minuto % 5 -eq 0) {
        Write-Output "Minuto atual: $minuto"
        break
    }
    Start-Sleep -Seconds 10
}
</code></pre></div></div> <p><strong>Bash</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>while true; do
    minuto=$(date +%M)  # Obtém o minuto atual
    if (( minuto % 5 == 0 )); then
        echo "Minuto atual: $minuto"
        break
    fi
    sleep 10  # Espera 10 segundos antes de voltar a verificar
done
</code></pre></div></div> <h3 id="1211--exercício--copiar-ficheiro-com-logging-personalizado"> <a href="#1211--exercício--copiar-ficheiro-com-logging-personalizado" class="anchor-heading" aria-labelledby="1211--exercício--copiar-ficheiro-com-logging-personalizado"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 12.11. 🧩 Exercício – Copiar ficheiro com logging personalizado </h3> <p><strong>Enunciado:</strong><br /> Cria um script que:</p> <ol> <li>Copia um ficheiro de um local para outro</li> <li>Cria um ficheiro de log com nome baseado na data/hora</li> <li>Escreve um cabeçalho com: <ul> <li>Data de início</li> <li>Utilizador</li> <li>Nome da máquina</li> <li>Diretório atual</li> <li>Número de processos ativos</li> </ul> </li> <li>Regista: <ul> <li>Se o ficheiro de origem existe</li> <li>Resultado da cópia (sucesso ou falha)</li> <li>Hora de fim</li> </ul> </li> <li>Usa tags como <code class="language-plaintext highlighter-rouge">[INFO]</code>, <code class="language-plaintext highlighter-rouge">[ERRO]</code>, <code class="language-plaintext highlighter-rouge">[WARN]</code></li> <li>Usa data em cada linha do log</li> </ol> <p><strong>PowerShell</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$log = "log_$(Get-Date -Format 'yyyyMMdd_HHmm').txt"
$origem = Read-Host "Ficheiro de origem"
$destino = Read-Host "Destino"

Add-Content $log "[INFO] $(Get-Date -Format 'yyyy-MM-dd HH:mm') Início do script"
Add-Content $log "[INFO] Utilizador: $env:USERNAME"
Add-Content $log "[INFO] Máquina: $env:COMPUTERNAME"
Add-Content $log "[INFO] Diretório atual: $(Get-Location)"
Add-Content $log "[INFO] Processos ativos: $((Get-Process).Count)"

if (Test-Path $origem) {
    try {
        Copy-Item $origem $destino -ErrorAction Stop
        Add-Content $log "[INFO] $(Get-Date -Format 'yyyy-MM-dd HH:mm') Cópia concluída com sucesso"
    }
    catch {
        Add-Content $log "[ERRO] $(Get-Date -Format 'yyyy-MM-dd HH:mm') Erro ao copiar: $_"
    }
} else {
    Add-Content $log "[WARN] $(Get-Date -Format 'yyyy-MM-dd HH:mm') Ficheiro de origem não encontrado"
}

Add-Content $log "[INFO] $(Get-Date -Format 'yyyy-MM-dd HH:mm') Fim do script"
</code></pre></div></div> <p><strong>Bash</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>log="log_$(date +%Y%m%d_%H%M).txt"
read -p "Ficheiro de origem: " origem
read -p "Destino: " destino

echo "[INFO] $(date '+%Y-%m-%d %H:%M') Início do script" &gt;&gt; "$log"
echo "[INFO] Utilizador: $USER" &gt;&gt; "$log"
echo "[INFO] Máquina: $(hostname)" &gt;&gt; "$log"
echo "[INFO] Diretório atual: $(pwd)" &gt;&gt; "$log"
echo "[INFO] Processos ativos: $(ps aux | wc -l)" &gt;&gt; "$log"

if [ -f "$origem" ]; then
    if cp "$origem" "$destino"; then
        echo "[INFO] $(date '+%Y-%m-%d %H:%M') Cópia concluída com sucesso" &gt;&gt; "$log"
    else
        echo "[ERRO] $(date '+%Y-%m-%d %H:%M') Erro ao copiar ficheiro" &gt;&gt; "$log"
    fi
else
    echo "[WARN] $(date '+%Y-%m-%d %H:%M') Ficheiro de origem não encontrado" &gt;&gt; "$log"
fi

echo "[INFO] $(date '+%Y-%m-%d %H:%M') Fim do script" &gt;&gt; "$log"
</code></pre></div></div><hr /> <h3 id="1212--exercício--converter-temperatura-com-função"> <a href="#1212--exercício--converter-temperatura-com-função" class="anchor-heading" aria-labelledby="1212--exercício--converter-temperatura-com-função"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 12.12. 🧩 Exercício – Converter temperatura com função </h3> <p><strong>Enunciado:</strong><br /> Cria uma função chamada <code class="language-plaintext highlighter-rouge">Converter-CelsiusParaFahrenheit</code> que:</p> <ol> <li>Recebe uma temperatura em Celsius como parâmetro</li> <li>Converte para Fahrenheit com a fórmula <code class="language-plaintext highlighter-rouge">F = C × 1.8 + 32</code></li> <li>Mostra o resultado</li> </ol> <p><strong>PowerShell</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function Converter-CelsiusParaFahrenheit {
    param([double]$celsius)
    return ($celsius * 1.8 + 32)
}

$resultado = Converter-CelsiusParaFahrenheit 25
Write-Output "25 ºC = $resultado ºF"
</code></pre></div></div> <p><strong>Bash</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>converter() {
    celsius=$1
    fahrenheit=$(echo "$celsius * 1.8 + 32" | bc -l)
    echo "$celsius ºC = $fahrenheit ºF"
}

converter 25
</code></pre></div></div><hr /> <h2 id="13-resumo-e-boas-práticas"> <a href="#13-resumo-e-boas-práticas" class="anchor-heading" aria-labelledby="13-resumo-e-boas-práticas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 13. Resumo e Boas Práticas </h2> <ul> <li>O PowerShell em Linux tem limitações: nem todos os comandos Windows funcionam</li> <li>Usa comandos bash quando necessário (com <code class="language-plaintext highlighter-rouge">bash -c</code>)</li> <li>Aproveita o melhor dos dois mundos: objetos do PowerShell + ferramentas Unix</li> <li>Para scripts portáveis, evita comandos específicos de sistema</li> <li>Organiza os scripts com blocos <code class="language-plaintext highlighter-rouge">if ($IsLinux)</code> ou <code class="language-plaintext highlighter-rouge">$IsWindows</code></li> </ul> <h4 id="o-que-é-fi-no-bash"> <a href="#o-que-é-fi-no-bash" class="anchor-heading" aria-labelledby="o-que-é-fi-no-bash"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> O que é <code class="language-plaintext highlighter-rouge">fi</code> no Bash </h4> <p>Em Bash, <code class="language-plaintext highlighter-rouge">fi</code> marca o <strong>fim de um bloco <code class="language-plaintext highlighter-rouge">if</code></strong>.<br /> É o equivalente ao <code class="language-plaintext highlighter-rouge">}</code> que usamos no PowerShell.</p> <p><strong>Exemplo em Bash</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>read -p "Qual é o teu nome? " nome
if [ "$nome" = "Nuno" ]; then
    echo "Olá, Nuno!"
fi
</code></pre></div></div> <p><strong>Equivalente em PowerShell</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$nome = Read-Host "Qual é o teu nome?"
if ($nome -eq "Nuno") {
    Write-Output "Olá, Nuno!"
}
</code></pre></div></div> <blockquote> <p>Memoriza: <code class="language-plaintext highlighter-rouge">fi</code> = fim do <code class="language-plaintext highlighter-rouge">if</code></p> </blockquote><hr /> <p>🔗 <a href="https://learn.microsoft.com/pt-pt/windows/wsl/">Documentação oficial do WSL</a> 🔗 <a href="https://learn.microsoft.com/pt-pt/powershell/scripting/install/installing-powershell-on-linux">PowerShell no Linux</a></p><hr /> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
