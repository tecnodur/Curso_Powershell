<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/Curso_Powershell/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/Curso_Powershell/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(3)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(3) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(3) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(3) > ul.nav-list { display: block; } </style> <script src="/Curso_Powershell/assets/js/vendor/lunr.min.js"></script> <script src="/Curso_Powershell/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Session 3: Objetos, par√¢metros, pipeline, output, exporta√ß√µes | PowerShell Workshop</title> <meta name="generator" content="Jekyll v4.3.4" /> <meta property="og:title" content="Session 3: Objetos, par√¢metros, pipeline, output, exporta√ß√µes" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A project site with collapsible side navigation." /> <meta property="og:description" content="A project site with collapsible side navigation." /> <link rel="canonical" href="https://tecnodur.github.io/Curso_Powershell/Modules/Module1/session3.html" /> <meta property="og:url" content="https://tecnodur.github.io/Curso_Powershell/Modules/Module1/session3.html" /> <meta property="og:site_name" content="PowerShell Workshop" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Session 3: Objetos, par√¢metros, pipeline, output, exporta√ß√µes" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"A project site with collapsible side navigation.","headline":"Session 3: Objetos, par√¢metros, pipeline, output, exporta√ß√µes","url":"https://tecnodur.github.io/Curso_Powershell/Modules/Module1/session3.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/Curso_Powershell/" class="site-title lh-tight"> PowerShell Workshop </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/" class="nav-list-link">Curso de PowerShell & Shell Scripting</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in M√≥dulo 1: Introdu√ß√£o ao PowerShell e Shell Scripting category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module1/" class="nav-list-link">M√≥dulo 1: Introdu√ß√£o ao PowerShell e Shell Scripting</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module1/session1.html" class="nav-list-link">Session 1: Conceitos B√°sicos e Configura√ß√£o</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module1/session2.html" class="nav-list-link">Sess√£o 2: Comandos, Navega√ß√£o e Ajuda</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module1/session3.html" class="nav-list-link">Session 3: Objetos, par√¢metros, pipeline, output, exporta√ß√µes</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in M√≥dulo 2: Fundamentos de Scripting e L√≥gica em PowerShell category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module2/" class="nav-list-link">M√≥dulo 2: Fundamentos de Scripting e L√≥gica em PowerShell</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session1.html" class="nav-list-link">Session 1: Criar e Executar Scripts</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session2.html" class="nav-list-link">Session 2: Vari√°veis e Tipos de Dados</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session3.html" class="nav-list-link">Session 3: Tratamento de Erros com try, catch e finally</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session4.html" class="nav-list-link">Session 4: Manipula√ß√£o de Texto e Dados Simples</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session5.html" class="nav-list-link">Session 5: Estruturas Condicionais</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module2/session6.html" class="nav-list-link">Session 6: Loops e Itera√ß√µes</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in M√≥dulo 3: Gest√£o de Ficheiros e Processos category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module3/" class="nav-list-link">M√≥dulo 3: Gest√£o de Ficheiros e Processos</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session1.html" class="nav-list-link">Session 1: Scripts, Seguran√ßa, Fun√ß√µes e Personaliza√ß√£o</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session2.html" class="nav-list-link">Session 2: Manipula√ß√£o e Transforma√ß√£o de Cole√ß√µes</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session3.html" class="nav-list-link">Session 3: Personaliza√ß√£o do Ambiente PowerShell</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session4.html" class="nav-list-link">Session 4: Scripts Tem√°ticos com Ficheiros</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module3/session5.html" class="nav-list-link">Session 5: Pesquisa, Filtragem e Exporta√ß√£o</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in M√≥dulo 4: Integra√ß√£o Avan√ßada, Automatiza√ß√£o e Ecossistemas category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Curso_Powershell/Modules/Module4/" class="nav-list-link">M√≥dulo 4: Integra√ß√£o Avan√ßada, Automatiza√ß√£o e Ecossistemas</a><ul class="nav-list"><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session1.html" class="nav-list-link">Session 1: PowerShell em Linux com WSL</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session2.html" class="nav-list-link">Session 2: PowerShell vs CMD: Diferen√ßas e Utiliza√ß√£o no Windows</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session3.html" class="nav-list-link">Session 3: Tarefas Agendadas e Cron Jobs</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session4.html" class="nav-list-link">Session 4: Servi√ßos, Logs e Alertas</a></li><li class="nav-list-item"><a href="/Curso_Powershell/Modules/Module4/session5.html" class="nav-list-link">Session 5: Notifica√ß√µes e Relat√≥rios Automatizados</a></li></ul></li><li class="nav-list-item"><a href="/Curso_Powershell/refRapida.html" class="nav-list-link">Refer√™ncia R√°pida</a></li><li class="nav-list-item"><a href="/Curso_Powershell/vscode.html" class="nav-list-link">Visual Studio Code com PowerShell</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search PowerShell Workshop" aria-label="Search PowerShell Workshop" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/Curso_Powershell/Modules/Module1/">M√≥dulo 1: Introdu√ß√£o ao PowerShell e Shell Scripting</a></li> <li class="breadcrumb-nav-list-item"><span>Session 3: Objetos, par√¢metros, pipeline, output, exporta√ß√µes</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h2 style="all: unset; font-size: 5em; font-weight: bold;"> üß≠ Sess√£o 3: Objetos, par√¢metros, pipeline, output, exporta√ß√µes </h2> <p><br /></p> <p><strong>üéØ Objetivo</strong> Nesta sess√£o vamos aprofundar o entendimento sobre como o PowerShell apresenta e manipula o output dos comandos, como personalizar o ambiente de trabalho, e introduzir fun√ß√µes simples para reutiliza√ß√£o de l√≥gica.</p> <ul> <li><a href="#1-objetos--propriedades-e-m√©todos">1. Objetos , Propriedades e M√©todos</a> <ul> <li><a href="#11-o-que-√©-um-objeto">1.1. O que √© um objeto?</a></li> <li><a href="#12-como-identificar-propriedades-e-m√©todos">1.2. Como identificar propriedades e m√©todos?</a></li> <li><a href="#13-aceder-a-propriedades">1.3. Aceder a propriedades</a></li> <li><a href="#14-invocar-m√©todos">1.4. Invocar m√©todos</a></li> <li><a href="#15--exerc√≠cios-pr√°ticos">1.5. üß© Exerc√≠cios pr√°ticos</a></li> </ul> </li> <li><a href="#2-par√¢metros-em-comandos">2. Par√¢metros em comandos</a> <ul> <li><a href="#21-o-que-s√£o-par√¢metros">2.1. O que s√£o par√¢metros?</a></li> <li><a href="#22-como-descobrir-os-par√¢metros-dispon√≠veis">2.2. Como descobrir os par√¢metros dispon√≠veis?</a></li> <li><a href="#23-show-command--interface-gr√°fica-para-explorar-cmdlets">2.3. <code class="language-plaintext highlighter-rouge">Show-Command</code> ‚Äî Interface gr√°fica para explorar cmdlets</a></li> <li><a href="#24-par√¢metros-posicionais-vs-nomeados">2.4. Par√¢metros posicionais vs nomeados</a></li> <li><a href="#25-como-interpretar-a-ajuda-de-um-par√¢metro">2.5. Como interpretar a ajuda de um par√¢metro</a></li> <li><a href="#26--exerc√≠cios-pr√°ticos">2.6. üß© Exerc√≠cios pr√°ticos</a></li> </ul> </li> <li><a href="#3-outputs-e-pipeline">3. Outputs e Pipeline</a> <ul> <li><a href="#31-introdu√ß√£o">3.1. Introdu√ß√£o</a></li> <li><a href="#32-output-para-o-terminal">3.2. Output para o terminal</a></li> <li><a href="#33-formatar-o-output">3.3. Formatar o output</a></li> <li><a href="#34-redirecionar-output-para-ficheiros">3.4. Redirecionar output para ficheiros</a></li> <li><a href="#35-o-pipeline-">3.5. O pipeline (<code class="language-plaintext highlighter-rouge">|</code>)</a></li> <li><a href="#36-_--o-objeto-atual-no-pipeline">3.6. <code class="language-plaintext highlighter-rouge">$_</code> ‚Äì o objeto atual no pipeline</a></li> <li><a href="#37-boas-pr√°ticas">3.7. Boas pr√°ticas</a></li> <li><a href="#38--exerc√≠cios-pr√°ticos">3.8. üß© Exerc√≠cios pr√°ticos</a></li> </ul> </li> </ul> <h1 id="1-objetos--propriedades-e-m√©todos"> <a href="#1-objetos--propriedades-e-m√©todos" class="anchor-heading" aria-labelledby="1-objetos--propriedades-e-m√©todos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Objetos , Propriedades e M√©todos </h1> <p>No PowerShell, quase tudo √© um objeto. Isso significa que os comandos n√£o devolvem apenas texto, mas sim objetos com propriedades e m√©todos que podes explorar e manipular.</p><hr /> <h2 id="11-o-que-√©-um-objeto"> <a href="#11-o-que-√©-um-objeto" class="anchor-heading" aria-labelledby="11-o-que-√©-um-objeto"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.1. O que √© um objeto? </h2> <p>Um objeto √© uma estrutura que cont√©m:</p> <ul> <li><strong>Propriedades</strong> ‚Äì informa√ß√µes sobre o objeto (ex: nome, tamanho, data de cria√ß√£o)</li> <li><strong>M√©todos</strong> ‚Äì a√ß√µes que o objeto pode executar (ex: copiar, apagar, converter)</li> </ul><hr /> <h2 id="12-como-identificar-propriedades-e-m√©todos"> <a href="#12-como-identificar-propriedades-e-m√©todos" class="anchor-heading" aria-labelledby="12-como-identificar-propriedades-e-m√©todos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.2. Como identificar propriedades e m√©todos? </h2> <p>Podes visualizar as propriedades e m√©todos de um objeto atrav√©s de comandos que mostrem o seu conte√∫do completo. Este comando mostra todos os m√©todos e propriedades dispon√≠veis no objeto $hoje, que representa a data e hora atual.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$hoje = Get-Date
$hoje | Get-Member
</code></pre></div></div><hr /> <h2 id="13-aceder-a-propriedades"> <a href="#13-aceder-a-propriedades" class="anchor-heading" aria-labelledby="13-aceder-a-propriedades"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.3. Aceder a propriedades </h2> <p>Podes visualizar os valores das propriedades de um objeto com:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$hoje | Format-List *
</code></pre></div></div> <p>Podes aceder a uma propriedade com o operador <code class="language-plaintext highlighter-rouge">.</code></p> <p><strong>Exemplo:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$hoje.Year
$hoje.Month
$hoje.DayOfWeek
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">$hoje.Year</code> devolve o ano atual (ex: 2025)<br /> <code class="language-plaintext highlighter-rouge">$hoje.Month</code> devolve o n√∫mero do m√™s (ex: 4)<br /> <code class="language-plaintext highlighter-rouge">$hoje.DayOfWeek</code> devolve o dia da semana por extenso (ex: Friday)</p><hr /> <h2 id="14-invocar-m√©todos"> <a href="#14-invocar-m√©todos" class="anchor-heading" aria-labelledby="14-invocar-m√©todos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.4. Invocar m√©todos </h2> <p>Os m√©todos s√£o a√ß√µes que um objeto pode executar. Para invocar um m√©todo, usas o operador de ponto seguido de par√™ntesis (). Podes descobrir quais os m√©todos dispon√≠veis para um objeto com o comando: <code class="language-plaintext highlighter-rouge">$objeto | Get-Member</code></p> <p><strong>Exemplo:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$hoje | Get-Member
</code></pre></div></div> <p>Isto mostra todos os membros do objeto $data, incluindo os m√©todos como AddDays, AddHours, ToShortDateString, etc.</p> <p><img src="image.png" alt="alt text" /> O m√©todo <code class="language-plaintext highlighter-rouge">AddDays()</code> pertence ao tipo <em>System.DateTime</em> Aceita um n√∫mero (double) como argumento, que representa o n√∫mero de dias a somar ou subtrair. O resultado √© um novo objeto datetime com a data ajustada.</p> <ul> <li>O m√©todo chama-se <em>AddDays</em></li> <li>Recebe como par√¢metro de entrada um valor do tipo double (por exemplo: 1, 2.5, -3)</li> <li>Devolve como resultado um objeto do tipo datetime</li> <li> <p>Exemplos</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   $maisMeioDia = $hoje.AddDays(0.5)
   $amanha = $hoje.AddDays(1)
</code></pre></div> </div> </li> </ul><hr /> <p><strong>üîé Nota</strong><br /> <code class="language-plaintext highlighter-rouge">Get-Location | Get-Member</code> mostra-te os m√©todos e propriedades que podes usar sobre os objetos devolvidos pelo comando <code class="language-plaintext highlighter-rouge">Get-Location</code>, e n√£o sobre o pr√≥prio comando.</p> <p>Se escreveres:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Location.ToString()
</code></pre></div></div> <p>O PowerShell interpreta isto como uma tentativa de chamar o m√©todo <code class="language-plaintext highlighter-rouge">ToString()</code> sobre o comando <code class="language-plaintext highlighter-rouge">Get-Location</code> em si, e n√£o sobre o objeto que ele devolve.</p> <p>Ora, <code class="language-plaintext highlighter-rouge">Get-Location</code> √© um comando, n√£o √© um objeto. Est√°s, na pr√°tica, a tentar aplicar <code class="language-plaintext highlighter-rouge">.ToString()</code> a um <em>scriptblock impl√≠cito</em>, o que resulta num erro ou num comportamento inesperado.</p> <p>A forma correta de o fazer √© com par√™ntesis:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(Get-Location).ToString()
</code></pre></div></div> <p>Assim, o PowerShell executa primeiro o comando <code class="language-plaintext highlighter-rouge">Get-Location</code> e s√≥ depois chama o m√©todo <code class="language-plaintext highlighter-rouge">ToString()</code> sobre o objeto retornado (que √© do tipo <code class="language-plaintext highlighter-rouge">PathInfo</code>).</p><hr /> <p><strong>Documenta√ß√£o oficial:</strong> https://learn.microsoft.com/en-us/powershell/scripting/learn/ps101/03-discovering-objects</p><hr /> <h2 id="15--exerc√≠cios-pr√°ticos"> <a href="#15--exerc√≠cios-pr√°ticos" class="anchor-heading" aria-labelledby="15--exerc√≠cios-pr√°ticos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1.5. üß© Exerc√≠cios pr√°ticos </h2> <h3 id="-exerc√≠cio-1"> <a href="#-exerc√≠cio-1" class="anchor-heading" aria-labelledby="-exerc√≠cio-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Exerc√≠cio 1 </h3> <ol> <li>Cria uma vari√°vel <code class="language-plaintext highlighter-rouge">$frase</code> com o valor ‚ÄúPowerShell √© poderoso‚Äù.</li> <li>Mostra o comprimento total da frase usando a propriedade adequada.</li> </ol> <details> <summary>Resposta</summary> $frase = "PowerShell √© poderoso" $frase.Length </details><hr /> <h3 id="-exerc√≠cio-2"> <a href="#-exerc√≠cio-2" class="anchor-heading" aria-labelledby="-exerc√≠cio-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Exerc√≠cio 2 </h3> <ol> <li>Cria uma vari√°vel <code class="language-plaintext highlighter-rouge">$texto</code> com o valor <code class="language-plaintext highlighter-rouge">"PowerShell √© fixe"</code>.</li> <li>Converte para mai√∫sculas.</li> <li>Verifica se cont√©m a palavra <code class="language-plaintext highlighter-rouge">"fixe"</code>.</li> </ol> <details> <summary>Resposta</summary> $texto = "PowerShell √© fixe" $texto.ToUpper() $texto.Contains("fixe") </details><hr /> <h3 id="-exerc√≠cio-3"> <a href="#-exerc√≠cio-3" class="anchor-heading" aria-labelledby="-exerc√≠cio-3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Exerc√≠cio 3 </h3> <ol> <li>Guarda a data atual numa vari√°vel chamada <code class="language-plaintext highlighter-rouge">$hoje</code>.</li> <li>Cria uma nova vari√°vel <code class="language-plaintext highlighter-rouge">$amanha</code> com a data de amanh√£.</li> <li>Mostra o dia da semana correspondente.</li> </ol> <details> <summary>Resposta</summary> $hoje = Get-Date $amanha = $hoje.AddDays(1) $amanha.DayOfWeek </details><hr /> <h3 id="-exerc√≠cio-4"> <a href="#-exerc√≠cio-4" class="anchor-heading" aria-labelledby="-exerc√≠cio-4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Exerc√≠cio 4 </h3> <p>Usa o comando Get-Location e acede √† propriedade que te mostra o caminho atual da localiza√ß√£o.</p> <details> <summary>Resposta</summary> (Get-Location).Path </details> <p>Usa o mesmo comando e chama o m√©todo que devolve o o caminho atual da localiza√ß√£o.</p> <details> <summary>Resposta</summary> (Get-Location).ToString() </details> <details> <summary>Nota</summary> Ambos os comandos devolvem exatamente o mesmo texto ‚Äî o caminho atual. Isto acontece porque o m√©todo ToString() do objeto PathInfo foi implementado para devolver o mesmo valor da propriedade Path. Este √© um bom exemplo de como m√©todos podem ser usados para produzir representa√ß√µes leg√≠veis de objetos, mesmo que haja uma propriedade que contenha o mesmo valor. </details> <h1 id="2-par√¢metros-em-comandos"> <a href="#2-par√¢metros-em-comandos" class="anchor-heading" aria-labelledby="2-par√¢metros-em-comandos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Par√¢metros em comandos </h1> <p>Muitos comandos no PowerShell aceitam par√¢metros para alterar o seu comportamento ou filtrar os resultados.</p><hr /> <h2 id="21-o-que-s√£o-par√¢metros"> <a href="#21-o-que-s√£o-par√¢metros" class="anchor-heading" aria-labelledby="21-o-que-s√£o-par√¢metros"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.1. O que s√£o par√¢metros? </h2> <ul> <li>Um par√¢metro √© uma op√ß√£o que controlas ao chamar um comando.</li> <li>Um argumento √© o valor que passas a esse par√¢metro.</li> </ul> <p><strong>Exemplo:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process -Name "notepad"
</code></pre></div></div> <ul> <li><code class="language-plaintext highlighter-rouge">-Name</code> √© o par√¢metro</li> <li><code class="language-plaintext highlighter-rouge">"notepad"</code> √© o argumento</li> </ul><hr /> <h2 id="22-como-descobrir-os-par√¢metros-dispon√≠veis"> <a href="#22-como-descobrir-os-par√¢metros-dispon√≠veis" class="anchor-heading" aria-labelledby="22-como-descobrir-os-par√¢metros-dispon√≠veis"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.2. Como descobrir os par√¢metros dispon√≠veis? </h2> <p>Usa os seguintes comandos:</p> <p>Mostra todos os par√¢metros, exemplos e descri√ß√µes. <code class="language-plaintext highlighter-rouge">Get-Help Get-Process -Full</code></p> <p>Mostra apenas os par√¢metros<br /> <code class="language-plaintext highlighter-rouge">Get-Help Get-Process -Parameter *</code></p> <p>Mostra a sintaxe resumida. <code class="language-plaintext highlighter-rouge">Get-Command Get-Process -Syntax</code></p> <p>Abre uma janela gr√°fica com os par√¢metros <code class="language-plaintext highlighter-rouge">Show-Command Get-Process</code></p> <h2 id="23-show-command--interface-gr√°fica-para-explorar-cmdlets"> <a href="#23-show-command--interface-gr√°fica-para-explorar-cmdlets" class="anchor-heading" aria-labelledby="23-show-command--interface-gr√°fica-para-explorar-cmdlets"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.3. <code class="language-plaintext highlighter-rouge">Show-Command</code> ‚Äî Interface gr√°fica para explorar cmdlets </h2> <p>O <code class="language-plaintext highlighter-rouge">Show-Command</code> abre uma <strong>interface gr√°fica (GUI)</strong> onde podes preencher os par√¢metros de um cmdlet. √â especialmente √∫til para quem est√° a come√ßar ou quer explorar rapidamente os par√¢metros dispon√≠veis sem consultar o <code class="language-plaintext highlighter-rouge">Get-Help</code>.</p> <h3 id="como-funciona"> <a href="#como-funciona" class="anchor-heading" aria-labelledby="como-funciona"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Como funciona? </h3> <ul> <li>Ao executar <code class="language-plaintext highlighter-rouge">Show-Command Get-Process</code>, abre-se uma janela com todos os par√¢metros organizados em tabs.</li> <li>Em alguns casos, o Show-Command apresenta os par√¢metros numa √∫nica vista simples (sem separadores). Noutros cmdlets mais complexos, podem surgir abas (tabs) como Default, CommonParameters e All, dependendo da vers√£o do PowerShell e do n√∫mero de par√¢metros.</li> <li>Podes preencher os campos manualmente, ver o comando PowerShell resultante (bot√£o <strong>Copy</strong>) e at√© execut√°-lo diretamente (bot√£o <strong>Run</strong>).</li> </ul> <h3 id="exemplo-visual"> <a href="#exemplo-visual" class="anchor-heading" aria-labelledby="exemplo-visual"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exemplo visual </h3> <p><code class="language-plaintext highlighter-rouge">Show-Command Get-Process</code></p> <p><img src="image-2.png" alt="alt text" /></p> <h3 id="quando-usar"> <a href="#quando-usar" class="anchor-heading" aria-labelledby="quando-usar"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Quando usar? </h3> <ul> <li>Quando n√£o conheces bem os par√¢metros de um cmdlet.</li> <li>Para aprender a construir comandos mais complexos.</li> <li>Em apresenta√ß√µes ou aulas para demonstrar cmdlets de forma intuitiva.</li> </ul> <h3 id="aten√ß√£o"> <a href="#aten√ß√£o" class="anchor-heading" aria-labelledby="aten√ß√£o"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Aten√ß√£o </h3> <ul> <li>S√≥ funciona em ambientes com <strong>interface gr√°fica</strong> (n√£o funciona em PowerShell sem GUI, como o PowerShell Core em Linux ou WSL sem suporte gr√°fico).</li> <li>√ötil para aprendizagem, mas na pr√°tica avan√ßada √© mais r√°pido usar diretamente o terminal.</li> </ul> <p>üîó <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/show-command">Show-Command - Documenta√ß√£o oficial</a></p> <h3 id="-exerc√≠cio--explorar-processos-com-show-command"> <a href="#-exerc√≠cio--explorar-processos-com-show-command" class="anchor-heading" aria-labelledby="-exerc√≠cio--explorar-processos-com-show-command"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß™ Exerc√≠cio ‚Äì Explorar processos com Show-Command </h3> <ol> <li> <p>Corre:</p> <p><code class="language-plaintext highlighter-rouge">Show-Command Get-Process</code></p> </li> <li>Preenche o campo <code class="language-plaintext highlighter-rouge">Name</code> com <code class="language-plaintext highlighter-rouge">notepad</code>.</li> <li>Clica em <strong>Copy</strong> e cola no terminal. O que aparece?</li> <li>Agora clica em <strong>Run</strong>.</li> </ol> <p>üîó <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/show-command">Show-Command</a></p><hr /> <h2 id="24-par√¢metros-posicionais-vs-nomeados"> <a href="#24-par√¢metros-posicionais-vs-nomeados" class="anchor-heading" aria-labelledby="24-par√¢metros-posicionais-vs-nomeados"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.4. Par√¢metros posicionais vs nomeados </h2> <ul> <li> <p><strong>Explicito:</strong><br /> Escreves explicitamente o nome do par√¢metro.<br /> Ex: <code class="language-plaintext highlighter-rouge">Get-Process -Name notepad</code></p> </li> <li> <p><strong>Posicional:</strong><br /> O PowerShell assume o par√¢metro com base na posi√ß√£o do argumento.<br /> Ex: <code class="language-plaintext highlighter-rouge">Get-Process notepad</code> ‚Üí √© equivalente a <code class="language-plaintext highlighter-rouge">-Name notepad</code></p> </li> </ul><hr /> <h2 id="25-como-interpretar-a-ajuda-de-um-par√¢metro"> <a href="#25-como-interpretar-a-ajuda-de-um-par√¢metro" class="anchor-heading" aria-labelledby="25-como-interpretar-a-ajuda-de-um-par√¢metro"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.5. Como interpretar a ajuda de um par√¢metro </h2> <p><strong>Exemplo retirado de <code class="language-plaintext highlighter-rouge">Get-Help Get-Service -Parameter Name</code>:</strong></p> <div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">-Name &lt;System.String[]&gt;</span><span class="w">
</span><span class="go">    Specifies the service names of services to be retrieved. Wildcards are permitted.
    
    Required?                    false
    Position?                    0
    Default value                None
    Accept pipeline input?       True (ByPropertyName, ByValue)
    Accept wildcard characters?  true
</span></code></pre></div></div> <ul> <li><code class="language-plaintext highlighter-rouge">-Name</code> √© o nome do par√¢metro</li> <li>O tipo esperado √© uma string ou lista de strings</li> <li>N√£o √© obrigat√≥rio (<code class="language-plaintext highlighter-rouge">Required? false</code>)</li> <li>Pode ser usado sem escrever o nome, se for o primeiro argumento (<code class="language-plaintext highlighter-rouge">Position? 0</code>)</li> <li>Aceita wildcards (<code class="language-plaintext highlighter-rouge">*</code>, <code class="language-plaintext highlighter-rouge">?</code>)</li> <li>Aceita input de pipeline por nome de propriedade ou por valor</li> </ul> <p>Com base nesta informa√ß√£o podemos usar:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Service -Name ms*
Get-Service ms*
</code></pre></div></div> <blockquote> <p><strong>üí° Dica</strong>: Usa <code class="language-plaintext highlighter-rouge">Tab</code> para completar o nome dos par√¢metros</p> </blockquote><hr /> <h2 id="26--exerc√≠cios-pr√°ticos"> <a href="#26--exerc√≠cios-pr√°ticos" class="anchor-heading" aria-labelledby="26--exerc√≠cios-pr√°ticos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.6. üß© Exerc√≠cios pr√°ticos </h2> <h3 id="-exerc√≠cio---explorar-par√¢metros-com-get-eventlog"> <a href="#-exerc√≠cio---explorar-par√¢metros-com-get-eventlog" class="anchor-heading" aria-labelledby="-exerc√≠cio---explorar-par√¢metros-com-get-eventlog"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Exerc√≠cio - Explorar par√¢metros com Get-EventLog </h3> <blockquote> <p>Usa <code class="language-plaintext highlighter-rouge">Get-Help Get-EventLog -Full</code> e tenta descobrir:</p> <ul> <li>Como listar os √∫ltimos 5 eventos do log <code class="language-plaintext highlighter-rouge">System</code></li> <li>Que par√¢metro te permite limitar a quantidade de eventos</li> </ul> </blockquote> <details> <summary>Resposta</summary> Get-EventLog -LogName System -Newest 5 </details> <h3 id="-exerc√≠cio---explorar-par√¢metros-com-get-childitem"> <a href="#-exerc√≠cio---explorar-par√¢metros-com-get-childitem" class="anchor-heading" aria-labelledby="-exerc√≠cio---explorar-par√¢metros-com-get-childitem"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Exerc√≠cio - Explorar par√¢metros com Get-ChildItem </h3> <blockquote> <p>Usa <code class="language-plaintext highlighter-rouge">Get-Help Get-ChildItem -Parameter *</code> para responder √†s seguintes perguntas:</p> </blockquote> <ol> <li>Qual o par√¢metro que permite procurar ficheiros de forma recursiva?</li> <li>Qual o par√¢metro que permite usar filtros com wildcards?</li> <li>Constr√≥i um comando que mostre todos os ficheiros <code class="language-plaintext highlighter-rouge">.txt</code> em todos os subdiret√≥rios da tua pasta pessoal.</li> </ol> <p>üí° <strong>Nota:</strong><br /> Podes usar a vari√°vel de ambiente <code class="language-plaintext highlighter-rouge">$Env:USERPROFILE</code> para aceder √† tua pasta pessoal.</p> <details> <summary>Resposta</summary> Get-ChildItem -Path $Env:USERPROFILE -Filter *.txt -Recurse </details> <details> <summary>Vers√£o reduzida</summary> Get-ChildItem $Env:USERPROFILE *.txt -Recurse `$Env:USERPROFILE` ‚Üí corresponde ao 1.¬∫ par√¢metro posicional, que √© -Path `*.txt` ‚Üí corresponde ao 2.¬∫ par√¢metro posicional, que √© -Filter `-Recurse` ‚Üí continua a ser necess√°rio indicar o nome, pois n√£o √© posicional Este comando √© menos leg√≠vel, pelo que √© melhor usar sempre o nome dos par√¢metros </details> <h1 id="3-outputs-e-pipeline"> <a href="#3-outputs-e-pipeline" class="anchor-heading" aria-labelledby="3-outputs-e-pipeline"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. Outputs e Pipeline </h1> <h2 id="31-introdu√ß√£o"> <a href="#31-introdu√ß√£o" class="anchor-heading" aria-labelledby="31-introdu√ß√£o"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.1. Introdu√ß√£o </h2> <p>No PowerShell, o output refere-se √† informa√ß√£o que um comando devolve depois de ser executado.<br /> Esse resultado pode ser:</p> <ul> <li>Visualizado no terminal</li> <li>Armazenado numa vari√°vel</li> <li>Redirecionado para ficheiros</li> <li>Passado para outro comando atrav√©s do pipeline</li> </ul><hr /> <h3 id="o-que-pode-ser-feito-com-o-output"> <a href="#o-que-pode-ser-feito-com-o-output" class="anchor-heading" aria-labelledby="o-que-pode-ser-feito-com-o-output"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> O que pode ser feito com o output? </h3> <p>Podes fazer v√°rias coisas com o resultado de um comando:</p> <ul> <li><strong>Visualizar</strong> diretamente no terminal (com formata√ß√£o opcional)</li> <li><strong>Transformar</strong> o conte√∫do (filtrar, ordenar, formatar)</li> <li><strong>Guardar</strong> o resultado em ficheiros (texto, CSV, etc.)</li> <li><strong>Encadear</strong> o resultado em comandos seguintes com <code class="language-plaintext highlighter-rouge">|</code></li> </ul> <p>Esta flexibilidade torna o PowerShell uma ferramenta poderosa para automatiza√ß√£o e an√°lise de dados.</p><hr /> <h2 id="32-output-para-o-terminal"> <a href="#32-output-para-o-terminal" class="anchor-heading" aria-labelledby="32-output-para-o-terminal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.2. Output para o terminal </h2> <p>Quando executas um comando no PowerShell, o resultado (output) √© mostrado automaticamente no terminal, sem necessidade de comandos adicionais.</p> <h3 id="exibi√ß√£o-por-defeito"> <a href="#exibi√ß√£o-por-defeito" class="anchor-heading" aria-labelledby="exibi√ß√£o-por-defeito"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exibi√ß√£o por defeito </h3> <p>Se escreveres apenas uma express√£o ou comando, o PowerShell mostra o resultado automaticamente.</p> <p><strong>Exemplos:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Date
"Ol√°, mundo"
2 + 3
$variavel = "valor"  # neste caso n√£o h√° output, apenas atribui√ß√£o
</code></pre></div></div> <p>O PowerShell mostra o resultado porque o motor de execu√ß√£o avalia a express√£o e, se for apropriado, envia-a para o sistema de formata√ß√£o (que define como o output ser√° apresentado).</p> <h3 id="o-que-√©-o-sistema-de-formata√ß√£o-no-powershell"> <a href="#o-que-√©-o-sistema-de-formata√ß√£o-no-powershell" class="anchor-heading" aria-labelledby="o-que-√©-o-sistema-de-formata√ß√£o-no-powershell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> O que √© o sistema de formata√ß√£o no PowerShell? </h3> <p>Sempre que executas um comando, o PowerShell n√£o imprime diretamente o objeto devolvido.<br /> Em vez disso, envia esse objeto para o <strong>sistema de formata√ß√£o</strong>, que define como o conte√∫do ser√° apresentado no terminal.</p> <p>Esse sistema baseia-se em regras internas, definidas em ficheiros <code class="language-plaintext highlighter-rouge">.format.ps1xml</code>, que indicam:</p> <ul> <li>Que propriedades devem ser mostradas</li> <li>Em que ordem</li> <li>Com que t√≠tulos</li> <li>E em que tipo de estrutura (tabela, lista, etc.)</li> </ul><hr /> <p><strong>Exemplo 1 ‚Äì <code class="language-plaintext highlighter-rouge">Get-Process</code></strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process
</code></pre></div></div> <p>Este comando devolve objetos do tipo <code class="language-plaintext highlighter-rouge">System.Diagnostics.Process</code>.<br /> O PowerShell aplica regras de formata√ß√£o espec√≠ficas para esse tipo, e mostra automaticamente uma <strong>tabela com colunas</strong> como:</p> <ul> <li>Handles</li> <li>NPM</li> <li>CPU</li> <li>Id</li> <li>ProcessName</li> </ul><hr /> <p><strong>Exemplo 2 ‚Äì <code class="language-plaintext highlighter-rouge">Get-Date</code></strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Date
</code></pre></div></div> <p>Este comando devolve um objeto <code class="language-plaintext highlighter-rouge">System.DateTime</code>.<br /> Esse tipo de objeto tem o m√©todo <code class="language-plaintext highlighter-rouge">.ToString()</code> bem definido, por isso o PowerShell mostra diretamente:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>s√°bado, 20 de abril de 2025 09:32:01
</code></pre></div></div> <p>Se quiseres ver todas as propriedades do objeto:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Date | Format-List *
</code></pre></div></div><hr /> <h4 id="e-se-o-tipo-de-objeto-n√£o-tiver-formata√ß√£o-definida"> <a href="#e-se-o-tipo-de-objeto-n√£o-tiver-formata√ß√£o-definida" class="anchor-heading" aria-labelledby="e-se-o-tipo-de-objeto-n√£o-tiver-formata√ß√£o-definida"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> E se o tipo de objeto n√£o tiver formata√ß√£o definida? </h4> <p>O PowerShell tenta chamar o m√©todo <code class="language-plaintext highlighter-rouge">.ToString()</code> do objeto.<br /> Por exemplo o comando <code class="language-plaintext highlighter-rouge">New-Object -TypeName System.Object</code>vai criar um objeto gen√©rico sem propriedades nem m√©todos personalizados (al√©m dos herdados) que ter√° como resultado:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>System.Object
</code></pre></div></div> <p>Isto √© semelhante ao que acontece em linguagens como C# ou Java quando tentas imprimir um objeto sem sobrepor o m√©todo <code class="language-plaintext highlighter-rouge">ToString()</code>.</p><hr /> <h3 id="write-output-opcional-mas-√∫til"> <a href="#write-output-opcional-mas-√∫til" class="anchor-heading" aria-labelledby="write-output-opcional-mas-√∫til"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Write-Output (opcional mas √∫til) </h3> <p>O comando <code class="language-plaintext highlighter-rouge">Write-Output</code> envia explicitamente dados para o output.<br /> Na maioria dos casos, n√£o √© necess√°rio us√°-lo ‚Äî mas pode ser √∫til quando queres tornar o c√≥digo mais claro ou construir scripts mais estruturados.</p> <p><strong>Exemplos:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Write-Output "Isto vai aparecer no terminal"
Write-Output (Get-Date)
</code></pre></div></div> <p><strong>Nota:</strong><br /> <code class="language-plaintext highlighter-rouge">Write-Output</code> envia o conte√∫do para o pipeline, o que significa que podes continuar a trabalhar com o valor.<br /> Por oposi√ß√£o, <code class="language-plaintext highlighter-rouge">Write-Host</code> escreve diretamente no ecr√£ e n√£o envia nada para o pipeline.</p> <p><strong>Exemplo de diferen√ßa:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Write-Output "Ol√°" | ForEach-Object { $_.ToUpper() }   # funciona
Write-Host "Ol√°"   | ForEach-Object { $_.ToUpper() }   # n√£o funciona
</code></pre></div></div> <p>üí° Usa <code class="language-plaintext highlighter-rouge">Write-Output</code> quando quiseres manter a informa√ß√£o no fluxo de dados.</p><hr /> <h2 id="33-formatar-o-output"> <a href="#33-formatar-o-output" class="anchor-heading" aria-labelledby="33-formatar-o-output"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.3. Formatar o output </h2> <p>Por defeito, o PowerShell aplica uma formata√ß√£o autom√°tica com base no tipo de objeto devolvido.<br /> No entanto, podes personalizar a forma como a informa√ß√£o √© apresentada usando os comandos <code class="language-plaintext highlighter-rouge">Format-Table</code>, <code class="language-plaintext highlighter-rouge">Format-List</code> e <code class="language-plaintext highlighter-rouge">Select-Object</code>.</p> <h3 id="format-table"> <a href="#format-table" class="anchor-heading" aria-labelledby="format-table"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">Format-Table</code> </h3> <p>Apresenta os dados em forma de <strong>tabela</strong>, com colunas.</p> <p><strong>Exemplo:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Select-Object -First 10 | Format-Table Name, Id, CPU
</code></pre></div></div> <p>Podes tamb√©m usar <code class="language-plaintext highlighter-rouge">-AutoSize</code> para ajustar automaticamente a largura das colunas:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Select-Object -First 10 | Format-Table Name, Id, CPU -AutoSize
</code></pre></div></div><hr /> <h3 id="format-list"> <a href="#format-list" class="anchor-heading" aria-labelledby="format-list"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">Format-List</code> </h3> <p>Mostra as propriedades em lista vertical, √∫til quando h√° muitos detalhes ou quando o conte√∫do n√£o cabe numa linha.</p> <p><strong>Exemplo:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Select-Object -First 10 | Format-List Name, Id, CPU
</code></pre></div></div> <p>üí° Usa <code class="language-plaintext highlighter-rouge">Format-List</code> quando quiseres ver tudo com mais detalhe, e <code class="language-plaintext highlighter-rouge">Format-Table</code> quando quiseres uma vis√£o geral e comparativa.</p><hr /> <h3 id="-select-object"> <a href="#-select-object" class="anchor-heading" aria-labelledby="-select-object"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üîé Select-Object </h3> <p>Permite selecionar apenas algumas propriedades de um objeto, sem alterar o tipo de output.<br /> Isto √© √∫til para controlar os dados que passam no pipeline, sem aplicar formata√ß√£o visual.</p> <p><strong>Exemplo:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Select-Object Name, Id
</code></pre></div></div> <p>üí° <code class="language-plaintext highlighter-rouge">Select-Object</code> √© usado para preparar dados para exporta√ß√£o, filtragem ou uso posterior, n√£o apenas para apresenta√ß√£o.</p> <p><strong>üÜö Compara√ß√£o pr√°tica com Get-Member</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Select-Object Name, Id | Get-Member
</code></pre></div></div> <p>‚Üí Mostra os membros (propriedades e m√©todos) dos objetos que passaram pelo pipeline.<br /> O tipo de output √©:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TypeName: Selected.System.Diagnostics.Process
</code></pre></div></div> <p>Ou seja, o resultado continua a ser um objeto com estrutura, com propriedades acess√≠veis como <code class="language-plaintext highlighter-rouge">.Name</code> e <code class="language-plaintext highlighter-rouge">.Id</code>.</p><hr /> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Format-Table Name, Id | Get-Member
</code></pre></div></div> <p>‚Üí Aqui <code class="language-plaintext highlighter-rouge">Get-Member</code> mostra os membros de um objeto de formata√ß√£o, e n√£o os do processo original.<br /> O tipo de output √©:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TypeName: Microsoft.PowerShell.Commands.Internal.Format.FormatStartData
</code></pre></div></div> <p>Isto acontece porque <code class="language-plaintext highlighter-rouge">Format-Table</code> transforma os objetos em texto formatado, e os dados originais j√° n√£o est√£o acess√≠veis como propriedades estruturadas.</p> <blockquote> <p>Nota: <code class="language-plaintext highlighter-rouge">Select-Object</code> mant√©m os dados ‚Äúvivos‚Äù como objetos. <code class="language-plaintext highlighter-rouge">Format-Table</code> ‚Äúmata‚Äù os objetos e transforma-os em texto ‚Äî √∫til para ver, mas in√∫til para processar depois.</p> </blockquote> <h2 id="34-redirecionar-output-para-ficheiros"> <a href="#34-redirecionar-output-para-ficheiros" class="anchor-heading" aria-labelledby="34-redirecionar-output-para-ficheiros"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.4. Redirecionar output para ficheiros </h2> <p>Podes guardar o resultado de comandos PowerShell em ficheiros para consulta posterior, documenta√ß√£o, exporta√ß√£o de dados, ou integra√ß√£o com outras ferramentas.</p><hr /> <h3 id="out-file"> <a href="#out-file" class="anchor-heading" aria-labelledby="out-file"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Out-File </h3> <p>O comando <code class="language-plaintext highlighter-rouge">Out-File</code> envia texto formatado para um ficheiro.</p> <p><strong>Exemplo:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Out-File -FilePath "processos.txt"
</code></pre></div></div> <p>Isto cria (ou substitui) o ficheiro <code class="language-plaintext highlighter-rouge">processos.txt</code> com a sa√≠da formatada do comando <code class="language-plaintext highlighter-rouge">Get-Process</code>.</p> <p>üí° Podes usar o par√¢metro <code class="language-plaintext highlighter-rouge">-Append</code> se quiseres adicionar ao conte√∫do existente:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Date | Out-File -FilePath "log.txt" -Append
</code></pre></div></div><hr /> <h4 id="controlar-o-encoding"> <a href="#controlar-o-encoding" class="anchor-heading" aria-labelledby="controlar-o-encoding"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Controlar o encoding </h4> <p>O <code class="language-plaintext highlighter-rouge">Out-File</code> usa por defeito o encoding <code class="language-plaintext highlighter-rouge">utf-16</code>.<br /> Se quiseres guardar em UTF-8 (mais comum e compat√≠vel), usa:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Out-File -FilePath "processos.txt" -Encoding utf8
</code></pre></div></div><hr /> <h3 id="export-csv"> <a href="#export-csv" class="anchor-heading" aria-labelledby="export-csv"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Export-Csv </h3> <p>O comando <code class="language-plaintext highlighter-rouge">Export-Csv</code> √© ideal para exportar objetos estruturados como listas de processos, servi√ßos, utilizadores, etc.</p> <p><strong>Exemplo:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Select-Object Name, Id, CPU | Export-Csv -Path "processos.csv" -NoTypeInformation
</code></pre></div></div> <ul> <li>Cada linha do ficheiro CSV representa um objeto</li> <li>Cada coluna corresponde a uma propriedade</li> <li>O par√¢metro <code class="language-plaintext highlighter-rouge">-NoTypeInformation</code> evita que a primeira linha contenha metadados do tipo.</li> </ul> <p>üí° Este comando √© muito √∫til quando vais trabalhar os dados em Excel ou Power BI.</p> <blockquote> <p><strong>Testar</strong> Correr o comando com e sem <code class="language-plaintext highlighter-rouge">-NoTypeInformation</code> e verificar a primeira linha do ficheiro.</p> </blockquote><hr /> <h3 id="set-content-e-add-content"> <a href="#set-content-e-add-content" class="anchor-heading" aria-labelledby="set-content-e-add-content"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Set-Content e Add-Content </h3> <p>Estes comandos permitem escrever diretamente em ficheiros linha a linha (sem passar por formata√ß√£o especial).</p> <ul> <li><code class="language-plaintext highlighter-rouge">Set-Content</code> cria ou substitui um ficheiro</li> <li><code class="language-plaintext highlighter-rouge">Add-Content</code> adiciona ao conte√∫do existente</li> </ul> <p><strong>Exemplos:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Set-Content -Path "ficheiro.txt" -Value "Primeira linha"
Add-Content -Path "ficheiro.txt" -Value "Segunda linha"
</code></pre></div></div> <p>üí° Estes comandos s√£o √∫teis quando precisas de escrever dados simples como strings, logs ou resultados de scripts, n√£o dependem do sistema de formata√ß√£o do PowerShell ‚Äî escrevem exatamente o que pedires, linha por linha.</p><hr /> <p>‚ö†Ô∏è <strong>Nota importante:</strong><br /> Se precisares de guardar dados estruturados (com propriedades), usa <code class="language-plaintext highlighter-rouge">Export-Csv</code>.<br /> Se o que queres √© guardar texto formatado tal como aparece no terminal, usa <code class="language-plaintext highlighter-rouge">Out-File</code>. Usa <code class="language-plaintext highlighter-rouge">Set-Content</code> ou <code class="language-plaintext highlighter-rouge">Add-Content</code> quando quiseres escrever diretamente texto simples ou valores individuais, sem formata√ß√£o autom√°tica.</p> <h2 id="35-o-pipeline-"> <a href="#35-o-pipeline-" class="anchor-heading" aria-labelledby="35-o-pipeline-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.5. O pipeline (<code class="language-plaintext highlighter-rouge">|</code>) </h2> <p>O s√≠mbolo <code class="language-plaintext highlighter-rouge">|</code>, chamado pipeline, √© uma das funcionalidades mais poderosas do PowerShell.<br /> Permite encadear comandos, onde o output de um comando √© passado como input para o seguinte.</p><hr /> <h3 id="como-funciona-1"> <a href="#como-funciona-1" class="anchor-heading" aria-labelledby="como-funciona-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Como funciona? </h3> <p>Cada comando no pipeline recebe os objetos produzidos pelo comando anterior.<br /> Isso permite aplicar filtros, transforma√ß√µes ou a√ß√µes sucessivas de forma leg√≠vel e modular.</p><hr /> <h3 id="exemplo-pr√°tico"> <a href="#exemplo-pr√°tico" class="anchor-heading" aria-labelledby="exemplo-pr√°tico"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exemplo pr√°tico </h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Where-Object { $_.CPU -gt 100 } | Sort-Object CPU
</code></pre></div></div> <p>Explica√ß√£o passo a passo:</p> <ol> <li><code class="language-plaintext highlighter-rouge">Get-Process</code> devolve todos os processos em execu√ß√£o.</li> <li><code class="language-plaintext highlighter-rouge">Where-Object</code> filtra os que t√™m mais de 100 segundos de uso de CPU.</li> <li><code class="language-plaintext highlighter-rouge">Sort-Object</code> ordena os resultados com base na propriedade <code class="language-plaintext highlighter-rouge">CPU</code>.</li> </ol><hr /> <h2 id="36-_--o-objeto-atual-no-pipeline"> <a href="#36-_--o-objeto-atual-no-pipeline" class="anchor-heading" aria-labelledby="36-_--o-objeto-atual-no-pipeline"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.6. <code class="language-plaintext highlighter-rouge">$_</code> ‚Äì o objeto atual no pipeline </h2> <p>A vari√°vel especial <code class="language-plaintext highlighter-rouge">$_</code>, que representa o objeto atual no pipeline, ser√° explicada mais √† frente quando abordarmos blocos de script.</p> <p>Para j√° vamos apenas ver um breve exemplo</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | ForEach-Object { $_.Name }
</code></pre></div></div> <p>Aqui, $_ √© o objeto atual, e acedemos √† sua propriedade Name.</p><hr /> <blockquote> <p><strong>üí° Dica</strong>: O pipeline torna os comandos mais leg√≠veis, reutiliz√°veis e poderosos.<br /> Em vez de criar vari√°veis tempor√°rias ou escrever muitos passos, podes fazer tudo numa s√≥ linha de forma clara. ‚Äî</p> </blockquote> <h2 id="37-boas-pr√°ticas"> <a href="#37-boas-pr√°ticas" class="anchor-heading" aria-labelledby="37-boas-pr√°ticas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.7. Boas pr√°ticas </h2> <p>Ao usares comandos com pipeline e redirecionamento de output, h√° algumas boas pr√°ticas que ajudam a evitar erros e a manter os scripts mais limpos e eficientes.</p><hr /> <h3 id="filtra-o-mais-cedo-poss√≠vel"> <a href="#filtra-o-mais-cedo-poss√≠vel" class="anchor-heading" aria-labelledby="filtra-o-mais-cedo-poss√≠vel"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Filtra o mais cedo poss√≠vel </h3> <p>Aplica filtros (<code class="language-plaintext highlighter-rouge">Where-Object</code>, <code class="language-plaintext highlighter-rouge">Select-Object</code>, etc.) no in√≠cio do pipeline para reduzir a quantidade de dados processados.</p> <p><strong>Melhor:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Where-Object { $_.CPU -gt 100 } | Sort-Object CPU
</code></pre></div></div> <p><strong>Pior (menos eficiente):</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Sort-Object CPU | Where-Object { $_.CPU -gt 100 }
</code></pre></div></div><hr /> <h3 id="usa-select-object-para-preparar-dados-para-exporta√ß√£o"> <a href="#usa-select-object-para-preparar-dados-para-exporta√ß√£o" class="anchor-heading" aria-labelledby="usa-select-object-para-preparar-dados-para-exporta√ß√£o"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Usa <code class="language-plaintext highlighter-rouge">Select-Object</code> para preparar dados para exporta√ß√£o </h3> <p>Antes de exportar dados (por exemplo, para CSV), seleciona apenas as propriedades relevantes com <code class="language-plaintext highlighter-rouge">Select-Object</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Select-Object Name, Id, CPU | Export-Csv -Path "proc.csv" -NoTypeInformation
</code></pre></div></div><hr /> <h3 id="evita-usar-format--antes-de-exportar-ou-guardar"> <a href="#evita-usar-format--antes-de-exportar-ou-guardar" class="anchor-heading" aria-labelledby="evita-usar-format--antes-de-exportar-ou-guardar"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Evita usar <code class="language-plaintext highlighter-rouge">Format-*</code> antes de exportar ou guardar </h3> <p>Comandos como <code class="language-plaintext highlighter-rouge">Format-Table</code> ou <code class="language-plaintext highlighter-rouge">Format-List</code> devem ser usados s√≥ para visualiza√ß√£o, e no final do pipeline.<br /> Se os usares antes de comandos como <code class="language-plaintext highlighter-rouge">Export-Csv</code> ou <code class="language-plaintext highlighter-rouge">Out-File</code>, perdes a estrutura dos dados.</p> <p><strong>Errado:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Format-Table Name, Id | Export-Csv "proc.csv"     ‚ùå
</code></pre></div></div> <p><strong>Correto:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Get-Process | Select-Object Name, Id | Export-Csv "proc.csv"     ‚úÖ
</code></pre></div></div><hr /> <h3 id="verifica-o-que-vai-sair-antes-de-redirecionar"> <a href="#verifica-o-que-vai-sair-antes-de-redirecionar" class="anchor-heading" aria-labelledby="verifica-o-que-vai-sair-antes-de-redirecionar"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Verifica o que vai sair antes de redirecionar </h3> <p>Testa sempre o output no terminal antes de o guardar em ficheiros. Assim evitas ficheiros com dados errados ou formatados de forma inesperada.</p><hr /> <h3 id="usa-export-csv-para-dados-estruturados"> <a href="#usa-export-csv-para-dados-estruturados" class="anchor-heading" aria-labelledby="usa-export-csv-para-dados-estruturados"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Usa <code class="language-plaintext highlighter-rouge">Export-Csv</code> para dados estruturados </h3> <p>Se est√°s a exportar dados com v√°rias propriedades (como tabelas), usa <code class="language-plaintext highlighter-rouge">Export-Csv</code>.<br /> Evita usar <code class="language-plaintext highlighter-rouge">Out-File</code> nesses casos, porque vais guardar apenas o texto renderizado, e n√£o os dados reais.</p><hr /> <h3 id="usa-out-file-set-content-ou-add-content-com-prop√≥sitos-espec√≠ficos"> <a href="#usa-out-file-set-content-ou-add-content-com-prop√≥sitos-espec√≠ficos" class="anchor-heading" aria-labelledby="usa-out-file-set-content-ou-add-content-com-prop√≥sitos-espec√≠ficos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Usa <code class="language-plaintext highlighter-rouge">Out-File</code>, <code class="language-plaintext highlighter-rouge">Set-Content</code> ou <code class="language-plaintext highlighter-rouge">Add-Content</code> com prop√≥sitos espec√≠ficos </h3> <ul> <li><code class="language-plaintext highlighter-rouge">Out-File</code>: quando queres guardar o texto formatado como aparece no terminal</li> <li><code class="language-plaintext highlighter-rouge">Set-Content</code>: para criar ficheiros de texto simples com conte√∫do direto</li> <li><code class="language-plaintext highlighter-rouge">Add-Content</code>: para adicionar linhas a ficheiros existentes (ex: logs)</li> </ul><hr /> <blockquote> <p><strong>üí° Dica</strong>: Ao seguir estas boas pr√°ticas, consegues criar scripts mais fi√°veis, reutiliz√°veis e mais f√°ceis de manter.</p> </blockquote><hr /> <h2 id="38--exerc√≠cios-pr√°ticos"> <a href="#38--exerc√≠cios-pr√°ticos" class="anchor-heading" aria-labelledby="38--exerc√≠cios-pr√°ticos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3.8. üß© Exerc√≠cios pr√°ticos </h2> <h3 id="-exerc√≠cio-1--format-table"> <a href="#-exerc√≠cio-1--format-table" class="anchor-heading" aria-labelledby="-exerc√≠cio-1--format-table"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Exerc√≠cio 1 ‚Äì Format-Table </h3> <ol> <li>Mostra os primeiros 5 processos no sistema.</li> <li>Exibe apenas o nome, o ID e o tempo de CPU de cada processo.</li> <li>Usa <code class="language-plaintext highlighter-rouge">Format-Table</code> com <code class="language-plaintext highlighter-rouge">-AutoSize</code>.</li> </ol> <details> <summary>Resposta</summary> Get-Process | Select-Object -First 5 | Format-Table Name, Id, CPU -AutoSize </details><hr /> <h3 id="-exerc√≠cio-2--format-list"> <a href="#-exerc√≠cio-2--format-list" class="anchor-heading" aria-labelledby="-exerc√≠cio-2--format-list"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Exerc√≠cio 2 ‚Äì Format-List </h3> <ol> <li>Mostra os detalhes do primeiro servi√ßo do sistema.</li> <li>Exibe todas as propriedades usando <code class="language-plaintext highlighter-rouge">Format-List</code>.</li> </ol> <details> <summary>Resposta</summary> Get-Service | Select-Object -First 1 | Format-List * </details><hr /> <h3 id="-exerc√≠cio-3--guardar-o-output-num-ficheiro"> <a href="#-exerc√≠cio-3--guardar-o-output-num-ficheiro" class="anchor-heading" aria-labelledby="-exerc√≠cio-3--guardar-o-output-num-ficheiro"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Exerc√≠cio 3 ‚Äì Guardar o output num ficheiro </h3> <ol> <li>Guarda a lista de servi√ßos num ficheiro chamado <code class="language-plaintext highlighter-rouge">servicos.txt</code>.</li> <li>Usa <code class="language-plaintext highlighter-rouge">Out-File</code> com encoding UTF-8.</li> </ol> <details> <summary>Resposta</summary> Get-Service | Out-File -FilePath "servicos.txt" -Encoding utf8 </details><hr /> <h3 id="-exerc√≠cio-4--exportar-para-csv"> <a href="#-exerc√≠cio-4--exportar-para-csv" class="anchor-heading" aria-labelledby="-exerc√≠cio-4--exportar-para-csv"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Exerc√≠cio 4 ‚Äì Exportar para CSV </h3> <ol> <li>Exporta o nome e o estado de todos os servi√ßos para um ficheiro chamado <code class="language-plaintext highlighter-rouge">servicos.csv</code>.</li> <li>Garante que a primeira linha <strong>n√£o cont√©m o tipo de objeto</strong>.</li> </ol> <details> <summary>Resposta</summary> Get-Service | Select-Object Name, Status | Export-Csv -Path "servicos.csv" -NoTypeInformation </details><hr /> <h3 id="-exerc√≠cio-5--adicionar-conte√∫do-a-um-ficheiro"> <a href="#-exerc√≠cio-5--adicionar-conte√∫do-a-um-ficheiro" class="anchor-heading" aria-labelledby="-exerc√≠cio-5--adicionar-conte√∫do-a-um-ficheiro"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Exerc√≠cio 5 ‚Äì Adicionar conte√∫do a um ficheiro </h3> <ol> <li>Cria um ficheiro <code class="language-plaintext highlighter-rouge">log.txt</code> com uma linha inicial.</li> <li>Acrescenta a data e hora atuais √† linha seguinte.</li> </ol> <details> <summary>Resposta</summary> Set-Content -Path "log.txt" -Value "In√≠cio do log" Add-Content -Path "log.txt" -Value (Get-Date) </details><hr /> <h3 id="-exerc√≠cio-6--usar-pipeline-com-filtros"> <a href="#-exerc√≠cio-6--usar-pipeline-com-filtros" class="anchor-heading" aria-labelledby="-exerc√≠cio-6--usar-pipeline-com-filtros"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Exerc√≠cio 6 ‚Äì Usar pipeline com filtros </h3> <ol> <li>Lista todos os processos que estejam a consumir mais de 50 segundos de CPU.</li> <li>Ordena os resultados por tempo de CPU.</li> </ol> <details> <summary>Resposta</summary> Get-Process | Where-Object { $_.CPU -gt 50 } | Sort-Object CPU </details> <h3 id="-exerc√≠cio-7--an√°lise-de-processos"> <a href="#-exerc√≠cio-7--an√°lise-de-processos" class="anchor-heading" aria-labelledby="-exerc√≠cio-7--an√°lise-de-processos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> üß© Exerc√≠cio 7 ‚Äì An√°lise de processos </h3> <ol> <li>Usa <code class="language-plaintext highlighter-rouge">Get-Process</code> para explorar todas as propriedades dispon√≠veis (usa <code class="language-plaintext highlighter-rouge">Format-List *</code> ou <code class="language-plaintext highlighter-rouge">Get-Member</code>).</li> <li>Escolhe tr√™s propriedades que aches √∫teis para analisar o estado dos processos (ex: <code class="language-plaintext highlighter-rouge">Name</code>, <code class="language-plaintext highlighter-rouge">CPU</code>, <code class="language-plaintext highlighter-rouge">WorkingSet</code>).</li> <li>Filtra os 10 processos que est√£o a usar mais mem√≥ria (<code class="language-plaintext highlighter-rouge">WorkingSet</code>).</li> <li>Exporta essa informa√ß√£o para um ficheiro <code class="language-plaintext highlighter-rouge">processos_memoria.csv</code>, sem incluir o tipo de objeto na primeira linha.</li> </ol> <blockquote> <p><strong>üí° Dica</strong>: <code class="language-plaintext highlighter-rouge">WorkingSet</code> representa a quantidade de mem√≥ria f√≠sica usada por um processo (em bytes).</p> </blockquote> <details> <summary>Resposta</summary> Get-Process | Sort-Object WorkingSet -Descending | Select-Object -First 10 Name, CPU, WorkingSet | Export-Csv -Path "processos_memoria.csv" -NoTypeInformation </details> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
